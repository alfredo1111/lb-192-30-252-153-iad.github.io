(function(e){var a={};function t(r){if(a[r]){return a[r].exports}var l=a[r]={i:r,l:!1,exports:{}};e[r].call(l.exports,l,l.exports,t);l.l=!0;return l.exports}t.m=e;t.c=a;t.d=function(e,a,r){if(!t.o(e,a)){Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:r})}};t.r=function(e){Object.defineProperty(e,'__esModule',{value:!0})};t.n=function(e){var a=e&&e.__esModule?function(){return e['default']}:function(){return e};t.d(a,'a',a);return a};t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.p='';return t(t.s=182)})([,,function(e,t,a){'use strict';a.r(t);var r=a(3);null==r['default'].Wistia&&(r['default'].Wistia={});var l=r['default'].Wistia;null==l._initializers&&(l._initializers={}),null==l._destructors&&(l._destructors={}),null==l.mixin&&(l.mixin=function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])});t['default']=r['default'].Wistia;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var r,l='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e};try{r=self,r.self!==r&&l(r.self)!==void 0&&'undefined'!=typeof window&&(r=window)}catch(e){r='undefined'==typeof globalThis?window:globalThis}t['default']=r;window.__NEWLINE__=1},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){'use strict';a.r(t);a.d(t,'PUBLIC_METHODS',function(){return r});a.d(t,'delegateMethods',function(){return l});a.d(t,'delegatePublicMethods',function(){return i});var r=['activeBufferRange','anyBuffered','bind','bindNamed','bufferInfo','cancelFullscreen','captureCurrentFrame','changeQuality','changeStream','changeStreamWithoutLoad','changeVideo','currentAsset','defaultAsset','destroy','diagnosticData','eventContext','fit','getCurrentQuality','getCurrentTime','getDuration','getPlaybackMode','getPlaybackRate','getPreload','getState','getTrim','getVolume','hasIssuedPlay','isChangingVideo','isInitializingFromUnmuted','isInFullscreen','isMuted','isSeeking','isSourceOfBrowserEvent','lastBufferedTime','mute','onEnterFullscreen','onHeightChange','onLeaveFullscreen','onPlayed','onReady','onWidthChange','pause','play','playType','requestFullscreen','reset','seek','seekOnPlay','selectedAsset','selectableAssets','selectableQualities','selectedQuality','sequentialBufferedRange','setAttributes','setCurrentTime','setPlaybackRate','setTrim','setVolume','showFirstFrame','stopStreaming','timeBeforeEndOfBuffer','totalBuffered','totalPlayed','trigger','unbind','unbindNamed','unbindAllInNamespace','unmute','videoElem'],l=function(e,t,a){for(var r,l=0;l<e.length;l++)r=e[l],t[r]||function(e){t[e]=function(){var t=a.call(this);return t?t[e].apply(t,arguments):null}}(r)},i=function(e,t){l(r,e,t)};window.__NEWLINE__=1},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){'use strict';a.r(t);var r=a(2),l=a(183);r['default'].define('engines/hls_video.js',l['default']);window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(184),i=a(185),n=a(194),o=a(2),s=a(201),d=a(202),u=a(203),g=a(248),f=a(250),c=a(251),p=a(252),m=a(253),y=a(204),v=a.n(y),h=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var b=o['default'].lib('utilities/obj'),_=o['default'].lib('utilities/wlog'),E=_.wlog,L=o['default'].lib('player/lib/elem'),k=L.elemWidth,A=L.elemHeight,R=o['default'].lib('utilities/localstorage'),S=R.setOrGet,T=o['default'].lib('utilities/seqid'),D=o['default'].lib('player/lib/assets'),x=o['default'].lib('utilities/stopgo'),C=i['default'].delegatePublicMethods,P=E.getPrefixedFunctions('hls_video'),O=o['default'].lib('promiscuous'),I=a(254).default,F=a(249).default,w=1,N=0.9,B=function(){function e(t,a){var l=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3];r(this,e),this.uuid=T('wistia_hls_video_'),this.root=t,this.mediaData=a,this.allAssets=a.assets,this.attributes=b.assign(this.defaultAttributes(),n),this.state={},this.setupProperties(),this.simpleVideo=new i['default'](this.root,this.mediaData,this.attributes,o),this.setAttributes({bwEstimateOnInit:S('hls.bandwidth_estimate')}),this.bitrateForLevel=function(e){return Object(d.bitrateForLevel)(l,e)},this.getM3u8FromCache=function(e){var t;return(t=l.preloading&&l.preloading.m3u8Cache[e])?{event:t.event,stats:t.stats}:null},this.popFragFromCache=function(e,t,a){var r,i=e+'-'+t+'-'+a;if(r=l.preloading&&l.preloading.fragCache[i]){var n={event:r.event,stats:b.assign(r.stats,{alreadySampled:!0})};return delete l.preloading.fragCache[i],n}return null},this.transformPlaylist=function(e){return Object(d.transformPlaylist)(l,e)},this.setupHls()}return h(e,[{key:'setupProperties',value:function(){null==this.preloading&&(this.preloading={}),null==this.preloading.m3u8Cache&&(this.preloading.m3u8Cache={}),null==this.preloading.fragCache&&(this.preloading.fragCache={})}},{key:'setupHls',value:function(){var e=this,t=this.getHlsjsConfig();this.hls=new v.a(t),u.setup(this),p.setup(this);var a=this.adaptiveAsset();this.hls.loadSource(a.url),this.manifestParsedPromise=new O(function(t){e.hls.on(v.a.Events.MANIFEST_PARSED,t)}),this.mediaAttachedPromise=new O(function(t){e.hls.on(v.a.Events.MEDIA_ATTACHED,t)}),this.hls.attachMedia(this.simpleVideo.videoElem()),this.removeSourceElem(),c.setup(this),f.setup(this),m.setup(this),g.setup(this),this.trigger('stream-changed',this.currentAsset())}},{key:'removeSourceElem',value:function(){var e=this.videoElem(),t=Array.prototype.slice.call(e.childNodes);0<t.length&&t.map(function(t){e.removeChild(t)})}},{key:'adaptiveAsset',value:function(){var e=s.buildMasterM3u8Asset(s.masterM3u8DataUri(this.m3u8OrderedAssets()));return e.display_name='Auto',e.slug='Auto',e}},{key:'masterM3u8Content',value:function(){return s.masterM3u8ContentFromAssets(this.m3u8OrderedAssets())}},{key:'defaultAttributes',value:function(){return{contentType:'video/m3u8',qualityMin:360,qualityMax:2160,preload:'metadata'}}},{key:'m3u8OrderedAssets',value:function(){return Object(d.m3u8OrderedAssets)(this,this.allAssets)}},{key:'selectableAssets',value:function(){var e=this.m3u8OrderedAssets().sort(function(e,t){return e.width-t.width});return[this.adaptiveAsset()].concat(e)}},{key:'setupPreloading',value:function(){var e=this;this.trigger('stream-changed',Object(d.levelToAsset)(this,this.hls.startLevel)),this.hls.on(v.a.Events.MEDIA_ATTACHED,function(){e.hls.startLevel;preloadStream(e,function(){e.trigger('stream-changed',Object(d.levelToAsset)(e,e.hls.startLevel))})})}},{key:'onReady',value:function(){var e=this;return this.readyStopGo?this.readyStopGo:(this.readyStopGo=new x,this.simpleVideo.onReady().then(function(){return O.all([e.mediaAttachedPromise,e.manifestParsedPromise]).then(function(){e.readyStopGo.go()})}),this.readyStopGo)}},{key:'onWidthChange',value:function(e){var t=this;this.simpleVideo.onWidthChange(e),this.setAttributes({width:e}),this.onReady().then(function(){u.capLevelBasedOnVideoWidth(t)})}},{key:'onHeightChange',value:function(e){this.simpleVideo.onHeightChange(e),this.setAttributes({height:e})}},{key:'setAttributes',value:function(e){return b.assign(this.attributes,e),this.simpleVideo.setAttributes(e)}},{key:'play',value:function(e){return Object(d.startLoadOnce)(this),this.simpleVideo.play(e)}},{key:'seek',value:function(e,t){return Object(d.startLoadOnce)(this),this.simpleVideo.seek(e,t)}},{key:'showFirstFrame',value:function(){return this.seek(0.01)}},{key:'getAsset',value:function(e){if('number'==typeof e)return this.assetFromQuality(e);if('string'==typeof e&&'auto'===e.toLowerCase()){if('auto'===e.toLowerCase())return this.adaptiveAsset();if('4k'===e.toLowerCase())return this.assetFromQuality(2160);if(/^\d+/.test(e))return this.assetFromQuality(parseInt(e))}return e}},{key:'getCurrentQuality',value:function(){var e=this.currentAsset();return e?'Auto'===e.slug?'auto':D.numericSizeSnapped(e.width,e.height):'?'}},{key:'changeQuality',value:function(e,t,a){if('auto'===e.toString().toLowerCase())return this.changeStream('auto',t,a);var r=this.selectableAssets(),l=D.findClosestAssetByQuality(r,e);return'beforeplay'===this.getPlaybackMode()?(this.changeStreamWithoutLoad(l),O.resolve()):this.changeStream(l,t,a)}},{key:'selectableQualities',value:function(){var e=this;return this.selectableAssets().map(function(t){return e.qualityForAsset(t)})}},{key:'selectedQuality',value:function(){return this.qualityForAsset(this.selectedAsset())}},{key:'qualityForAsset',value:function(e){return'Auto'===e.slug?'auto':D.numericSizeSnapped(e.width,e.height)}},{key:'changeStreamWithoutLoad',value:function(e){if((e=this.getAsset(e),!!e)&&!(this.currentAsset()&&this.currentAsset().url===e.url)){var t;t='variable'===e.bitrate?-1:Object(d.assetToLevel)(this,e),Object(d.stopLoad)(this),this.hls.currentLevel=t}}},{key:'changeStream',value:function(e){var t=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return e=this.getAsset(e),new O(function(r){t.changeStreamWithoutLoad(e),Object(d.startLoadOnce)(t),a?t.play().then(r):r()})}},{key:'changeVideo',value:function(e,t){var a=this;return new O(function(r){a.mediaData=null,a.allAssets=[],a.attributes={},a.state={},a.state.isChangingVideo=!0,a._bindings={},a.destroyHls(),a.setupProperties(),Object(n.teardownBeforeChangeVideo)(a.simpleVideo),a.mediaData=e,a.allAssets=e.assets,a.attributes=t,Object(n.initAfterChangeVideo)(a.simpleVideo,e,t),a.setAttributes({bwEstimateOnInit:S('hls.bandwidth_estimate')}),a.setupHls(),a.state.isChangingVideo=!1,r()})}},{key:'isChangingVideo',value:function(){return!!this.state.isChangingVideo}},{key:'reset',value:function(){this.simpleVideo.reset()}},{key:'assetFromQuality',value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,a=D.withinQualityRange(this.allAssets,e,t);return 0===a.length&&(a=D.nearestOutsideRange(this.allAssets,e,t)),a[0]}},{key:'destroyHls',value:function(){var e=this,t=function(e){try{return e()}catch(t){P.error(t)}};t(function(){f.teardown(e)}),t(function(){m.teardown(e)}),t(function(){c.teardown(e)}),t(function(){p.teardown(e)}),t(function(){g.teardown(e)}),t(function(){u.teardown(e)}),t(function(){Object(d.teardown)(e)}),this.hls&&(this.hls.destroy(),this.hls=null)}},{key:'destroy',value:function(){return this._bindings={},this.destroyHls(),this.simpleVideo.destroy()}},{key:'getHlsjsConfig',value:function(){return{autoStartLoad:!1,maxFragLookUpTolerance:0.01,seekHoleNudgeDuration:0.1,abrEwmaDefaultEstimate:this.attributes.bwEstimateOnInit,abrEwmaFastVoD:4,abrEwmaSlowVoD:15,maxMaxBufferLength:this.attributes.maxMaxBufferLength||60,maxBufferSize:6e7,abrBandWidthFactor:w,abrBandWidthUpFactor:N,debug:{log:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];E.info.apply(E,['hlsjs log >'].concat(t))},error:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];E.notice.apply(E,['hlsjs error >'].concat(t))},warn:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];E.notice.apply(E,['hlsjs warn >'].concat(t))},info:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];E.info.apply(E,['hlsjs info >'].concat(t))},debug:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];E.debug.apply(E,['hlsjs debug >'].concat(t))}},loader:F,abrController:I,transformPlaylist:this.transformPlaylist,bitrateForLevel:this.bitrateForLevel,getFragFromCache:this.popFragFromCache,getM3u8FromCache:this.getM3u8FromCache}}},{key:'currentLevel',value:function(){return this.hls.currentLevel}},{key:'selectedAsset',value:function(){return 0<=this.hls.manualLevel?this.currentAsset():this.adaptiveAsset()}},{key:'currentAsset',value:function(){return 0<=this.hls.currentLevel?Object(d.levelToAsset)(this,this.hls.currentLevel)||this.adaptiveAsset():null!=this.hls.startLevel&&0<=this.hls.startLevel?Object(d.levelToAsset)(this,this.hls.startLevel)||this.adaptiveAsset():this.adaptiveAsset()}},{key:'abrBandWidthUpFactor',value:function(){return N}},{key:'abrBandWidthFactor',value:function(){return w}},{key:'diagnosticData',value:function(){var e=this,t=function(e){try{return e()}catch(t){return'ERROR: '+t.message}},a={simpleVideo:this.simpleVideo.diagnosticData(),attributes:this.attributes,currentLevel:t(function(){return e.currentLevel()}),startLevel:t(function(){return e.hls.startLevel}),nextLevel:t(function(){return e.hls.nextLevel}),loadLevel:t(function(){return e.hls.loadLevel}),autoLevel:t(function(){return e.hls.autoLevel}),autoLevelCapping:t(function(){return e.hls.autoLevelCapping}),nextAutoLevel:t(function(){return e.hls.nextAutoLevel}),manualLevel:t(function(){return e.hls.manualLevel}),bandwidthEstimate:t(function(){return e.hls.abrController.getEstimate()})};return a.currentAsset=this.currentAsset(),a.currentAsset&&a.currentAsset.url&&100<a.currentAsset.url.length&&(a.currentAsset.url=a.currentAsset.url.substring(0,97)+'...'),a.selectedAsset=this.selectedAsset(),a.selectedAsset&&a.selectedAsset.url&&100<a.selectedAsset.url.length&&(a.selectedAsset.url=a.selectedAsset.url.substring(0,97)+'...'),a}}],[{key:'fakeAutoAsset',value:function(){var e=s.buildMasterM3u8Asset('#fake');return e.slug='Auto',e.display_name='Auto',e}}]),e}();C(B.prototype,function(){return this.simpleVideo}),Object(l['default'])('HlsVideo',B);t['default']=B;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var r=a(2);null==r['default'].engines&&(r['default'].engines={});t['default']=function(e,t){r['default'].engines[e]=t};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(186),i=a(187),n=a(188),o=a(193),s=a(194),d=a(191),u=a(192),g=a(190),f=a(198),c=a(189),p=a(199),m=a(200),y=a(195),v=a(32),h=a(184),b=a(2),_=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var E=b['default'].lib('utilities/bindify'),L=E.bindify,k=b['default'].lib('utilities/obj'),A=b['default'].lib('player/lib/assets'),R=b['default'].lib('utilities/seqid'),S=b['default'].lib('promiscuous'),T=function(){function e(t,a){var l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3];r(this,e),this.uuid=R('wistia_simple_video_'),this.root=t,this.state={},y.setupProperties(this,a,l),i?y.fromOtherEngine(this,i):y.injectVideo(this),f.fixWebkitControlsBug(this),y.setupBindingsAndLoops(this),p.fit(this)}return _(e,[{key:'activeBufferRange',value:function(){return i.activeBufferRange(this)}},{key:'anyBuffered',value:function(){return i.anyBuffered(this)}},{key:'cancelFullscreen',value:function(){return d.cancelFullscreen(this)}},{key:'captureCurrentFrame',value:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return d.captureCurrentFrame.apply(d,[this].concat(t))}},{key:'changeQuality',value:function(e){return s.changeQuality(this,e)}},{key:'changeStream',value:function(e){return s.changeStream(this,e)}},{key:'changeStreamWithoutLoad',value:function(e){return s.changeStreamWithoutLoad(this,e)}},{key:'changeVideo',value:function(e,t){return s.changeVideo(this,e,t)}},{key:'currentAsset',value:function(){return this._currentAsset}},{key:'defaultAsset',value:function(){return this.selectableAssets()[0]}},{key:'destroy',value:function(){var e=this.state||{};this.state={eventContext:e.eventContext,destroyed:!0,issuedPlay:e.issuedPlay},y.killBindingsAndStopLoops(this),this._bindings={}}},{key:'diagnosticData',value:function(){return m.getDiagnosticData(this)}},{key:'eventContext',value:function(){return this.state.eventContext}},{key:'fit',value:function(){return p.fit(this)}},{key:'hasIssuedPlay',value:function(){return!!this.state.issuedPlay}},{key:'getCurrentQuality',value:function(){var e=this.currentAsset();if(e)return A.numericSizeSnapped(e.width,e.height);var t=this.selectedAsset();return t?A.numericSizeSnapped(t.width,t.height):'?'}},{key:'getCurrentTime',value:function(){return d.getCurrentTime(this)}},{key:'getDuration',value:function(){return d.getDuration(this)}},{key:'getPlaybackMode',value:function(){return c.getPlaybackMode(this)}},{key:'getPlaybackRate',value:function(){return d.getPlaybackRate(this)}},{key:'getPreload',value:function(){return d.getPreload(this)}},{key:'getState',value:function(){return d.getState(this)}},{key:'getTrim',value:function(){return g.getTrim(this)}},{key:'getVolume',value:function(){return d.getVolume(this)}},{key:'isChangingVideo',value:function(){return s.isChangingVideo(this)}},{key:'isInFullscreen',value:function(){return d.isInFullscreen(this)}},{key:'isInitializingFromUnmuted',value:function(){return d.isInitializingFromUnmuted(this)}},{key:'isMuted',value:function(){return d.isMuted(this)}},{key:'isSeeking',value:function(){return n.isSeeking(this)}},{key:'isSourceOfBrowserEvent',value:function(e){return d.isSourceOfBrowserEvent(this,e)}},{key:'lastBufferedTime',value:function(e){return i.lastBufferedTime(this,e)}},{key:'mute',value:function(){return d.mute(this)}},{key:'onEnterFullscreen',value:function(){return d.onEnterFullscreen(this)}},{key:'onHeightChange',value:function(e){return p.onHeightChange(this,e)}},{key:'onLeaveFullscreen',value:function(){return d.onLeaveFullscreen(this)}},{key:'onReady',value:function(){return o.onReady(this)}},{key:'onWidthChange',value:function(e){return p.onWidthChange(this,e)}},{key:'pause',value:function(){return d.pause(this)}},{key:'play',value:function(e){return d.play(this,e)}},{key:'playType',value:function(){return d.playType(this)}},{key:'requestFullscreen',value:function(){return d.requestFullscreen(this)}},{key:'reset',value:function(){this.state={}}},{key:'seek',value:function(e,t){return n.seek(this,e,t)}},{key:'seekOnPlay',value:function(e){return n.seekOnPlay(this,e)}},{key:'selectedAsset',value:function(){return this._currentAsset}},{key:'selectableAssets',value:function(){return this.allAssets}},{key:'selectableQualities',value:function(){return this.selectableAssets().map(function(e){return'variable'===e.width?e.slug:A.numericSizeSnapped(e.width,e.height)}).sort(function(e,t){return('auto'===e?-1:e)-('auto'===t?-1:t)})}},{key:'selectedQuality',value:function(){var e=this.selectedAsset();return e?A.numericSizeSnapped(e.width,e.height):'?'}},{key:'sequentialBufferedRange',value:function(){return i.sequentialBufferedRange(this)}},{key:'setAttributes',value:function(e){k.assign(this.attributes,e)}},{key:'onPlayed',value:function(){var e=this,t=this.state;return t&&t.hasPlayed?S.resolve():new S(function(t){e.bind('playing',function a(){e.unbind('playing',a),t()})})}},{key:'setCurrentTime',value:function(e){return d.setCurrentTime(this,e)}},{key:'setPlaybackRate',value:function(e){return d.setPlaybackRate(this,e)}},{key:'setTrim',value:function(e){return g.setTrim(this,e)}},{key:'setVolume',value:function(e){return d.setVolume(this,e)}},{key:'showFirstFrame',value:function(){return n.seek(this,0.01)}},{key:'stopStreaming',value:function(){return s.stopStreaming(this)}},{key:'timeBeforeEndOfBuffer',value:function(e){return i.timeBeforeEndOfBuffer(this,e)}},{key:'totalBuffered',value:function(){return i.totalBuffered(this)}},{key:'totalPlayed',value:function(){return l.sumTimeRanges(this.video.played)}},{key:'unmute',value:function(){return d.unmute(this)}},{key:'videoElem',value:function(){return d.videoElem(this)}}]),e}();L(T.prototype),T.delegatePublicMethods=v.delegatePublicMethods,T.PUBLIC_METHODS=v.PUBLIC_METHODS,T.mediaDataWithAssets=function(e,t){var a=k.clone(e);return a.assets=k.clone(t),a},Object(h['default'])('SimpleVideo',T),b['default'].define('player/engines/simple_video/index.js',T);t['default']=T;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'createElement',function(){return h});a.d(t,'setupVideoElemAttributes',function(){return _});a.d(t,'inferTypeAttribute',function(){return E});a.d(t,'srcProtocolAndHost',function(){return L});a.d(t,'tinyMp4Url',function(){return k});a.d(t,'sumTimeRanges',function(){return A});a.d(t,'bufferedInfo',function(){return R});a.d(t,'properAssetUrl',function(){return S});var r=a(2),l=r['default'].lib('utilities/detect'),i=l.cachedDetect,n=r['default'].lib('player/lib/elem'),o=n.elemFromObject,s=r['default'].lib('utilities/url'),d=s.Url,u=r['default'].lib('player/lib/assets'),g=u.isBakeryUrl,f=r['default'].lib('player/lib/hosts'),c=f.eV1Protocol,p=f.eV1Host,m=f.deliveryHost,y=i(),v=c()+'//'+p()+'/assets/images/blank.gif',h=function(e,t,a){var r={tagName:'video',id:e,crossorigin:'anonymous',style:{background:'transparent',display:'block',height:'100%',maxHeight:'none',maxWidth:'none',position:'static',visibility:'visible',width:'100%'}};(y.browser.msie||y.trident)&&(r.style.minWidth='10px',r.style.minHeight='10px');var l={tagName:'source',src:S(t.url),type:E(t,a)};return a.excludeSourceElem||(r.childNodes=[l]),_(o(r),t,a)},b=function(e,t,a){null!=a&&!1!==a?!0===a?(e[t]=!0,e.setAttribute(t,'')):(e[t]=a,e.setAttribute(t,a)):(e[t]=!1,e.removeAttribute(t))},_=function(e,t,a){return a.poster?(e.poster=a.poster,e.setAttribute('poster',a.poster)):(e.poster=v,e.setAttribute('poster',v)),b(e,'src',S(t.url)),b(e,'controlslist',a.controlslist||'nodownload'),b(e,'playsinline',a.playsinline),b(e,'muted',a.muted),b(e,'loop',a.loop),b(e,'controls',null!=a.controls&&a.controls),b(e,'preload',a.preload||'none'),b(e,'type',E(t,a)),b(e,'x-webkit-airplay',null==a.webkitAirplay?'allow':a.webkitAirplay),null!=a.volume&&(e.volume=a.volume),e},E=function(e,t){if(null!=t.contentType)return t.contentType;var a='video/'+e.ext;return t.spherical&&(a+=';dimension=360;'),a},L=function(e){if(g(e)){var t=new d(e);if(t.protocol)return t.protocol+'//'+t.host}return c()+'//'+m(c())},k=function(e){return L(e)+'/tiny.mp4'},A=function(e){if(null==e)return null;for(var t=0,a=0;a<e.length;a++)t+=e.end(a)-e.start(a);return t},R=function(e,t,a){var r,l,n,o,s,i=[];for(e.sort(function(e,t){var a=e.start-t.start;return a?a:t.end-e.end}),s=0;s<e.length;s++){var d=i.length;if(d){var u=i[d-1].end;e[s].start-u<a?e[s].end>u&&(i[d-1].end=e[s].end):i.push(e[s])}else i.push(e[s])}for(s=0,r=0,l=n=t;s<i.length;s++){var g=i[s].start,f=i[s].end;if(t+a>=g&&t<f)l=g,n=f,r=n-t;else if(t+a<g){o=g;break}}return{len:r,start:l,end:n,nextStart:o}},S=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'mp4';return g(e)?/\.bin$/.test(e)?e.replace(/\.bin$/,'')+('/file.'+t):e:e};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'anyBuffered',function(){return l});a.d(t,'activeBufferRange',function(){return i});a.d(t,'totalBuffered',function(){return n});a.d(t,'sequentialBufferedRange',function(){return o});a.d(t,'bufferInfo',function(){return s});a.d(t,'lastBufferedTime',function(){return d});a.d(t,'timeBeforeEndOfBuffer',function(){return u});var r=a(186),l=function(e){var t=e.video;return 0<t.buffered.length&&0<t.buffered.end(0)},i=function(e){for(var t=e.video,a=t.currentTime,r=0;r<t.buffered.length;r++){var l=t.buffered.start(r),i=t.buffered.end(r);if(l<=a&&a<i)return[l,i]}return null},n=function(e){return r.sumTimeRanges(e.video.buffered)},o=function(e){var t=e.video,a=t.buffered,r=null;try{for(var l=0;l<a.length;l++){var i=a.start(l)-.5,n=a.end(l)+.5;if(i<=t.currentTime&&t.currentTime<n){r=l;break}}if(null!=r){for(var o=r,s=r;s<a.length;s++){var d=a.start(s)-.5,u=a.end(o)+.5;if(d<=u)o=s;else break}var g=a.start(r),f=a.end(o);return[g,f]}return null}catch(t){return logger.error(t),null}},s=function(e,t,a){var l=e.video;if(l){var n,i=l.buffered,o=[];for(n=0;n<i.length;n++)o.push({start:i.start(n),end:i.end(n)});return r.bufferedInfo(o,t,a)}return{len:0,start:0,end:0,nextStart:void 0}},d=function(e,t){return s(e,e.getCurrentTime(),t).end},u=function(e,t){return d(e,t)-e.getCurrentTime()};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'seek',function(){return y});a.d(t,'seekOnPlay',function(){return _});a.d(t,'isSeeking',function(){return L});var r=a(189),l=a(190),i=a(2),n=a(191),o=i['default'].lib('promiscuous'),s=i['default'].lib('utilities/obj'),d=s.assign,u=i['default'].lib('player/lib/elem'),g=u.elemBind,f=u.elemUnbind,c=i['default'].lib('utilities/wlog'),p=c.wlog,m=p.getPrefixedFunctions('SimpleVideo'),y=function(e,a,t){return l.isStartDefined(e)?v(e,a+e.attributes.trimStart,t):v(e,a,t)},v=function(e,a,t){return m.info('seek',a),e.getPlaybackMode()===r.BEFORE_PLAY?h(e,a,t):b(e,a,t)},h=function(a,e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=a.video;return m.info('seekBeforePlay',e),new o(function(l,i){m.info('time '+e+': seek beforeplay');var s='playing'===a.getPlaybackMode();r.style.visibility='hidden',d(a.state,{seeking:!0}),m.info('time '+e+': start stream by calling play'),Object(n.playWithoutTrim)(a).then(function(i){m.info('time '+e+': jump to time after playing'),r.currentTime=e;var u=new o(function(r){s||!1===t.pause?(m.info('time: '+e+': play after seek'),r()):(m.info('time: '+e+': pause after seek'),Object(n.pause)(a).then(r))});E(a).then(function(){u.then(function(){r.style.visibility='inherit',d(a.state,{seeking:!1}),l(i)})})}).catch(function(t){r.style.visibility='inherit',d(a.state,{seeking:!1}),i(t)})})},b=function(e,a){return m.info('seekNow',a),new o(function(t){m.info('seekNow: start',a),e.video.currentTime=a,E(e).then(function(){m.info('seekNow: resolve',a),t()})})},_=function(e,a){return new o(function(t){'playing'===e.getPlaybackMode()?b(e,a).then(t):e.bind('playing',function(){return b(e,a).then(t),e.unbind})})},E=function(e){var t=e.video;return new o(function(e){t.seeking?(m.info('waiting for seek'),g(t,'seeked',function(){return m.info('seeked'),e(),f})):(m.info('no wait for seek'),e())})},L=function(e){return!!e.state.seeking};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'BEFORE_PLAY',function(){return o});a.d(t,'ENDED',function(){return s});a.d(t,'PAUSED',function(){return d});a.d(t,'PLAYING',function(){return u});a.d(t,'UNKNOWN',function(){return g});a.d(t,'getPlaybackMode',function(){return f});var r=a(2),l=r['default'].lib('utilities/wlog'),i=l.wlog,n=i.getPrefixedFunctions('SimpleVideo'),o='beforeplay',s='ended',d='paused',u='playing',g='unknown',f=function(e){var t=e.video;try{return e.state.hasPlayed?e.state.fakeEnded||t.ended?s:t.paused?d:u:o}catch(t){return n.warn(t),g}};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'isStartDefined',function(){return d});a.d(t,'isBeforeStart',function(){return u});a.d(t,'isEndDefined',function(){return g});a.d(t,'isAfterEnd',function(){return f});a.d(t,'enforceTrimming',function(){return c});a.d(t,'enforceTrimmingNow',function(){return p});a.d(t,'setTrim',function(){return m});a.d(t,'getTrim',function(){return y});a.d(t,'teardown',function(){return v});var r=a(2),l=r['default'].lib('player/lib/elem'),i=l.elemBind,n=l.elemUnbind,o=r['default'].lib('utilities/event_loop'),s=o.globalEventLoop,d=function(e){return null!=e.attributes.trimStart&&0<e.attributes.trimStart},u=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1e-3;return d(e)&&e.video.currentTime<e.attributes.trimStart-t},g=function(e){return null!=e.attributes.trimEnd&&0<e.attributes.trimEnd},f=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;return g(e)&&e.video.currentTime>e.attributes.trimEnd+t},c=function(e){e.video;s.add(e.uuid+'.enforce_trimming',100,function(){p(e)})},p=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0.5;'beforeplay'===e.getPlaybackMode()||(e.state.fakeEnded&&!f(e)?e.state.fakeEnded=!1:!e.state.fakeEnded&&f(e)&&(e.state.fakeEnded=!0,e.attributes.loop?(e.trigger('ended'),e.seek(0).then(function(){return e.play()})):(e.pause(),e.trigger('ended'))),u(e,t)?e.seek(0):f(e,t)&&e.seek(e.getDuration()))},m=function(e,t){var a=t.start,r=t.end,l=null==t.sensitivity?0.1:t.sensitivity;null!=a&&(0<=a?e.attributes.trimStart=t.start:delete e.attributes.trimStart),null!=r&&(0<=r?e.attributes.trimEnd=t.end:delete e.attributes.trimEnd),c(e,l)},y=function(e){return{start:e.attributes.trimStart||-1,end:e.attributes.trimEnd||-1}},v=function(e){s.remove(e.uuid+'.enforce_trimming')};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'play',function(){return R});a.d(t,'playWithoutTrim',function(){return S});a.d(t,'playType',function(){return T});a.d(t,'pause',function(){return D});a.d(t,'setCurrentTime',function(){return x});a.d(t,'setCurrentTimeWithoutTrimming',function(){return C});a.d(t,'getCurrentTime',function(){return P});a.d(t,'getState',function(){return O});a.d(t,'setVolume',function(){return I});a.d(t,'getVolume',function(){return F});a.d(t,'supportsPlaybackRate',function(){return w});a.d(t,'setPlaybackRate',function(){return N});a.d(t,'getPlaybackRate',function(){return B});a.d(t,'getDuration',function(){return M});a.d(t,'getDurationWithoutTrimming',function(){return G});a.d(t,'isSourceOfBrowserEvent',function(){return U});a.d(t,'isMuted',function(){return W});a.d(t,'getPreload',function(){return V});a.d(t,'mute',function(){return H});a.d(t,'unmute',function(){return K});a.d(t,'onEnterFullscreen',function(){return j});a.d(t,'onLeaveFullscreen',function(){return q});a.d(t,'isInitializingFromUnmuted',function(){return z});a.d(t,'isInFullscreen',function(){return Y});a.d(t,'onWidthChange',function(){return Q});a.d(t,'onHeightChange',function(){return X});a.d(t,'videoElem',function(){return Z});a.d(t,'requestFullscreen',function(){return $});a.d(t,'cancelFullscreen',function(){return J});a.d(t,'captureCurrentFrame',function(){return ee});var r=a(192),l=a(190),i=a(2),n=i['default'].lib('promiscuous'),o=i['default'].lib('player/lib/elem'),s=o.elemBind,d=o.elemUnbind,u=o.safeRequestAnimationFrame,g=o.elemRequestFullscreen,f=o.elemCancelFullscreen,c=o.inUserEventContext,p=i['default'].lib('utilities/wlog'),m=p.wlog,y=i['default'].lib('utilities/detect'),v=y.cachedDetect,h=i['default'].lib('utilities/obj'),b=h.merge,_=m.getPrefixedFunctions('SimpleVideo'),E=v(),L='play',k='play-silently',A='cannot-play',R=function(e,t){return e.state.fakeEnded||l.isBeforeStart(e)?new n(function(a,r){e.seek(0,{pause:!1}).then(function(l){S(e,b({},t,{playType:L})).then(function(){a(l)}).catch(r)}).catch(r)}):S(e,t)},S=function(t){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.video,l=a.playType||T(t,a);return null==t.state.issuedPlay&&l!==A&&(t.state.issuedPlay=!0),new n(function(e,i){t.state.lastPlayRejected=!1;var n=t.getPlaybackMode();if(_.info('play: start',l),'playing'===n)_.info('play: already playing, resolve'),e(L);else if(l===A)i(new Error('Cannot issue play.'));else{l===k&&t.mute(),t.trigger('beforeplay'),'ended'===n&&0<E.ios.version&&r.load();var o=r.play();if(o&&o.then&&o.catch)o.then(function(){_.info('play: got',l,'resolve'),e(l)}).catch(function(n){_.notice(n),t.state.lastPlayRejected=!0;var o=null==a.silentAutoPlay?t.attributes.silentAutoPlay:a.silentAutoPlay;l!==L||t.isMuted()||'allow'!==o&&null!=o?(_.notice('play: rejected'),i(n)):(t.mute(),r.play().then(function(){_.info('play: got silent fallback, resolve'),e(k)}).catch(function(a){t.unmute(),i(a)}))});else{setTimeout(function(){E.ios.version&&10.1>E.ios.version&&r.paused&&i(new Error('Video still paused after play issued.'))},10);var s=function(){return _.info('play: got playing, resolve'),e(l),d};t.bind('playing',s)}}})},T=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if('playing'===e.getPlaybackMode())return L;if(e.isInitializingFromUnmuted())return L;if(c())return L;var a=e.attributes,r=null==t.silentAutoPlay?a.silentAutoPlay:t.silentAutoPlay;return!0===r?e.isMuted()?L:k:!1===r?L:'allow'===r||null==r?E.autoPlayWithSound||e.isMuted()?L:k:L},D=function(e){var t=e.video;return _.info('pause'),new n(function(e){_.info('pause: start'),t.pause(),u(function(){_.info('pause: resolve'),e()})})},x=function(e,a){return l.isStartDefined(e)?C(e,a+e.attributes.trimStart):C(e,a)},C=function(e,a){_.info('setCurrentTime',a),e.video.currentTime=a},P=function(e){return l.isStartDefined(e)?Math.max(0,e.video.currentTime-e.attributes.trimStart):e.video.currentTime},O=function(e){return{playbackMode:e.getPlaybackMode(),currentTime:e.getCurrentTime(),volume:e.getVolume(),playbackRate:e.getPlaybackRate()}},I=function(e,t){_.info('setVolume',t),e.video.volume=t},F=function(e){return e.video.volume},w=function(e){return null!=e.video.playbackRate},N=function(e,t){_.info('setPlaybackRate',t),w(e)?e.video.playbackRate=t:_.info('playbackRate is supported on',e.video)},B=function(e){return w(e)?e.video.playbackRate:1},M=function(e){return l.isStartDefined(e)&&l.isEndDefined(e)?Math.max(0,e.attributes.trimEnd-e.attributes.trimStart):l.isStartDefined(e)?G(e)-e.attributes.trimStart:l.isEndDefined(e)?e.attributes.trimEnd:G(e)},G=function(e){var t=e.attributes;if(null!=t.duration)return t.duration;return 2<=e.video.readyState?e.video.duration:void 0},U=function(e,t){return t.target==e.video},W=function(e){var t=e.video;return!!(t.muted||e.state.loadedMetadata&&0===t.volume||e.state.hasPlayed&&t.audioTracks&&0===t.audioTracks.length)},V=function(e){return e.video.getAttribute('preload')},H=function(e){e.video.muted=!0,e.video.setAttribute('muted','muted')},K=function(e){e.video.muted=!1,e.video.removeAttribute('muted')},j=function(e){e.state.isInFullscreen=!0;var t=e.attributes.backgroundColor||'#000';e.video.style.backgroundColor=t},q=function(e){e.state.isInFullscreen=!1,e.video.style.backgroundColor='transparent'},z=function(e){var t=e.state;return t.isInitializingFromOtherEngine&&t.otherEnginePlayed&&!t.otherEngineWasMuted},Y=function(e){return!!e.state.isInFullscreen},Q=function(){},X=function(){},Z=function(e){return e.video},$=function(e){e.setAttributes({fitStrategy:'contain'}),e.fit(),g(e.video)},J=function(e){e.setAttributes({fitStrategy:'auto'}),e.fit(),f(e.video)},ee=function(e){for(var t=arguments.length,a=Array(1<t?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];var l=e.video,i=document.createElement('canvas');return i.width=l.videoWidth,i.height=l.videoHeight,i.getContext('2d').drawImage(l,0,0,i.width,i.height),i.toDataURL.apply(i,a)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setup',function(){return s});a.d(t,'isInVideoEventContext',function(){return d});a.d(t,'teardown',function(){return u});var r=a(2),l=r['default'].lib('player/lib/elem'),i=l.elemBind,n=l.elemUnbind,o=['beforeplay','ended','error','loadeddata','loadedmetadata','loadstart','pause','playing','progress','ratechange','seeked','volumechange','timeupdate','waiting','webkitbeginfullscreen','webkitendfullscreen','webkitplaybacktargetavailabilitychanged'],s=function(e){for(var t,a=0;a<o.length;a++)t=o[a],function(t,a){var r='_marshalEvent_'+a;e[r]=e[r]||function(r){null==e.state&&(e.state={}),'playing'===a&&('playing'!==a||t.paused)||(e.state.eventContext=r,e.trigger(a,r),e.state.eventContext=null)},i(t,a,e[r])}(e.video,t)},d=function(e){return!!(e.state&&e.state.eventContext)},u=function(e){for(var t=0;t<o.length;t++){var a=o[t];n(e.video,a,e['_marshalEvent_'+a])}};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'onReady',function(){return h});var r=a(2),l=r['default'].lib('promiscuous'),i=r['default'].lib('utilities/wlog'),n=i.wlog,o=r['default'].lib('player/lib/elem'),s=o.elemBind,d=o.elemUnbind,u=r['default'].lib('utilities/detect'),g=u.cachedDetect,f=r['default'].lib('player/lib/timeout-utils'),c=f.doTimeout,p=f.clearTimeouts,m=r['default'].lib('utilities/stopgo'),y=n.getPrefixedFunctions('SimpleVideo'),v=g(),h=function(e){var t=e.video;null==e.state&&(e.state={});var a=e.state;if(a.onReadyStopGo)return a.onReadyStopGo;var r=new m;if(a.onReadyStopGo=r,a.hasBeenReady)r.go();else{if(2<=t.readyState)y.info('ready readyState',t.src,t.readyState),a.hasBeenReady=!0,r.go();else{var l=function(){p(e.uuid+'.ready_fallback'),y.info('ready loadstart'),a.hasBeenReady=!0,r.go()};e.bind('loadstart',l),c(e.uuid+'.ready_fallback',function(){a.hasBeenReady||(y.info('ready fallback'),a.hasBeenReady=!0,r.go())},200)}return r}};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'stopStreaming',function(){return y});a.d(t,'changeQuality',function(){return v});a.d(t,'changeStreamWithoutLoad',function(){return h});a.d(t,'changeStream',function(){return b});a.d(t,'changeVideo',function(){return E});a.d(t,'initAfterChangeVideo',function(){return k});a.d(t,'isChangingVideo',function(){return _});a.d(t,'teardownBeforeChangeVideo',function(){return L});var r=a(186),l=a(195),i=a(2),n=i['default'].lib('promiscuous'),o=i['default'].lib('utilities/wlog'),s=o.wlog,d=i['default'].lib('player/lib/elem'),u=d.elemInDom,g=d.elemBind,f=d.elemUnbind,c=i['default'].lib('player/lib/assets'),p=s.getPrefixedFunctions('SimpleVideo'),m=function(e){for(var t,a=e.video,r=[],l=0;l<a.childNodes.length;l++)t=a.childNodes[l],1===t.nodeType&&'source'===t.tagName.toLowerCase()&&r.push(t);return r},y=function(e){try{if(e.state.destroyed)return;p.info('stopStreaming');var t=e.video;t.src=r.srcProtocolAndHost(t.getAttribute('src'))+'/tiny.mp4',t.load()}catch(t){p.notice(t)}},v=function(e,t,a,r){var l=e.selectableAssets(),i=c.findClosestAssetByQuality(l,t);return'beforeplay'===e.getPlaybackMode()?(h(e,i),n.resolve()):b(e,i,a,r)},h=function(e,t){p.info('changeStreamWithoutLoad',t&&t.slug,t);var a=e.video;if(u(a)){var l=r.properAssetUrl(t.url,t.container);e.state={eventContext:e.state.eventContext},e._currentAsset=t,a.src=l;var i=m(e);0<i.length&&(i[0].src=l),e.trigger('stream-changed',e._currentAsset)}},b=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,l=3<arguments.length&&void 0!==arguments[3]&&arguments[3];p.info('changeStream',a,l,t&&t.slug,t);var i=e.video;return e.asset=t,new n(function(n){var o=r.properAssetUrl(t.url,t.container);if(!l&&o===i.getAttribute('src'))return void n();var s=e.getState();e.state.seeking=!0,g(i,'loadstart',function(){return l?(i.style.visibility='visible',e.state.seeking=!1,n()):2<s.currentTime?e.seek(s.currentTime).then(function(){'playing'===s.playbackMode?e.play().then(function(){e.state.seeking=!1,i.style.visibility='visible',n()}):e.pause().then(function(){i.style.visibility='visible',e.state.seeking=!1,n()})}):('playing'===s.playbackMode&&e.play(),i.style.visibility='visible',e.state.seeking=!1,n()),e.setPlaybackRate(s.playbackRate),f}),i.style.visibility='hidden',h(e,t,l),'beforeplay'===s.playbackMode||a||e.play()})},_=function(e){return!!e.state.isChangingVideo},E=function(e,t,a){return L(e),e.state.isChangingVideo=!0,k(e,t,a),new n(function(t){b(e,e.defaultAsset()).then(function(){e.state.isChangingVideo=!1,t()})})},L=function(e){var t=e.state.eventContext;e.destroy(),e.state.eventContext=t},k=function(e,t,a){l.setupProperties(e,t,a),l.setupBindingsAndLoops(e,e.allAssets,a)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setupProperties',function(){return f});a.d(t,'injectVideo',function(){return c});a.d(t,'fromOtherEngine',function(){return p});a.d(t,'setupBindingsAndLoops',function(){return m});a.d(t,'killBindingsAndStopLoops',function(){return y});var r=a(186),l=a(196),i=a(197),n=a(190),o=a(198),s=a(192),d=a(2),u=d['default'].lib('player/lib/elem'),g=u.elemAppend,f=function(e,t,a){var r=t.assets;0===r.length&&(r=[{}]),e.mediaData=t,e.allAssets=r,e.attributes=a},c=function(e){e._currentAsset=e.defaultAsset(),e.video=r.createElement(e.uuid,e._currentAsset,e.attributes),e.onReady(),g(e.root,e.video)},p=function(e,t){var a=t.isMuted(),l=t.hasIssuedPlay();e.video=t.videoElem(),e.onReady(),e.bind('loadstart',function(){return setTimeout(function(){e.state.isInitializingFromOtherEngine=!1},0),e.unbind}),r.setupVideoElemAttributes(e.video,e.defaultAsset(),e.attributes),e.state.eventContext=t.eventContext(),e.root.appendChild(e.video),e._currentAsset=e.defaultAsset(),e.changeStreamWithoutLoad(e.defaultAsset()),e.state.isInitializingFromOtherEngine=!0,e.state.otherEngineWasMuted=a,e.state.otherEnginePlayed=l,e.video.load()},m=function(e){i.setup(e),n.enforceTrimming(e),s.setup(e),l.setup(e)},y=function(e){s.teardown(e),n.teardown(e),l.teardown(e),i.teardown(e)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setup',function(){return s});a.d(t,'teardown',function(){return d});var r=a(2),l=r['default'].lib('utilities/obj'),i=r['default'].lib('utilities/event_loop'),n=i.globalEventLoop,o=function(e){var t=e.attributes,a=null==t.eventLoopDuration?300:t.eventLoopDuration;return a/e.getPlaybackRate()},s=function(e){null==e.state&&(e.state={}),'playing'===e.getPlaybackMode()&&(e.state.hasPlayed=!0),e.bind('playing',function(){e.state.hasPlayed=!0}),e.bind('waiting',function(){e.state.gotWaiting=!0}),e.bind('loadedmetadata',function(){e.state.loadedMetadata=!0}),l.assign(e.state,{lastPlaybackMode:e.getPlaybackMode(),lastTimePosition:e.getCurrentTime(),lastEventLoopDuration:o(e)});var t=e.uuid+'.custom_state_and_events';n.add(t,o(e),function(){l.assign(e.state,{lastTimePosition:e.getCurrentTime(),lastPlaybackMode:e.getPlaybackMode(),lastEventLoopDuration:o(e)}),n.interval(t,o(e))})},d=function(e){var t=e.uuid+'.custom_state_and_events';n.remove(t)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'maybeTriggerWaiting',function(){return c});a.d(t,'setup',function(){return g});a.d(t,'teardown',function(){return f});var r=a(2),l=r['default'].lib('utilities/obj'),i=r['default'].lib('player/lib/elem'),n=i.elemBind,o=i.elemUnbind,s=r['default'].lib('utilities/event_loop'),d=s.globalEventLoop,u=function(e){var t=e.attributes,a=null==t.eventLoopDuration?300:t.eventLoopDuration;return a/e.getPlaybackRate()},g=function(e){null==e.state&&(e.state={}),e.state.waiting=-1;var t=e.uuid+'.waiting_events';d.add(t,u(e),function(){c(e),d.interval(t,u(e))})},f=function(e){var t=e.uuid+'.waiting_events';d.remove(t)},c=function(e){var t=e.video,a=e.state,r=a.lastPlaybackMode,i=a.gotWaiting&&'beforeplay'===e.getPlaybackMode()||'playing'===e.getPlaybackMode(),s='playing'===r||'beforeplay'===r&&!a.lastPlayRejected,d=a.lastEventLoopDuration||u(e);if(!(i&&s))p(e);else if(e.getCurrentTime()===a.lastTimePosition){var g=a.startedWaitingAt;g?(a.waiting=(new Date().getTime()-g)/1e3,e.trigger('custom-waiting',a.waiting)):(l.assign(a,{startedWaitingAt:new Date().getTime()-d,waiting:d/1e3}),e.trigger('custom-waiting',d/1e3),n(t,'timeupdate',function(){return p(e),o}))}else p(e)},p=function(e){var t=e.state.waiting;l.assign(e.state,{waiting:-1,startedWaitingAt:null}),null!=t&&0<=t&&e.trigger('custom-done-waiting',t)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'fixWebkitControlsBug',function(){return u});var r=a(2),l=r['default'].lib('utilities/detect'),i=l.cachedDetect,n=r['default'].lib('utilities/wlog'),o=n.wlog,s=i(),d=o.getPrefixedFunctions('SimpleVideo'),u=function(e){var t=e.video;if(s.browser.webkit){d.info('fixWebkitControlsBug');var a=t.getAttribute('controls');t.setAttribute('controls','controls'),t.removeAttribute('controls'),null!=a&&t.setAttribute('controls',a)}};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'onWidthChange',function(){return f});a.d(t,'onHeightChange',function(){return c});a.d(t,'fit',function(){return y});var r=a(2),l=r['default'].lib('player/lib/elem'),i=l.elemStyle,n=l.elemWidth,o=l.elemHeight,s=r['default'].lib('player/lib/assets'),d=r['default'].lib('utilities/detect'),u=d.cachedDetect,g=u(),f=function(e,t){return e.setAttributes({width:t}),y(e)},c=function(e,t){return e.setAttributes({height:t}),y(e)},p='contain',m='fill',y=function(e){var t=e.attributes.fitStrategy||v(e);return t===p?b(e):t==='cover'?h(e):t===m?_(e):b(e)},v=function(e){var t=Math.abs,a=e.attributes.height,r=e.attributes.width,l=s.originalAspect(e.allAssets),i=2*Math.floor(r/l/2),n=t(i-a),o=t(a*l-r),d=g.firefox&&g.browser.mozilla&&36<=g.browser.version;return g.browser.webkit||d?0<n&&10>=n&&0<o&&10>=o?m:p:p},h=function(e){var t=e.video,a=e.attributes,r=s.videoAspect(e.allAssets),l=n(e.root),d=o(e.root);g.trident||g.edge||g.browser.msie?l/d<=r?i(t,{height:'100%',left:'50%',objectFit:'contain',position:'relative',top:'50%',transform:'translate(-50%,-50%)',width:'1920px'}):i(t,{height:'1088px',left:'50%',objectFit:'contain',position:'relative',top:'50%',transform:'translate(-50%,-50%)',width:'100%'}):i(t,{objectFit:'cover'})},b=function(e){var t=e.video;i(t,{objectFit:'contain',height:'100%',width:'100%'})},_=function(e){var t=e.video;i(t,{objectFit:'fill',height:'100%',width:'100%'})};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'getDiagnosticData',function(){return l});var r=function(e){try{return e()}catch(t){return'ERROR: '+t.message}},l=function(e){var t={};return t.state=e.state,t.attributes=e.attributes,t.currentAsset=e.currentAsset(),t.currentAsset&&t.currentAsset.url&&100<t.currentAsset.url.length&&(t.currentAsset.url=t.currentAsset.url.substring(0,97)+'...'),t.selectedAsset=e.selectedAsset(),t.selectedAsset&&t.selectedAsset.url&&100<t.selectedAsset.url.length&&(t.selectedAsset.url=t.selectedAsset.url.substring(0,97)+'...'),t.getState=r(function(){return e.getState()}),t.getDuration=r(function(){return e.getDuration()}),t.getPlaybackRate=r(function(){return e.getPlaybackRate()}),t.getPlaybackMode=r(function(){return e.getPlaybackMode()}),t.isSeeking=r(function(){return e.isSeeking()}),t.getCurrentTime=r(function(){return e.getCurrentTime()}),t.activeBufferRange=r(function(){return e.activeBufferRange()}),t.sequentialBufferedRange=r(function(){return e.sequentialBufferedRange()}),t.getVolume=r(function(){return e.getVolume()}),t.timeBeforeEndOfBuffer=r(function(){return e.timeBeforeEndOfBuffer()}),t.lastBufferedTime=r(function(){return e.lastBufferedTime()}),t.totalBuffered=r(function(){return e.totalBuffered()}),t.anyBuffered=r(function(){return e.anyBuffered()}),t.getPreload=r(function(){return e.getPreload()}),t.rawVideoProps=r(function(){return i(e)}),t},n=['autoplay','controls','crossOrigin','currentSrc','currentTime','defaultMuted','defaultPlaybackRate','duration','ended','error','loop','muted','networkState','paused','playbackRate','preload','readyState','seeking','src','startDate','volume'],i=function(e){for(var t=e.video,a={},r=0;r<n.length;r++){var l=n[r],i=t[l];a[l]=i}return a};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'adaptiveAsset',function(){return c});a.d(t,'allHlsAssets',function(){return p});a.d(t,'rejectAudioAsset',function(){return m});a.d(t,'mediumQualityStartingAsset',function(){return y});a.d(t,'anyViableAsset',function(){return v});a.d(t,'bestAssetForCurrentSize',function(){return h});a.d(t,'filterByQualityAndMaxWidth',function(){return b});a.d(t,'webPlayable',function(){return _});a.d(t,'buildMasterM3u8Asset',function(){return E});a.d(t,'masterM3u8ContentFromAssets',function(){return L});a.d(t,'masterM3u8DataUri',function(){return k});a.d(t,'masterM3u8Url',function(){return A});a.d(t,'maxAssetWidthBasedOnVideoWidth',function(){return R});a.d(t,'filterAssetsForScreencast',function(){return S});var r=a(2),l=r['default'].lib('player/lib/assets'),i=r['default'].lib('utilities/obj'),n=r['default'].lib('utilities/detect'),o=n.cachedDetect,s=r['default'].lib('utilities/core'),d=s.base64Encode,u=r['default'].lib('player/lib/hosts'),g=u.eV1Protocol,f=u.eV1Host,c=function(e){var t=e.m3u8OrderedAssets(),a=k(t),r=E(a);return r.display_name='Auto',r.slug='Auto',r},p=function(e){return l.filter(e,{container:'m3u8',segment_duration:3,type:'hls_video',status:l.READY,metadata:function(e){return e&&e.max_bitrate}}).sort(function(e,t){return(e.metadata.max_bitrate||0)-(t.metadata.max_bitrate||0)})},m=function(e,t){return i.filter(t,function(e){return'Audio'!=e.display_name})},y=function(e,t){return h(e,t,{maxWidth:1279})},v=function(e,t){return l.one(t,{sortBy:'width asc'})},h=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},r=b(e,t,a);return r[r.length-1]},b=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},r=e.attributes,i=r.qualityMin,n=r.qualityMax,o=l.withinQualityRange(t,i,n);0===o.length&&(o=l.nearestOutsideRange(t,i,n));var s=Math.min(a.maxWidth||8192,R(r.width,r.devicePixelRatio)),d=l.filter(o,{width:[0,s]});return 0===d.length?[o[0]]:d},_=function(e,t){var a=e.attributes.detect||o();return a.browser.msie?l.filter(t,{height:[0,1088]}):t},E=function(e){return{bitrate:'variable',ext:'m3u8',height:'variable',public:!0,size:'variable',type:'hls_video',url:e,width:'variable',slug:'hls_master_m3u8_seg3s'}},L=function(e){for(var t='#EXTM3U',a=[],r=0;r<e.length;r++){var l=e[r],i=8*l.metadata.max_bitrate;a.push('#EXT-X-STREAM-INF:PROGRAM-ID=1,CLOSED-CAPTIONS=NONE,BANDWIDTH='+i+',NAME='+l.display_name+'\n'+l.url)}return t+'\n'+a.join('\n')},k=function(e){var t=L(e);return'data:application/x-mpegURL;base64,'+d(t)},A=function(e){var t=1<arguments.length&&arguments[1]!==void 0&&arguments[1];return g()+'//'+f()+'/embed/medias/'+e+'.m3u8?segment_duration=3&exclude_audio='+!t},R=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:window.devicePixelRatio||1,a=Math.max(1.25,t)*1.2;return e*a},S=function(e,t){var a=i.filter(t,function(e){return e.width>640});return 0<a.length?a:t};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'UNOBTAINABLE_BITRATE',function(){return L});a.d(t,'filteredHlsAssets',function(){return k});a.d(t,'m3u8OrderedAssets',function(){return A});a.d(t,'startingAssetBasedOnBandwidthEstimate',function(){return R});a.d(t,'assetsWithNormalBitrates',function(){return S});a.d(t,'assetsWithUnobtainableBitrates',function(){return T});a.d(t,'modifyBitratesBasedOnQualityRange',function(){return D});a.d(t,'setUnobtainableBitrate',function(){return x});a.d(t,'cautiousThreshold',function(){return C});a.d(t,'optimisticThreshold',function(){return P});a.d(t,'bitrateForMetadata',function(){return O});a.d(t,'averageOrMaxBitrate',function(){return I});a.d(t,'earlyOrMaxBitrate',function(){return F});a.d(t,'bitrateForLevel',function(){return w});a.d(t,'weightedBwUpEstimate',function(){return N});a.d(t,'canSupportAsset',function(){return B});a.d(t,'levelToAsset',function(){return M});a.d(t,'assetToLevel',function(){return G});a.d(t,'determineBitrate',function(){return U});a.d(t,'shouldTransformPathToIncludeByteRange',function(){return W});a.d(t,'arrayBufferToString',function(){return V});a.d(t,'transformPlaylist',function(){return H});a.d(t,'hasAnyVeryLargeAssets',function(){return K});a.d(t,'isVeryLargeAsset',function(){return j});a.d(t,'safeAverageBitrate',function(){return q});a.d(t,'startLoadOnce',function(){return z});a.d(t,'stopLoad',function(){return Y});a.d(t,'teardown',function(){return Q});var r=a(201),l=a(2),n=l['default'].lib('player/lib/assets'),i=l['default'].lib('utilities/obj'),o=l['default'].lib('utilities/url'),s=o.proto,d=l['default'].lib('player/lib/hosts'),u=d.cdnFastWistiaNetHost,g=l['default'].lib('utilities/localstorage'),f=g.setOrGet,c=l['default'].lib('utilities/core'),p=c.base64Encode,m=l['default'].lib('utilities/cacheable'),y=m.makeCacheable,v=m.uncacheNamespace,h=m.makeNamespace,b=y('hls_utils'),_=h('level_to_asset'),E=h('asset_to_level'),L=99999999999,k=function(e,t){return t=r.webPlayable(e,t),n.isScreencast(e.allAssets)&&(t=r.filterAssetsForScreencast(e,t)),0<e.attributes.qualityMin&&(t=r.rejectAudioAsset(e,t)),t=D(e,t),t},A=function(e,t){t=r.allHlsAssets(t),t=k(e,t);var a=R(e,t)||r.bestAssetForCurrentSize(e,t,{maxWidth:1280})||r.mediumQualityStartingAsset(e,t)||r.anyViableAsset(e,t);return t=S(e,t).concat(T(e,t)),n.moveToFront(t,a),t},R=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:e.attributes.bwEstimateOnInit;if(a){var l=e.attributes,i=r.filterByQualityAndMaxWidth(e,t);return n.one(i,{metadata:function(t){if(!t)return!1;var r=O(e,t);return r<L&&r<a*e.abrBandWidthUpFactor()},sortFn:function(e,t){return t.metadata.max_bitrate-e.metadata.max_bitrate}})}return null},S=function(e,t){var a=i.filter(t,function(e){return e.metadata.max_bitrate<L});return a.sort(function(e,t){return e.width-t.width}),a},T=function(e,t){var a=i.filter(t,function(e){return e.metadata.max_bitrate>=L});return a.sort(function(e,t){return e.width-t.width}),a},D=function(e,t){for(var a=e.attributes,r=a.qualityMin,l=a.qualityMax,o=0,s=0;s<t.length;s++){var i=t[s],d=n.numericSizeSnapped(i.width,i.height);r<=d&&d<=l||(o+=1)}if(o<t.length){for(var u=0;u<t.length;u++){var g=t[u],f=n.numericSizeSnapped(g.width,g.height);r<=f&&f<=l||x(g,u),'Audio'===g.display_name&&0<r&&x(g,u)}return t}for(var c,p=n.nearestOutsideRange(t,r,l).map(function(e){return e.url}),m=0;m<t.length;m++)c=t[m],-1===p.indexOf(c.url)&&x(c,m),'Audio'===c.display_name&&0<r&&x(c,m);return t},x=function(e,t){var a;(a=e&&e.metadata)&&(!a.real_early_max_bitrate&&(a.real_early_max_bitrate=a.early_max_bitrate),!a.real_average_bitrate&&(a.real_average_bitrate=a.average_bitrate),!a.real_max_bitrate&&(a.real_max_bitrate=a.max_bitrate),a.early_max_bitrate=a.average_bitrate=a.max_bitrate=L+t)},C=function(){return 6},P=function(){return 16},O=function(e,t){if(!(t&&t.max_bitrate))return L;var a=8*t.max_bitrate,r=8*I(t),l=8*F(t),i=e.getPreload(),n=e.getCurrentTime(),o=e.timeBeforeEndOfBuffer(),s=e.videoElem()&&e.videoElem().paused;if(n<=C(e)&&l<r)return r;if(n<=C(e)&&'none'!==i)return'auto'===i?r:0.5*r+0.5*a;if(o<=C(e))return a;if(!isPaused&&o<=P(e)){var d=P(e)-C(e),u=o-C(e),g=u/d;return g*r+(1-g)*a}return r},I=function(e){return null==e.average_bitrate?e.max_bitrate:e.average_bitrate},F=function(e){return null==e.early_max_bitrate?e.max_bitrate:e.early_max_bitrate},w=function(e,t){var a;return(a=M(e,t))?O(e,a.metadata):L},N=function(e){return e.hls.abrController.getEstimate()*e.abrBandWidthUpFactor()},B=function(e,t){return t&&t.metadata&&N(e)>8*t.metadata.max_bitrate},M=function(e,t){var a;if(null!=(a=_(e)[t]))return a;var r=i.get(e.hls.levels,[t,'url',0]),l=n.one(e.allAssets,{url:r});return l&&(l.bitrate=U(l,t)),_(e)[t]=l,l},G=function(e,t){var a;if(null!=(a=E(e)[t.url]))return a;if(!e.hls||!e.hls.levels)return-1;var r=i.filter(e.hls.levels,function(e){return e.url[0]===t.url})[0],l=e.hls.levels.indexOf(r);return r&&(E(e)[r.url[0]]=l),l},U=function(e,t,a){if(e.hls){var r=null,l=i.get(e.hls.levels,[a,'details','fragments']);if(l){var n=l[l.length-1].byteRangeEndOffset;r=8*n/e.getDuration()/1024}return r}},W=function(){return!!/whlsmultifile=true/.test(location.href)},V=function(e){for(var t=new Uint8Array(e),a=t.length,r='',l=65535,n=0;n<a;n+=l)n+l>a&&(l=a-n),r+=String.fromCharCode.apply(null,t.subarray(n,n+l));return r},H=function(e,t){if(W(e)){var a=/#EXT-X-BYTERANGE:(\d+)@(\d+)\s+([a-zA-Z0-9]+)\.ts/g,r=function(e,t,a,r){var l=parseInt(a)+parseInt(t);return r+'-'+a+'-'+l+'.ts'};return t.replace(a,r)}return t},K=function(e){for(var t=e.allAssets,a=0;a<t.length;a++)if(j(e,t[a]))return!0;return!1},j=function(e,t){var a=q(t);if(a&&a<L){var r=a*e.getDuration();if(r>1.5*1073741824)return!0}return!1},q=function(e){return e&&e.metadata?e.metadata.real_average_bitrate||e.metadata.average_bitrate:null},z=function(e){e.attributes.calledStartLoad||(e.onReady().then(function(){e.hls.startLoad()}),e.setAttributes({calledStartLoad:!0}))},Y=function(e){e.hls.stopLoad(),e.setAttributes({calledStartLoad:!1})},Q=function(e){v('level_to_asset',e),v('asset_to_level',e)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setup',function(){return h});a.d(t,'capToLevel',function(){return b});a.d(t,'cappedLevelFromWidth',function(){return _});a.d(t,'cappedLevelFromVideoWidth',function(){return E});a.d(t,'capLevelBasedOnExactWidth',function(){return L});a.d(t,'capLevelBasedOnVideoWidth',function(){return k});a.d(t,'teardown',function(){return A});var r=a(2),l=a(204),i=a.n(l),n=a(201),o=a(202),s=r['default'].lib('player/lib/assets'),d=r['default'].lib('utilities/wlog'),u=d.wlog,g=u.getPrefixedFunctions('hls_video level_capping'),f=r['default'].lib('utilities/cacheable'),c=f.makeCacheable,p=f.uncacheNamespace,m=f.makeNamespace,y=c('level_capping'),v=m('level_capping'),h=function(e){var t=y(e,'onManifestParsed',function(){return function(){k(e)}});e.hls.off(i.a.Events.MANIFEST_PARSED,t),e.hls.on(i.a.Events.MANIFEST_PARSED,t)},b=function(e,t){e.onReady().then(function(){e.hls.autoLevelCapping=t})},_=function(e,t){var a=e.m3u8OrderedAssets(),r=n.filterByQualityAndMaxWidth(e,a,{maxWidth:t}),l=s.one(r,{width:[0,t],sortBy:'width desc, bitrate desc',metadata:function(e){return e.max_bitrate<o.UNOBTAINABLE_BITRATE}});return l?Object(o.assetToLevel)(e,l):-1},E=function(e){return _(e,n.maxAssetWidthBasedOnVideoWidth(e.attributes.width,e.attributes.devicePixelRatio))},L=function(e,t){var a=_(e,t);0<=a?(g.info('Capping to level',a),b(e.hls,a)):g.info('Cannot cap level for width '+t+'; no matching assets found')},k=function(e){if(!1!==e.attributes.capBasedOnVideoWidth){var t=e.hls,a=E(e);if(g.info('capLevelBasedOnVideoWidth',a),0<=a){var r=t.currentLevel,l=t.autoLevelCapping;b(e,a);var i=e.getPlaybackMode(),n=e.m3u8OrderedAssets();if(0===n.length)return;if('beforeplay'===i&&a===Object(o.assetToLevel)(e,n[0]))g.info('Not reevaluating next fragment because starting level is the same as the capped level');else{var s=t.levels.length-1,d=Object(o.levelToAsset)(e,Math.min(r+1,s));0<=l&&a>l&&Object(o.canSupportAsset)(e,d)&&(t.nextLevel=-1)}}}},A=function(e){v(e).onManifestParsed&&e.hls&&e.hls.off(i.a.Events.MANIFEST_PARSED,v(e).onManifestParsed),p('level_capping',e)};window.__NEWLINE__=1},function(e,t,a){e.exports=a(205).default;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(206),i=a.n(l),n=a(207),o=a(208),s=a(213),d=a(214),u=a(215),g=a(216),f=a(240),c=a(211),p=a(236),m=a.n(p),y=a(241);var v=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var h=function(){function e(){var t=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var l=e.DefaultConfig;if((a.liveSyncDurationCount||a.liveMaxLatencyDurationCount)&&(a.liveSyncDuration||a.liveMaxLatencyDuration))throw new Error('Illegal hls.js config: don\'t mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration');for(var i in l)i in a||(a[i]=l[i]);if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==a.liveMaxLatencyDuration&&(a.liveMaxLatencyDuration<=a.liveSyncDuration||void 0===a.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(c.enableLogs)(a.debug),this.config=a;var n=this.observer=new m.a;n.trigger=function(e){for(var t=arguments.length,a=Array(1<t?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];n.emit.apply(n,[e,e].concat(a))},n.off=function(e){for(var t=arguments.length,a=Array(1<t?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];n.removeListener.apply(n,[e].concat(a))},this.on=n.on.bind(n),this.off=n.off.bind(n),this.trigger=n.trigger.bind(n);var d=this.levelController=new f['default'](this),p=this.streamController=new g['default'](this),y=[d,p],v=a.audioStreamController;v&&y.push(new v(this)),this.networkControllers=y;var h=this.abrController=new a.abrController(this),b=new a.bufferController(this),_=new a.capLevelController(this),E=new a.fpsController(this),L=new o['default'](this),k=new s['default'](this),A=new u['default'](this),R=[L,k,A,h,b,_,E];if(v=a.audioTrackController,v){var S=new v(this);this.audioTrackController=S,R.push(S)}if(v=a.subtitleTrackController,v){var T=new v(this);this.subtitleTrackController=T,R.push(T)}[a.subtitleStreamController,a.timelineController].forEach(function(e){e&&R.push(new e(t))}),this.coreComponents=R}return v(e,null,[{key:'isSupported',value:function(){return window.MediaSource=window.MediaSource||window.WebKitMediaSource,window.MediaSource&&'function'==typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:'version',get:function(){return'wistia/0.7.0-light-only/d90783'}},{key:'Events',get:function(){return i.a}},{key:'ErrorTypes',get:function(){return n.ErrorTypes}},{key:'ErrorDetails',get:function(){return n.ErrorDetails}},{key:'DefaultConfig',get:function(){return e.defaultConfig?e.defaultConfig:y.hlsDefaultConfig},set:function(t){e.defaultConfig=t}}]),v(e,[{key:'destroy',value:function(){c.logger.log('destroy'),this.trigger(i.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.observer.removeAllListeners()}},{key:'attachMedia',value:function(e){c.logger.log('attachMedia'),this.media=e,this.trigger(i.a.MEDIA_ATTACHING,{media:e})}},{key:'detachMedia',value:function(){c.logger.log('detachMedia'),this.trigger(i.a.MEDIA_DETACHING),this.media=null}},{key:'loadSource',value:function(e){c.logger.log('loadSource:'+e),this.url=e,this.trigger(i.a.MANIFEST_LOADING,{url:e})}},{key:'startLoad',value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;c.logger.log('startLoad('+e+')'),this.networkControllers.forEach(function(t){t.startLoad(e)})}},{key:'stopLoad',value:function(){c.logger.log('stopLoad'),this.networkControllers.forEach(function(e){e.stopLoad()})}},{key:'swapAudioCodec',value:function(){c.logger.log('swapAudioCodec'),this.streamController.swapAudioCodec()}},{key:'recoverMediaError',value:function(){c.logger.log('recoverMediaError');var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:'levels',get:function(){return this.levelController.levels}},{key:'currentLevel',get:function(){return this.streamController.currentLevel},set:function(e){c.logger.log('set currentLevel:'+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:'nextLevel',get:function(){return this.streamController.nextLevel},set:function(e){c.logger.log('set nextLevel:'+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:'loadLevel',get:function(){return this.levelController.level},set:function(e){c.logger.log('set loadLevel:'+e),this.levelController.manualLevel=e}},{key:'nextLoadLevel',get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:'firstLevel',get:function(){return Math.max(this.levelController.firstLevel,this.abrController.minAutoLevel)},set:function(e){c.logger.log('set firstLevel:'+e),this.levelController.firstLevel=e}},{key:'startLevel',get:function(){return this.levelController.startLevel},set:function(e){c.logger.log('set startLevel:'+e),this.levelController.startLevel=e}},{key:'autoLevelCapping',get:function(){return this.abrController.autoLevelCapping},set:function(e){c.logger.log('set autoLevelCapping:'+e),this.abrController.autoLevelCapping=e}},{key:'autoLevelEnabled',get:function(){return-1===this.levelController.manualLevel}},{key:'manualLevel',get:function(){return this.levelController.manualLevel}},{key:'audioTracks',get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:'audioTrack',get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:'liveSyncPosition',get:function(){return this.streamController.liveSyncPosition}},{key:'subtitleTracks',get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:'subtitleTrack',get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}}]),e}();h.PlaylistLoader=o['default'],h.FragmentLoader=s['default'],h.XhrLoader=d['default'];t['default']=h;window.__NEWLINE__=1},function(e){e.exports={MEDIA_ATTACHING:'hlsMediaAttaching',MEDIA_ATTACHED:'hlsMediaAttached',MEDIA_DETACHING:'hlsMediaDetaching',MEDIA_DETACHED:'hlsMediaDetached',BUFFER_RESET:'hlsBufferReset',BUFFER_CODECS:'hlsBufferCodecs',BUFFER_CREATED:'hlsBufferCreated',BUFFER_APPENDING:'hlsBufferAppending',BUFFER_APPENDED:'hlsBufferAppended',BUFFER_EOS:'hlsBufferEos',BUFFER_FLUSHING:'hlsBufferFlushing',BUFFER_FLUSHED:'hlsBufferFlushed',MANIFEST_LOADING:'hlsManifestLoading',MANIFEST_LOADED:'hlsManifestLoaded',MANIFEST_PARSED:'hlsManifestParsed',LEVEL_LOADING:'hlsLevelLoading',LEVEL_LOADED:'hlsLevelLoaded',LEVEL_UPDATED:'hlsLevelUpdated',LEVEL_PTS_UPDATED:'hlsLevelPtsUpdated',LEVEL_SWITCH:'hlsLevelSwitch',AUDIO_TRACKS_UPDATED:'hlsAudioTracksUpdated',AUDIO_TRACK_SWITCH:'hlsAudioTrackSwitch',AUDIO_TRACK_SWITCHING:'hlsAudioTrackSwitching',AUDIO_TRACK_SWITCHED:'hlsAudioTrackSwitched',AUDIO_TRACK_LOADING:'hlsAudioTrackLoading',AUDIO_TRACK_LOADED:'hlsAudioTrackLoaded',SUBTITLE_TRACKS_UPDATED:'hlsSubtitleTracksUpdated',SUBTITLE_TRACK_SWITCH:'hlsSubtitleTrackSwitch',SUBTITLE_TRACK_LOADING:'hlsSubtitleTrackLoading',SUBTITLE_TRACK_LOADED:'hlsSubtitleTrackLoaded',SUBTITLE_FRAG_PROCESSED:'hlsSubtitleFragProcessed',INIT_PTS_FOUND:'hlsInitPtsFound',FRAG_LOADING:'hlsFragLoading',FRAG_LOAD_PROGRESS:'hlsFragLoadProgress',FRAG_LOAD_EMERGENCY_ABORTED:'hlsFragLoadEmergencyAborted',FRAG_LOADED:'hlsFragLoaded',FRAG_DECRYPTED:'hlsFragDecrypted',FRAG_PARSING_INIT_SEGMENT:'hlsFragParsingInitSegment',FRAG_PARSING_USERDATA:'hlsFragParsingUserdata',FRAG_PARSING_METADATA:'hlsFragParsingMetadata',FRAG_PARSING_DATA:'hlsFragParsingData',FRAG_PARSED:'hlsFragParsed',FRAG_BUFFERED:'hlsFragBuffered',FRAG_CHANGED:'hlsFragChanged',FPS_DROP:'hlsFpsDrop',FPS_DROP_LEVEL_CAPPING:'hlsFpsDropLevelCapping',ERROR:'hlsError',DESTROYING:'hlsDestroying',KEY_LOADING:'hlsKeyLoading',KEY_LOADED:'hlsKeyLoaded',STREAM_STATE_TRANSITION:'hlsStreamStateTransition'};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'ErrorTypes',function(){return r});a.d(t,'ErrorDetails',function(){return l});var r={NETWORK_ERROR:'networkError',MEDIA_ERROR:'mediaError',MUX_ERROR:'muxError',OTHER_ERROR:'otherError'},l={MANIFEST_LOAD_ERROR:'manifestLoadError',MANIFEST_LOAD_TIMEOUT:'manifestLoadTimeOut',MANIFEST_PARSING_ERROR:'manifestParsingError',MANIFEST_INCOMPATIBLE_CODECS_ERROR:'manifestIncompatibleCodecsError',LEVEL_LOAD_ERROR:'levelLoadError',LEVEL_LOAD_TIMEOUT:'levelLoadTimeOut',LEVEL_SWITCH_ERROR:'levelSwitchError',AUDIO_TRACK_LOAD_ERROR:'audioTrackLoadError',AUDIO_TRACK_LOAD_TIMEOUT:'audioTrackLoadTimeOut',FRAG_LOAD_ERROR:'fragLoadError',FRAG_LOOP_LOADING_ERROR:'fragLoopLoadingError',FRAG_LOAD_TIMEOUT:'fragLoadTimeOut',FRAG_DECRYPT_ERROR:'fragDecryptError',FRAG_PARSING_ERROR:'fragParsingError',REMUX_ALLOC_ERROR:'remuxAllocError',KEY_LOAD_ERROR:'keyLoadError',KEY_LOAD_TIMEOUT:'keyLoadTimeOut',BUFFER_ADD_CODEC_ERROR:'bufferAddCodecError',BUFFER_APPEND_ERROR:'bufferAppendError',BUFFER_APPENDING_ERROR:'bufferAppendingError',BUFFER_STALLED_ERROR:'bufferStalledError',BUFFER_FULL_ERROR:'bufferFullError',BUFFER_SEEK_OVER_HOLE:'bufferSeekOverHole',BUFFER_NUDGE_ON_STALL:'bufferNudgeOnStall',INTERNAL_EXCEPTION:'internalException',WEBVTT_EXCEPTION:'webVTTException'};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(209),o=a.n(n),s=a(206),d=a.n(s),u=a(210),g=a(207),f=a(212),c=a(211),p=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function l(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var m=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,y=/#EXT-X-MEDIA:(.*)/g,v=/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*))?|(?!#)(\S.+)|#EXT-X-BYTERANGE: *(.+)|#EXT-X-PROGRAM-DATE-TIME:(.+)|#.*/g,h=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,b=function(){function e(){i(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return p(e,[{key:'uri',get:function(){return!this._uri&&this.reluri&&(this._uri=o.a.buildAbsoluteURL(this.baseuri,this.reluri)),this._uri}}]),e}(),_=function(){function e(){i(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return p(e,[{key:'createInitializationVector',value:function(e){for(var t=new Uint8Array(16),a=12;16>a;a++)t[a]=255&e>>8*(15-a);return t}},{key:'fragmentDecryptdataFromLevelkey',value:function(e,t){var a=e;return e&&e.method&&e.uri&&!e.iv&&(a=new b,a.method=e.method,a.baseuri=e.baseuri,a.reluri=e.reluri,a.iv=this.createInitializationVector(t)),a}},{key:'cloneObj',value:function(e){return JSON.parse(JSON.stringify(e))}},{key:'url',get:function(){return!this._url&&this.relurl&&(this._url=o.a.buildAbsoluteURL(this.baseurl,this.relurl)),this._url},set:function(e){this._url=e}},{key:'programDateTime',get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:'byteRange',get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split('@',2);if(1===t.length){var a=this.lastByteRangeEndOffset;e[0]=a?a:0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:'byteRangeStartOffset',get:function(){return this.byteRange[0]}},{key:'byteRangeEndOffset',get:function(){return this.byteRange[1]}},{key:'decryptdata',get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),E=function(e){function t(e){i(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.a.MANIFEST_LOADING,d.a.LEVEL_LOADING,d.a.AUDIO_TRACK_LOADING,d.a.SUBTITLE_TRACK_LOADING));return a.loaders={},a}return l(t,e),p(t,[{key:'destroy',value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},u['default'].prototype.destroy.call(this)}},{key:'onManifestLoading',value:function(e){this.load(e.url,{type:'manifest'})}},{key:'onLevelLoading',value:function(e){this.load(e.url,{type:'level',level:e.level,id:e.id})}},{key:'onAudioTrackLoading',value:function(e){this.load(e.url,{type:'audioTrack',id:e.id})}},{key:'onSubtitleTrackLoading',value:function(e){this.load(e.url,{type:'subtitleTrack',id:e.id})}},{key:'load',value:function(e,t){var a=this.loaders[t.type];if(a){var r=a.context;if(r&&r.url===e)return void c.logger.trace('playlist request ongoing');c.logger.warn('abort previous loader for type:'+t.type),a.abort()}var l,i,n,o,s=this.hls.config;'manifest'===t.type?(l=s.manifestLoadingMaxRetry,i=s.manifestLoadingTimeOut,n=s.manifestLoadingRetryDelay,o=s.manifestLoadingMaxRetryTimeout):(l=s.levelLoadingMaxRetry,i=s.levelLoadingTimeOut,n=s.levelLoadingRetryDelay,o=s.levelLoadingMaxRetryTimeout,c.logger.log('loading playlist for '+t.type+' '+(t.level||t.id))),a=this.loaders[t.type]=t.loader='undefined'==typeof s.pLoader?new s.loader(s):new s.pLoader(s),t.url=e,t.responseType='';var d,u;d={timeout:i,maxRetry:l,retryDelay:n,maxRetryDelay:o},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},a.load(t,d,u)}},{key:'resolve',value:function(e,t){return o.a.buildAbsoluteURL(t,e)}},{key:'parseMasterPlaylist',value:function(e,t){var a,r=[];for(m.lastIndex=0;null!=(a=m.exec(e));){var l={},n=l.attrs=new f['default'](a[1]);l.url=this.resolve(a[2],t);var o=n.decimalResolution('RESOLUTION');o&&(l.width=o.width,l.height=o.height),l.bitrate=n.decimalInteger('AVERAGE-BANDWIDTH')||n.decimalInteger('BANDWIDTH'),l.name=n.NAME;var s=n.CODECS;if(s){s=s.split(/[ ,]+/);for(var d,u=0;u<s.length;u++)d=s[u],-1===d.indexOf('avc1')?l.audioCodec=d:l.videoCodec=this.avc1toavcoti(d)}r.push(l)}return r}},{key:'parseMasterPlaylistMedia',value:function(e,t,a){var r,l=[],i=0;for(y.lastIndex=0;null!=(r=y.exec(e));){var n={},o=new f['default'](r[1]);o.TYPE===a&&(n.groupId=o['GROUP-ID'],n.name=o.NAME,n.type=a,n.default='YES'===o.DEFAULT,n.autoselect='YES'===o.AUTOSELECT,n.forced='YES'===o.FORCED,o.URI&&(n.url=this.resolve(o.URI,t)),n.lang=o.LANGUAGE,!n.name&&(n.name=n.lang),n.id=i++,l.push(n))}return l}},{key:'avc1toavcoti',value:function(e){var t,a=e.split('.');return 2<a.length?(t=a.shift()+'.',t+=parseInt(a.shift()).toString(16),t+=('000'+parseInt(a.shift()).toString(16)).substr(-4)):t=e,t}},{key:'parseLevelPlaylist',value:function(e,t,a,r){var l,n,i=0,o=0,s={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},d=new b,u=0,g=null,p=new _;for(v.lastIndex=0;null!==(l=v.exec(e));){var m=l[1];if(m){p.duration=parseFloat(m);var y=(' '+l[2]).slice(1);p.title=y?y:null,p.tagList.push(y?['INF',m,y]:['INF',m])}else if(l[3]){if(!isNaN(p.duration)){var E=i++;p.type=r,p.start=o,p.levelkey=d,p.sn=E,p.level=a,p.cc=u,p.baseurl=t,p.relurl=(' '+l[3]).slice(1),s.fragments.push(p),g=p,o+=p.duration,p=new _}}else if(l[4]){if(p.rawByteRange=(' '+l[4]).slice(1),g){var L=g.byteRangeEndOffset;L&&(p.lastByteRangeEndOffset=L)}}else if(l[5])p.rawProgramDateTime=(' '+l[5]).slice(1),p.tagList.push(['PROGRAM-DATE-TIME',p.rawProgramDateTime]);else{for(l=l[0].match(h),n=1;n<l.length&&void 0===l[n];n++);var k=(' '+l[n+1]).slice(1),A=(' '+l[n+2]).slice(1);switch(l[n]){case'#':p.tagList.push(A?[k,A]:[k]);break;case'PLAYLIST-TYPE':s.type=k.toUpperCase();break;case'MEDIA-SEQUENCE':i=s.startSN=parseInt(k);break;case'TARGETDURATION':s.targetduration=parseFloat(k);break;case'VERSION':s.version=parseInt(k);break;case'EXTM3U':break;case'ENDLIST':s.live=!1;break;case'DIS':u++,p.tagList.push(['DIS']);break;case'DISCONTINUITY-SEQ':u=parseInt(k);break;case'KEY':var R=new f['default'](k),S=R.enumeratedString('METHOD'),T=R.URI,D=R.hexadecimalInteger('IV');S&&(d=new b,T&&'AES-128'===S&&(d.method=S,d.baseuri=t,d.reluri=T,d.key=null,d.iv=D));break;case'START':var x=new f['default'](k),C=x.decimalFloatingPoint('TIME-OFFSET');isNaN(C)||(s.startTimeOffset=C);break;case'MAP':var P=new f['default'](k);p.relurl=P.URI,p.rawByteRange=P.BYTERANGE,p.baseurl=t,p.level=a,p.type=r,p.sn='initSegment',s.initSegment=p,p=new _;break;default:c.logger.warn('line parsed but not handled: '+l);}}}return p=g,p&&!p.relurl&&(s.fragments.pop(),o-=p.duration),s.totalduration=o,s.averagetargetduration=o/s.fragments.length,s.endSN=i-1,s}},{key:'loadsuccess',value:function(e,t,a){var r=e.data,l=e.url,i=a.type,n=a.id,o=a.level,s=this.hls;if(this.loaders[i]=void 0,(void 0===l||0===l.indexOf('data:'))&&(l=a.url),t.tload=performance.now(),0!==r.indexOf('#EXTM3U'))s.trigger(d.a.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:l,reason:'no EXTM3U delimiter'});else if(0<r.indexOf('#EXTINF:')){var u=this.parseLevelPlaylist(r,l,o||n||0,'audioTrack'===i?'audio':'subtitleTrack'===i?'subtitle':'main');u.tload=t.tload,'manifest'===i&&s.trigger(d.a.MANIFEST_LOADED,{levels:[{url:l,details:u}],audioTracks:[],url:l,stats:t}),t.tparsed=performance.now(),u.targetduration?'audioTrack'!==i&&'subtitleTrack'!==i?s.trigger(d.a.LEVEL_LOADED,{details:u,level:o||0,id:n||0,stats:t}):'audioTrack'===i?s.trigger(d.a.AUDIO_TRACK_LOADED,{details:u,id:n,stats:t}):'subtitleTrack'===i&&s.trigger(d.a.SUBTITLE_TRACK_LOADED,{details:u,id:n,stats:t}):s.trigger(d.a.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:l,reason:'invalid targetduration'})}else{var f=this.parseMasterPlaylist(r,l);if(f.length){var p=this.parseMasterPlaylistMedia(r,l,'AUDIO'),m=this.parseMasterPlaylistMedia(r,l,'SUBTITLES');if(p.length){var y=!1;p.forEach(function(e){e.url||(y=!0)}),!1==y&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(c.logger.log('audio codec signaled in quality level, but no embedded audio track signaled, create one'),p.unshift({type:'main',name:'main'}))}s.trigger(d.a.MANIFEST_LOADED,{levels:f,audioTracks:p,subtitles:m,url:l,stats:t})}else s.trigger(d.a.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:l,reason:'no level found in manifest'})}}},{key:'loaderror',value:function(e,t){var a,r,l=t.loader;switch(t.type){case'manifest':a=g.ErrorDetails.MANIFEST_LOAD_ERROR,r=!0;break;case'level':a=g.ErrorDetails.LEVEL_LOAD_ERROR,r=!1;break;case'audioTrack':a=g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,r=!1;}l&&(l.abort(),this.loaders[t.type]=void 0),this.hls.trigger(d.a.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:a,fatal:r,url:l.url,loader:l,response:e,context:t})}},{key:'loadtimeout',value:function(e,t){var a,r,l=t.loader;switch(t.type){case'manifest':a=g.ErrorDetails.MANIFEST_LOAD_TIMEOUT,r=!0;break;case'level':a=g.ErrorDetails.LEVEL_LOAD_TIMEOUT,r=!1;break;case'audioTrack':a=g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,r=!1;}l&&(l.abort(),this.loaders[t.type]=void 0),this.hls.trigger(d.a.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:a,fatal:r,url:l.url,loader:l,context:t})}}]),t}(u['default']);t['default']=E;window.__NEWLINE__=1},function(e){(function(){var t=/^([^#]*)(.*)$/,a=/^([^\?]*)(.*)$/,r=/^(((?:[a-z]+:)?\/\/)?[^:\/]+(?::[0-9]+)?)?(\/?.*)$/i,l={buildAbsoluteURL:function(e,i){if(i=i.trim(),/^[a-z]+:/i.test(i))return i;var n=null,o=null,s=t.exec(i);s&&(o=s[2],i=s[1]);var d=a.exec(i);d&&(n=d[2],i=d[1]);var u=t.exec(e);u&&(e=u[1]);var g=a.exec(e);g&&(e=g[1]);var f=r.exec(e);if(!f)throw new Error('Error trying to parse base URL.');var c=f[2]||'//',p=f[1]||'',m=f[3];0!==m.indexOf('/')&&''!==p&&(m='/'+m);var y=null;return y=/^\/\//.test(i)?c+l.buildAbsolutePath('',i.substring(2)):/^\//.test(i)?p+'/'+l.buildAbsolutePath('',i.substring(1)):l.buildAbsolutePath(p+m,i),n&&(y+=n),o&&(y+=o),y},buildAbsolutePath:function(e,t){for(var a,r,l='',i=e.replace(/[^\/]*$/,t.replace(/(\/|^)(?:\.?\/+)+/g,'$1')),n=0;r=i.indexOf('/../',n),-1<r;n=r+a)a=/^\/(?:\.\.\/)*/.exec(i.slice(r))[0].length,l=(l+i.substring(n,r)).replace(new RegExp('(?:\\/+[^\\/]*){0,'+(a-1)/3+'}$'),'/');return l+i.substr(n)}};e.exports=l})(this);window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(211),i=a(207),n=a(206),o=a.n(n),s='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},d=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var u=function(){function e(t){r(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var a=arguments.length,l=Array(1<a?a-1:0),i=1;i<a;i++)l[i-1]=arguments[i];this.handledEvents=l,this.useGenericHandler=!0,this.registerListeners()}return d(e,[{key:'destroy',value:function(){this.unregisterListeners()}},{key:'isEventHandler',value:function(){return'object'===s(this.handledEvents)&&this.handledEvents.length&&'function'==typeof this.onEvent}},{key:'registerListeners',value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if('hlsEventGeneric'===e)throw new Error('Forbidden event name: '+e);this.hls.on(e,this.onEvent)}.bind(this))}},{key:'unregisterListeners',value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)}.bind(this))}},{key:'onEvent',value:function(e,t){this.onEventGeneric(e,t)}},{key:'onEventGeneric',value:function(e,t){var a=function(e,t){var a='on'+e.replace('hls','');if('function'!=typeof this[a])throw new Error('Event '+e+' has no generic handler in this '+this.constructor.name+' class (tried '+a+')');return this[a].bind(this,t)};try{a.call(this,e,t).call()}catch(t){l.logger.error('internal error happened while processing '+e+':'+t.message),this.hls.trigger(o.a.ERROR,{type:i.ErrorTypes.OTHER_ERROR,details:i.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();t['default']=u;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'enableLogs',function(){return u});a.d(t,'logger',function(){return g});var o='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e};function r(){}var s={trace:r,debug:r,log:r,warn:r,info:r,error:r},d=s;function l(e,t){return t='['+e+'] > '+t,t}function i(e){var t=self.console[e];return t?function(){for(var a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];r[0]&&(r[0]=l(e,r[0])),t.apply(self.console,r)}:r}function n(e){for(var t=arguments.length,a=Array(1<t?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];a.forEach(function(t){d[t]=e[t]?e[t].bind(e):i(t)})}var u=function(e){if(!0===e||'object'===('undefined'==typeof e?'undefined':o(e))){n(e,'debug','log','info','warn','error');try{d.log()}catch(t){d=s}}else d=s},g=d;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=/^(\d+)x(\d+)$/,n=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function e(t){for(var a in r(this,e),'string'==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(a)&&(this[a]=t[a])}var t=Number.MAX_SAFE_INTEGER;return l(e,[{key:'decimalInteger',value:function(e){var a=parseInt(this[e],10);return a>t?Infinity:a}},{key:'hexadecimalInteger',value:function(e){if(this[e]){var t=(this[e]||'0x').slice(2);t=(1&t.length?'0':'')+t;for(var a=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)a[r]=parseInt(t.slice(2*r,2*r+2),16);return a}return null}},{key:'hexadecimalIntegerAsNumber',value:function(e){var a=parseInt(this[e],16);return a>t?Infinity:a}},{key:'decimalFloatingPoint',value:function(e){return parseFloat(this[e])}},{key:'enumeratedString',value:function(e){return this[e]}},{key:'decimalResolution',value:function(e){var t=i.exec(this[e]);return null===t?void 0:{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:'parseAttrList',value:function(e){var t,a={};for(n.lastIndex=0;null!==(t=n.exec(e));){var r=t[2],l='"';0===r.indexOf(l)&&r.lastIndexOf(l)===r.length-1&&(r=r.slice(1,-1)),a[t[1]]=r}return a}}]),e}();t['default']=o;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(206),o=a.n(n),s=a(210),d=a(207),u=a(211),g=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o.a.FRAG_LOADING));return a.loaders={},a}return i(t,e),g(t,[{key:'destroy',value:function(){var e=this.loaders;for(var t in e){var a=e[t];a&&a.destroy()}this.loaders={},s['default'].prototype.destroy.call(this)}},{key:'onFragLoading',value:function(e){var t=e.frag,a=t.type,r=this.loaders[a],l=this.hls.config;t.loaded=0,r&&(u.logger.warn('abort previous fragment loader for type:'+a),r.abort()),r=this.loaders[a]=t.loader='undefined'==typeof l.fLoader?new l.loader(l):new l.fLoader(l);var i,n,o;i={url:t.url,frag:t,responseType:'arraybuffer',progressData:!1};var s=t.byteRangeStartOffset,d=t.byteRangeEndOffset;isNaN(s)||isNaN(d)||(i.rangeStart=s,i.rangeEnd=d),n={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:l.fragLoadingMaxRetryTimeout},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},r.load(i,n,o)}},{key:'loadsuccess',value:function(e,t,a){var r=e.data,l=a.frag;l.loader=void 0,this.loaders[l.type]=void 0,this.hls.trigger(o.a.FRAG_LOADED,{payload:r,frag:l,stats:t})}},{key:'loaderror',value:function(e,t){var a=t.loader;a&&a.abort(),this.loaders[t.type]=void 0,this.hls.trigger(o.a.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e})}},{key:'loadtimeout',value:function(e,t){var a=t.loader;a&&a.abort(),this.loaders[t.type]=void 0,this.hls.trigger(o.a.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag})}},{key:'loadprogress',value:function(e,t){var a=t.frag;a.loaded=e.loaded,this.hls.trigger(o.a.FRAG_LOAD_PROGRESS,{frag:a,stats:e})}}]),t}(s['default']);t['default']=f;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(211),i=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=function(){function e(t){r(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return i(e,[{key:'destroy',value:function(){this.abort(),this.loader=null}},{key:'abort',value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:'load',value:function(e,t,a){this.context=e,this.config=t,this.callbacks=a,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:'loadInternal',value:function(){var e,t=this.context;e='undefined'==typeof XDomainRequest?this.loader=new XMLHttpRequest:this.loader=new XDomainRequest,e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.open('GET',t.url,!0),t.rangeEnd&&e.setRequestHeader('Range','bytes='+t.rangeStart+'-'+(t.rangeEnd-1)),e.responseType=t.responseType;var a=this.stats;a.tfirst=0,a.loaded=0,this.xhrSetup&&this.xhrSetup(e,t.url),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:'readystatechange',value:function(e){var t=Math.max,a=e.currentTarget,r=a.readyState,i=this.stats,n=this.context,o=this.config;if(!i.aborted&&2<=r)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=t(performance.now(),i.trequest)),4===r){var s=a.status;if(200<=s&&300>s){i.tload=t(i.tfirst,performance.now());var d,u;'arraybuffer'===n.responseType?(d=a.response,u=d.byteLength):(d=a.responseText,u=d.length),i.loaded=i.total=u;var g={url:a.responseURL,data:d};this.callbacks.onSuccess(g,i,n)}else i.retry>=o.maxRetry||400<=s&&499>s?(l.logger.error(s+' while loading '+n.url),this.callbacks.onError({code:s,text:a.statusText},n)):(l.logger.warn(s+' while loading '+n.url+', retrying in '+this.retryDelay+'...'),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)}},{key:'loadtimeout',value:function(){l.logger.warn('timeout while loading '+this.context.url),this.callbacks.onTimeout(this.stats,this.context)}},{key:'loadprogress',value:function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);var a=this.callbacks.onProgress;a&&a(t,this.context,null)}}]),e}();t['default']=n;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(206),o=a.n(n),s=a(210),d=a(207),u=a(211),g=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o.a.KEY_LOADING));return a.loaders={},a.decryptkey=null,a.decrypturl=null,a}return i(t,e),g(t,[{key:'destroy',value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},s['default'].prototype.destroy.call(this)}},{key:'onKeyLoading',value:function(e){var t=e.frag,a=t.type,r=this.loaders[a],l=t.decryptdata,i=l.uri;if(i!==this.decrypturl||null===this.decryptkey){var n=this.hls.config;r&&(u.logger.warn('abort previous key loader for type:'+a),r.abort()),t.loader=this.loaders[a]=new n.loader(n),this.decrypturl=i,this.decryptkey=null;var s,d,g;s={url:i,frag:t,responseType:'arraybuffer'},d={timeout:n.fragLoadingTimeOut,maxRetry:n.fragLoadingMaxRetry,retryDelay:n.fragLoadingRetryDelay,maxRetryDelay:n.fragLoadingMaxRetryTimeout},g={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,d,g)}else this.decryptkey&&(l.key=this.decryptkey,this.hls.trigger(o.a.KEY_LOADED,{frag:t}))}},{key:'loadsuccess',value:function(e,t,a){var r=a.frag;this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=void 0,this.loaders[r.type]=void 0,this.hls.trigger(o.a.KEY_LOADED,{frag:r})}},{key:'loaderror',value:function(e,t){var a=t.frag,r=a.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(o.a.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:a,response:e})}},{key:'loadtimeout',value:function(e,t){var a=t.frag,r=a.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(o.a.ERROR,{type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:a})}}]),t}(s['default']);t['default']=f;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(217),o=a.n(n),s=a(218),d=a(219),u=a(206),g=a.n(u),f=a(210),c=a(238),p=a(239),m=a(207),y=a(211),v=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h={STOPPED:'STOPPED',IDLE:'IDLE',KEY_LOADING:'KEY_LOADING',FRAG_LOADING:'FRAG_LOADING',FRAG_LOADING_WAITING_RETRY:'FRAG_LOADING_WAITING_RETRY',WAITING_LEVEL:'WAITING_LEVEL',PARSING:'PARSING',PARSED:'PARSED',BUFFER_FLUSHING:'BUFFER_FLUSHING',ENDED:'ENDED',ERROR:'ERROR'},b=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,g.a.MEDIA_ATTACHED,g.a.MEDIA_DETACHING,g.a.MANIFEST_LOADING,g.a.MANIFEST_PARSED,g.a.LEVEL_LOADED,g.a.KEY_LOADED,g.a.FRAG_LOADED,g.a.FRAG_LOAD_EMERGENCY_ABORTED,g.a.FRAG_PARSING_INIT_SEGMENT,g.a.FRAG_PARSING_DATA,g.a.FRAG_PARSED,g.a.ERROR,g.a.AUDIO_TRACK_SWITCHING,g.a.AUDIO_TRACK_SWITCHED,g.a.BUFFER_CREATED,g.a.BUFFER_APPENDED,g.a.BUFFER_FLUSHED));return a.config=e.config,a.audioCodecSwap=!1,a.ticks=0,a._state=h.STOPPED,a.ontick=a.tick.bind(a),a}var a=Math.round,n=Math.min,u=Math.max;return i(t,e),v(t,[{key:'destroy',value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),f['default'].prototype.destroy.call(this),this.state=h.STOPPED}},{key:'startLoad',value:function(e){if(this.levels){var t=this.lastCurrentTime,a=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=a.startLevel;-1===r&&(r=0,this.bitrateTest=!0),this.level=a.nextLoadLevel=r,this.loadedmetadata=!1}0<t&&-1===e&&(y.logger.log('override startPosition with lastCurrentTime @'+t.toFixed(3)),e=t),this.state=h.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else y.logger.warn('cannot start loading as manifest not parsed yet'),this.state=h.STOPPED}},{key:'stopLoad',value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=h.STOPPED}},{key:'tick',value:function(){this.ticks++,1===this.ticks&&(this.doTick(),1<this.ticks&&setTimeout(this.tick,1),this.ticks=0)}},{key:'doTick',value:function(){switch(this.state){case h.ERROR:break;case h.BUFFER_FLUSHING:this.fragLoadError=0;break;case h.IDLE:if(!this._doTickIdle())return;break;case h.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=h.IDLE);break;case h.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),a=this.retryDate;(!a||t>=a||this.media&&this.media.seeking)&&(y.logger.log('mediaController: retryDate reached, switch back to IDLE state'),this.state=h.IDLE);break;case h.ERROR:case h.STOPPED:case h.FRAG_LOADING:case h.PARSING:case h.PARSED:case h.ENDED:break;default:}this._checkBuffer(),this._checkFragmentChanged()}},{key:'_doTickIdle',value:function(){var e=this.hls,t=e.config,a=this.media;if(void 0!==this.levelLastLoaded&&!a&&(this.startFragRequested||!t.startFragPrefetch))return!0;var r=this.loadedmetadata?a.currentTime:this.nextLoadPosition;var l,i=e.nextLoadLevel,o=this.levels[i],d=o.bitrate;l=d?u(8*t.maxBufferSize/d,t.maxBufferLength):t.maxBufferLength,l=n(l,t.maxMaxBufferLength);var f=s['default'].bufferInfo(this.mediaBuffer?this.mediaBuffer:a,r,t.maxBufferHole),c=f.len;if(c>=l)return!0;y.logger.trace('buffer length of '+c.toFixed(3)+' is below max of '+l.toFixed(3)+'. checking for more payload ...'),this.level=e.nextLoadLevel=i;var p=o.details;if('undefined'==typeof p||p.live&&this.levelLastLoaded!==i)return this.state=h.WAITING_LEVEL,!0;var m=this.fragPrevious;if(!p.live&&m&&m.sn===p.endSN&&a.duration-u(f.end,m.start)<=u(0.2,m.duration/2)){var v={};return this.altAudio&&(v.type='video'),this.hls.trigger(g.a.BUFFER_EOS,v),this.state=h.ENDED,!0}return this._fetchPayloadOrEos(r,f,p)}},{key:'_fetchPayloadOrEos',value:function(e,t,a){var r=this.fragPrevious,l=this.level,i=a.fragments,n=i.length;if(0===n)return!1;var o,s=i[0].start,d=i[n-1].start+i[n-1].duration,u=t.end;if(a.initSegment&&!a.initSegment.data)o=a.initSegment;else if(a.live){var g=this.config.initialLiveManifestSize;if(n<g)return y.logger.warn('Can not start playback of a level, reason: not enough fragments '+n+' < '+g),!1;if(o=this._ensureFragmentAtLivePoint(a,u,s,d,r,i,n),null===o)return!1}else u<s&&(o=i[0]);return o||(o=this._findFragment(s,r,n,i,u,d,a)),!o||this._loadFragmentOrKey(o,l,a,e,u)}},{key:'_ensureFragmentAtLivePoint',value:function(e,t,r,l,i,o,s){var d,g=this.hls.config,f=this.media,c=void 0===g.liveMaxLatencyDuration?g.liveMaxLatencyDurationCount*e.targetduration:g.liveMaxLatencyDuration;if(t<u(r-g.maxFragLookUpTolerance,l-c)){var p=this.liveSyncPosition=this.computeLivePosition(r,e);y.logger.log('buffer end: '+t.toFixed(3)+' is located too far from the end of live sliding playlist, reset currentTime to : '+p.toFixed(3)),t=p,f&&f.readyState&&f.duration>p&&(f.currentTime=p)}if(e.PTSKnown&&t>l&&f&&f.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(i){var m=i.sn+1;m>=e.startSN&&m<=e.endSN&&(d=o[m-e.startSN],y.logger.log('live playlist, switching playlist, load frag with next SN: '+d.sn))}d||(d=o[n(s-1,a(s/2))],y.logger.log('live playlist, switching playlist, unknown, load middle frag : '+d.sn))}return d}},{key:'_findFragment',value:function(e,t,a,r,l,i,s){var d,u,g=this.hls.config,f=g.maxFragLookUpTolerance,c=t?r[t.sn-r[0].sn+1]:void 0,p=function(e){var t=n(f,e.duration);return e.start+e.duration-t<=l?1:e.start-t>l&&e.start?-1:0};if(l<i?(l>i-f&&(f=0),u=c&&!p(c)?c:o.a.search(r,p)):u=r[a-1],u){d=u;var m=d.sn-s.startSN,v=t&&d.level===t.level,h=r[m-1],b=r[m+1];if(!(v&&d.sn===t.sn))d.dropped&&!v&&(b&&b.backtracked?(y.logger.warn('Already backtracked from fragment '+(m+1)+', will not backtrack to fragment '+m+'. Loading fragment '+(m+1)),d=b):(y.logger.warn('Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe'),d.dropped=0,h&&h.loadCounter?(h.loadCounter--,d=h):d=null));else if(d.sn<s.endSN){var _=t.deltaPTS;_&&_>g.maxBufferHole&&t.dropped&&m?(d=h,y.logger.warn('SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this'),t.loadCounter--):(d=b,y.logger.log('SN just loaded, load next one: '+d.sn))}else d=null}return d}},{key:'_loadFragmentOrKey',value:function(e,t,a,r,l){var i=this.hls,n=i.config;if(e.decryptdata&&null!=e.decryptdata.uri&&null==e.decryptdata.key)y.logger.log('Loading key for '+e.sn+' of ['+a.startSN+' ,'+a.endSN+'],level '+t),this.state=h.KEY_LOADING,i.trigger(g.a.KEY_LOADING,{frag:e});else{if(y.logger.log('Loading '+e.sn+' of ['+a.startSN+' ,'+a.endSN+'],level '+t+', currentTime:'+r.toFixed(3)+',bufferEnd:'+l.toFixed(3)),void 0===this.fragLoadIdx?this.fragLoadIdx=0:this.fragLoadIdx++,e.loadCounter){e.loadCounter++;var o=n.fragLoadingLoopThreshold;if(e.loadCounter>o&&Math.abs(this.fragLoadIdx-e.loadIdx)<o)return i.trigger(g.a.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:e}),!1}else e.loadCounter=1;return e.loadIdx=this.fragLoadIdx,this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||(this.nextLoadPosition=e.start+e.duration),e.autoLevel=i.autoLevelEnabled,e.bitrateTest=this.bitrateTest,i.trigger(g.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new d['default'](i,'main')),this.state=h.FRAG_LOADING,!0}}},{key:'getBufferRange',value:function(e){return o.a.search(this.bufferRange,function(t){return e<t.start?-1:e>t.end?1:0})}},{key:'followingBufferRange',value:function(e){return e?this.getBufferRange(e.end+0.5):null}},{key:'_checkFragmentChanged',value:function(){var e,t,a=this.media;if(a&&a.readyState&&!1===a.seeking&&(t=a.currentTime,t>a.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),s['default'].isBuffered(a,t)?e=this.getBufferRange(t):s['default'].isBuffered(a,t+0.1)&&(e=this.getBufferRange(t+0.1)),e)){var r=e.frag;r!==this.fragPlaying&&(this.fragPlaying=r,this.hls.trigger(g.a.FRAG_CHANGED,{frag:r}))}}},{key:'immediateLevelSwitch',value:function(){if(y.logger.log('immediateLevelSwitch'),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var a=this.fragCurrent;a&&a.loader&&a.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:'immediateLevelSwitchEnd',value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,s['default'].isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),!this.previouslyPaused&&e.play())}},{key:'nextLevelSwitch',value:function(){var e=this.media;if(e&&e.readyState){var t,a,r;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,a=this.getBufferRange(e.currentTime),a&&1<a.start&&this.flushMainBuffer(0,a.start-1),!e.paused){var l=this.hls.nextLoadLevel,i=this.levels[l],n=this.fragLastKbps;t=n&&this.fragCurrent?this.fragCurrent.duration*i.bitrate/(1e3*n)+1:0}else t=0;if(r=this.getBufferRange(e.currentTime+t),r&&(r=this.followingBufferRange(r),r)){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(r.start,Number.POSITIVE_INFINITY)}}}},{key:'flushMainBuffer',value:function(e,t){this.state=h.BUFFER_FLUSHING;var a={startOffset:e,endOffset:t};this.altAudio&&(a.type='video'),this.hls.trigger(g.a.BUFFER_FLUSHING,a)}},{key:'onMediaAttached',value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener('seeking',this.onvseeking),t.addEventListener('seeked',this.onvseeked),t.addEventListener('ended',this.onvended);var a=this.config;this.levels&&a.autoStartLoad&&this.hls.startLoad(a.startPosition)}},{key:'onMediaDetaching',value:function(){var e=this.media;e&&e.ended&&(y.logger.log('MSE detaching and video ended, reset startPosition'),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0,e.backtracked=void 0})}),e&&(e.removeEventListener('seeking',this.onvseeking),e.removeEventListener('seeked',this.onvseeked),e.removeEventListener('ended',this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:'onMediaSeeking',value:function(){var e=this.media,t=e?e.currentTime:void 0,a=this.config;if(y.logger.log('media seeking to '+t.toFixed(3)),this.state===h.FRAG_LOADING){var r=this.mediaBuffer?this.mediaBuffer:e,l=s['default'].bufferInfo(r,t,this.config.maxBufferHole),i=this.fragCurrent;if(0===l.len&&i){var n=a.maxFragLookUpTolerance,o=i.start-n,d=i.start+i.duration+n;t<o||t>d?(i.loader&&(y.logger.log('seeking outside of buffer while fragment load in progress, cancel fragment load'),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=h.IDLE):y.logger.log('seeking outside of buffer but within currently loaded fragment range')}}else this.state===h.ENDED&&(this.state=h.IDLE);e&&(this.lastCurrentTime=t),this.state!==h.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*a.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:'onMediaSeeked',value:function(){y.logger.log('media seeked to '+this.media.currentTime.toFixed(3)),this.tick()}},{key:'onMediaEnded',value:function(){y.logger.log('media ended'),this.startPosition=this.lastCurrentTime=0}},{key:'onManifestLoading',value:function(){y.logger.log('trigger BUFFER_RESET'),this.hls.trigger(g.a.BUFFER_RESET),this.bufferRange=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:'onManifestParsed',value:function(e){var t,a=!1,r=!1;e.levels.forEach(function(e){t=e.audioCodec,t&&(-1!==t.indexOf('mp4a.40.2')&&(a=!0),-1!==t.indexOf('mp4a.40.5')&&(r=!0))}),this.audioCodecSwitch=a&&r,this.audioCodecSwitch&&y.logger.log('both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC'),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var l=this.config;l.autoStartLoad&&this.hls.startLoad(l.startPosition)}},{key:'onLevelLoaded',value:function(e){var t=e.details,a=e.level,r=this.levels[a],l=t.totalduration,i=0;if(y.logger.log('level '+a+' loaded ['+t.startSN+','+t.endSN+'],duration:'+l),this.levelLastLoaded=a,t.live){var n=r.details;n&&0<t.fragments.length?(c['default'].mergeDetails(n,t),i=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(i,n),t.PTSKnown?y.logger.log('live playlist sliding:'+i.toFixed(3)):y.logger.log('live playlist - outdated PTS, unknown sliding')):(t.PTSKnown=!1,y.logger.log('live playlist - first load, unknown sliding'))}else t.PTSKnown=!1;if(r.details=t,this.hls.trigger(g.a.LEVEL_UPDATED,{details:t,level:a}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var o=t.startTimeOffset;isNaN(o)?t.live?(this.startPosition=this.computeLivePosition(i,t),y.logger.log('configure startPosition to '+this.startPosition)):this.startPosition=0:(0>o&&(y.logger.log('negative start time offset '+o+', count from end of last fragment'),o=i+l+o),y.logger.log('start time offset found in playlist, adjust startPosition to '+o),this.startPosition=o),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===h.WAITING_LEVEL&&(this.state=h.IDLE),this.tick()}},{key:'onKeyLoaded',value:function(){this.state===h.KEY_LOADING&&(this.state=h.IDLE,this.tick())}},{key:'onFragLoaded',value:function(e){var t=this.fragCurrent,a=e.frag;if(this.state===h.FRAG_LOADING&&t&&'main'===a.type&&a.level===t.level&&a.sn===t.sn){var r=e.stats,l=this.levels[t.level],i=l.details;if(y.logger.log('Loaded  '+t.sn+' of ['+i.startSN+' ,'+i.endSN+'],level '+t.level),this.bitrateTest=!1,this.stats=r,!0===a.bitrateTest&&this.hls.nextLoadLevel)this.state=h.IDLE,this.startFragRequested=!1,r.tparsed=r.tbuffered=performance.now(),this.hls.trigger(g.a.FRAG_BUFFERED,{stats:r,frag:t,id:'main'}),this.tick();else if('initSegment'===a.sn)this.state=h.IDLE,r.tparsed=r.tbuffered=performance.now(),i.initSegment.data=e.payload,this.hls.trigger(g.a.FRAG_BUFFERED,{stats:r,frag:t,id:'main'}),this.tick();else{this.state=h.PARSING;var n=i.totalduration,o=isNaN(t.startDTS)?t.start:t.startDTS,s=t.level,u=t.sn,f=this.config.defaultAudioCodec||l.audioCodec;this.audioCodecSwap&&(y.logger.log('swapping playlist audio codec'),void 0===f&&(f=this.lastAudioCodec),f&&(-1===f.indexOf('mp4a.40.5')?f='mp4a.40.5':f='mp4a.40.2')),this.pendingBuffering=!0,this.appended=!1,y.logger.log('Parsing '+u+' of ['+i.startSN+' ,'+i.endSN+'],level '+s+', cc '+t.cc);var c=this.demuxer;c||(c=this.demuxer=new d['default'](this.hls,'main'));var p=this.media,m=p&&p.seeking,v=!m&&(i.PTSKnown||!i.live),b=i.initSegment?i.initSegment.data:[];c.push(e.payload,b,f,l.videoCodec,o,t.cc,s,u,n,t.decryptdata,v,void 0)}}this.fragLoadError=0}},{key:'onFragParsingInitSegment',value:function(e){var t=this.fragCurrent;if(t&&'main'===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===h.PARSING){var a,r,l=e.tracks;if(l.audio&&this.altAudio&&delete l.audio,r=l.audio,r){var i=this.levels[this.level].audioCodec,n=navigator.userAgent.toLowerCase();i&&this.audioCodecSwap&&(y.logger.log('swapping playlist audio codec'),i=-1===i.indexOf('mp4a.40.5')?'mp4a.40.5':'mp4a.40.2'),this.audioCodecSwitch&&1!==r.metadata.channelCount&&-1===n.indexOf('firefox')&&(i='mp4a.40.5'),-1!==n.indexOf('android')&&'audio/mpeg'!==r.container&&(i='mp4a.40.2',y.logger.log('Android: force audio codec to '+i)),r.levelCodec=i,r.id=e.id}if(r=l.video,r&&(r.levelCodec=this.levels[this.level].videoCodec,r.id=e.id),e.unique){var o={codec:'',levelCodec:''};for(a in e.tracks)r=l[a],o.container=r.container,o.codec&&(o.codec+=',',o.levelCodec+=','),r.codec&&(o.codec+=r.codec),r.levelCodec&&(o.levelCodec+=r.levelCodec);l={audiovideo:o}}for(a in this.hls.trigger(g.a.BUFFER_CODECS,l),l){r=l[a],y.logger.log('main track:'+a+',container:'+r.container+',codecs[level/parsed]=['+r.levelCodec+'/'+r.codec+']');var s=r.initSegment;s&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(g.a.BUFFER_APPENDING,{type:a,data:s,parent:'main',content:'initSegment'}))}this.tick()}}},{key:'onFragParsingData',value:function(e){var t=this,a=this.fragCurrent;if(a&&'main'===e.id&&e.sn===a.sn&&e.level===a.level&&!('audio'===e.type&&this.altAudio)&&this.state===h.PARSING){var r=this.levels[this.level],l=this.fragCurrent;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+a.duration,e.endDTS=e.startDTS+a.duration),y.logger.log('Parsed '+e.type+',PTS:['+e.startPTS.toFixed(3)+','+e.endPTS.toFixed(3)+'],DTS:['+e.startDTS.toFixed(3)+'/'+e.endDTS.toFixed(3)+'],nb:'+e.nb+',dropped:'+(e.dropped||0)),'video'===e.type)if(l.dropped=e.dropped,l.dropped){if(!l.backtracked)return l.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=h.IDLE,void this.tick();y.logger.warn('Already backtracked on this fragment, appending with the gap')}else l.backtracked=!1;var i=c['default'].updateFragPTSDTS(r.details,l.sn,e.startPTS,e.endPTS,e.startDTS,e.endDTS),n=this.hls;n.trigger(g.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:i,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(a){a&&a.length&&t.state===h.PARSING&&(t.appended=!0,t.pendingBuffering=!0,n.trigger(g.a.BUFFER_APPENDING,{type:e.type,data:a,parent:'main',content:'data'}))}),this.tick()}}},{key:'onFragParsed',value:function(e){var t=this.fragCurrent;t&&'main'===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===h.PARSING&&(this.stats.tparsed=performance.now(),this.state=h.PARSED,this._checkAppendedParsed())}},{key:'onAudioTrackSwitching',value:function(e){var t=!!e.url,a=e.id;if(!t){if(this.mediaBuffer!==this.media){y.logger.log('switching on main audio, use media.buffered to schedule main fragment loading'),this.mediaBuffer=this.media;var r=this.fragCurrent;r.loader&&(y.logger.log('switching to main audio track, cancel main fragment load'),r.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=h.IDLE}var l=this.hls;l.trigger(g.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:'audio'}),l.trigger(g.a.AUDIO_TRACK_SWITCHED,{id:a}),this.altAudio=!1}}},{key:'onAudioTrackSwitched',value:function(e){var t=e.id,a=!!this.hls.audioTracks[t].url;if(a){var r=this.videoBuffer;r&&this.mediaBuffer!==r&&(y.logger.log('switching on alternate audio, use video.buffered to schedule main fragment loading'),this.mediaBuffer=r)}this.altAudio=a,this.tick()}},{key:'onBufferCreated',value:function(e){var t,a,r=e.tracks,l=!1;for(var i in r){var n=r[i];'main'===n.id?(a=i,t=n,'video'==i&&(this.videoBuffer=r[i].buffer)):l=!0}l&&t?(y.logger.log('alternate track found, use '+a+'.buffered to schedule main fragment loading'),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media}},{key:'onBufferAppended',value:function(e){if('main'===e.parent){var t=this.state;(t===h.PARSING||t===h.PARSED)&&(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}}},{key:'_checkAppendedParsed',value:function(){if(this.state===h.PARSED&&(!this.appended||!this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;y.logger.log('main buffered : '+p['default'].toString(t.buffered));var r=this.bufferRange.filter(function(e){return s['default'].isBuffered(t,(e.start+e.end)/2)});r.push({type:e.type,start:e.startPTS,end:e.endPTS,frag:e}),this.bufferRange=r.sort(function(e,t){return e.start-t.start}),this.fragPrevious=e;var l=this.stats;l.tbuffered=performance.now(),this.fragLastKbps=a(8*l.total/(l.tbuffered-l.tfirst)),this.hls.trigger(g.a.FRAG_BUFFERED,{stats:l,frag:e,id:'main'}),this.state=h.IDLE}this.tick()}}},{key:'onError',value:function(e){var t=e.frag||this.fragCurrent;if(!(t&&'main'!==t.type)){var a=this.media,r=a&&s['default'].isBuffered(a,a.currentTime)&&s['default'].isBuffered(a,a.currentTime+0.5);switch(e.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var l=this.fragLoadError;l?l++:l=1;var i=this.config;if(l<=i.fragLoadingMaxRetry||r||t.autoLevel&&t.level){this.fragLoadError=l,t.loadCounter=0;var o=n(Math.pow(2,l-1)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);y.logger.warn('mediaController: frag loading failed, retry in '+o+' ms'),this.retryDate=performance.now()+o,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=h.FRAG_LOADING_WAITING_RETRY}else y.logger.error('mediaController: '+e.details+' reaches max retry, redispatch as fatal ...'),e.fatal=!0,this.hls.trigger(g.a.ERROR,e),this.state=h.ERROR}break;case m.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(r?(this._reduceMaxBufferLength(t.duration),this.state=h.IDLE):(!t.autoLevel||0===t.level)&&(e.fatal=!0,this.hls.trigger(g.a.ERROR,e),this.state=h.ERROR));break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==h.ERROR&&(e.fatal?(this.state=h.ERROR,y.logger.warn('streamController: '+e.details+',switch to '+this.state+' state ...')):this.state===h.WAITING_LEVEL&&(this.state=h.IDLE));break;case m.ErrorDetails.BUFFER_FULL_ERROR:'main'===e.parent&&(this.state===h.PARSING||this.state===h.PARSED)&&(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=h.IDLE):(y.logger.warn('buffer full error also media.currentTime is not buffered, flush everything'),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)));break;default:}}}},{key:'_reduceMaxBufferLength',value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,y.logger.warn('main:reduce max buffer length to '+t.maxMaxBufferLength+'s'),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:'_checkBuffer',value:function(){var e=this.media;if(e&&e.readyState){var t=e.currentTime,r=this.mediaBuffer?this.mediaBuffer:e,l=r.buffered;if(!this.loadedmetadata&&l.length&&!e.seeking){this.loadedmetadata=!0;var i=this.startPosition,n=s['default'].isBuffered(r,i);t===i&&n||(y.logger.log('target start position:'+i),!n&&(i=l.start(0),y.logger.log('target start position not buffered, seek to buffered.start(0) '+i)),y.logger.log('adjust currentTime from '+t+' to '+i),e.currentTime=i)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var o=s['default'].bufferInfo(e,t,0),d=!(e.paused||e.ended||0===e.buffered.length),u=0.5,f=t!==this.lastCurrentTime,c=this.config;if(f)this.stallReported&&(y.logger.warn('playback not stuck anymore @'+t+', after '+a(performance.now()-this.stalled)+'ms'),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(d){var p=performance.now(),v=this.hls;if(!this.stalled)this.stalled=p,this.stallReported=!1;else{var h=p-this.stalled,b=o.len,_=this.nudgeRetry||0;if(b<=u&&h>1e3*c.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,y.logger.warn('playback stalling in low buffer @'+t),v.trigger(g.a.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:b}));var E=o.nextStart,L=E-t;if(E&&L<c.maxSeekHole&&0<L){this.nudgeRetry=++_;var k=_*c.nudgeOffset;y.logger.log('adjust currentTime from '+e.currentTime+' to next buffered @ '+E+' + nudge '+k),e.currentTime=E+k,this.stalled=void 0,v.trigger(g.a.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:E+k-t})}}else if(b>u&&h>1e3*c.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,y.logger.warn('playback stalling in high buffer @'+t),v.trigger(g.a.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:b})),this.stalled=void 0,this.nudgeRetry=++_,_<c.nudgeMaxRetry){var A=e.currentTime,R=A+_*c.nudgeOffset;y.logger.log('adjust currentTime from '+A+' to '+R),e.currentTime=R,v.trigger(g.a.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else y.logger.error('still stuck in high buffer @'+t+' after '+c.nudgeMaxRetry+', raise fatal error'),v.trigger(g.a.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}}}}}},{key:'onFragLoadEmergencyAborted',value:function(){this.state=h.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:'onBufferFlushed',value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferRange=this.bufferRange.filter(function(t){return s['default'].isBuffered(e,(t.start+t.end)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=h.IDLE,this.fragPrevious=null}},{key:'swapAudioCodec',value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:'computeLivePosition',value:function(e,t){var a=void 0===this.config.liveSyncDuration?this.config.liveSyncDurationCount*t.targetduration:this.config.liveSyncDuration;return e+u(0,t.totalduration-a)}},{key:'state',set:function(e){if(this.state!==e){var t=this.state;this._state=e,y.logger.log('main stream:'+t+'->'+e),this.hls.trigger(g.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:'currentLevel',get:function(){var e=this.media;if(e){var t=this.getBufferRange(e.currentTime);if(t)return t.frag.level}return-1}},{key:'nextBufferRange',get:function(){var e=this.media;return e?this.followingBufferRange(this.getBufferRange(e.currentTime)):null}},{key:'nextLevel',get:function(){var e=this.nextBufferRange;return e?e.frag.level:-1}},{key:'liveSyncPosition',get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(f['default']);t['default']=b;window.__NEWLINE__=1},function(e){e.exports={search:function(e,t){for(var a=0,r=e.length-1,l=null,i=null;a<=r;){l=0|(a+r)/2,i=e[l];var n=t(i);if(0<n)a=l+1;else if(0>n)r=l-1;else return i}return null}};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(){r(this,e)}return l(e,null,[{key:'isBuffered',value:function(e,t){if(e)for(var a=e.buffered,r=0;r<a.length;r++)if(t>=a.start(r)&&t<=a.end(r))return!0;return!1}},{key:'bufferInfo',value:function(e,t,a){if(e){var r,l=e.buffered,i=[];for(r=0;r<l.length;r++)i.push({start:l.start(r),end:l.end(r)});return this.bufferedInfo(i,t,a)}return{len:0,start:t,end:t,nextStart:void 0}}},{key:'bufferedInfo',value:function(e,t,a){var r,l,n,o,s,i=[];for(e.sort(function(e,t){var a=e.start-t.start;return a?a:t.end-e.end}),s=0;s<e.length;s++){var d=i.length;if(d){var u=i[d-1].end;e[s].start-u<a?e[s].end>u&&(i[d-1].end=e[s].end):i.push(e[s])}else i.push(e[s])}for(s=0,r=0,l=n=t;s<i.length;s++){var g=i[s].start,f=i[s].end;if(t+a>=g&&t<f)l=g,n=f,r=n-t;else if(t+a<g){o=g;break}}return{len:r,start:l,end:n,nextStart:o}}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(206),i=a.n(l),n=a(220),o=a(235),s=a(211),d=a(207),u=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var g=function(){function e(t,l){r(this,e),this.hls=t,this.id=l;var u={mp4:MediaSource.isTypeSupported('video/mp4'),mpeg:MediaSource.isTypeSupported('audio/mpeg'),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')};if(t.config.enableWorker&&'undefined'!=typeof Worker){s.logger.log('demuxing in webworker');var g;try{var f=a(237);g=this.w=f(o['default']),this.onwmsg=this.onWorkerMessage.bind(this),g.addEventListener('message',this.onwmsg),g.onerror=function(e){t.trigger(i.a.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:'demuxerWorker',err:{message:e.message+' ('+e.filename+':'+e.lineno+')'}})},g.postMessage({cmd:'init',typeSupported:u,id:l,config:JSON.stringify(t.config)})}catch(e){s.logger.error('error while initializing DemuxerWorker, fallback on DemuxerInline'),g&&URL.revokeObjectURL(g.objectURL),this.demuxer=new n['default'](t,l,u),this.w=void 0}}else this.demuxer=new n['default'](t,l,u)}return u(e,[{key:'destroy',value:function(){var e=this.w;if(e)e.removeEventListener('message',this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}}},{key:'push',value:function(e,t,a,r,l,i,n,o,s,d,u,g){var f=this.w;if(f)f.postMessage({cmd:'demux',data:e,initSegment:t,audioCodec:a,videoCodec:r,timeOffset:l,cc:i,level:n,sn:o,duration:s,decryptdata:d,accurateTimeOffset:u,defaultInitPTS:g},[e]);else{var c=this.demuxer;c&&c.push(e,t,a,r,l,i,n,o,s,d,u,g)}}},{key:'onWorkerMessage',value:function(e){var t=e.data,a=this.hls;switch(t.event){case'init':URL.revokeObjectURL(this.w.objectURL);break;case i.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:a.trigger(t.event,t.data);}}}]),e}();t['default']=g;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(206),n=a.n(l),o=a(207),s=a(211),i=a(221),d=a(225),u=a(228),g=a(229),f=a(231),c=a(234),p=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var m=function(){function e(t,a,l){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;r(this,e),this.hls=t,this.id=a,this.config=this.hls.config||i,this.typeSupported=l}return p(e,[{key:'destroy',value:function(){var e=this.demuxer;e&&e.destroy()}},{key:'push',value:function(e,t,a,r,l,o,s,d,u,g,f,c){if(0<e.byteLength&&null!=g&&null!=g.key&&'AES-128'===g.method){null==this.decrypter&&(this.decrypter=new i['default'](this.hls,this.config));var p,m=this;try{p=performance.now()}catch(e){p=Date.now()}this.decrypter.decrypt(e,g.key.buffer,g.iv.buffer,function(e){var i;try{i=performance.now()}catch(e){i=Date.now()}m.hls.trigger(n.a.FRAG_DECRYPTED,{level:s,sn:d,stats:{tstart:p,tdecrypt:i}}),m.pushDecrypted(new Uint8Array(e),new Uint8Array(t),a,r,l,o,s,d,u,f,c)})}else this.pushDecrypted(new Uint8Array(e),new Uint8Array(t),a,r,l,o,s,d,u,f,c)}},{key:'pushDecrypted',value:function(e,t,a,r,l,p,m,y,v,h,b){var _=this.demuxer,E=this.id;if(!_||p!==this.cc&&!this.probe(e)){var L=this.hls,k=[{demux:g['default'],remux:f['default']},{demux:d['default'],remux:f['default']},{demux:u['default'],remux:c['default']}];for(var A in k){var i=k[A],R=i.demux.probe;if(R(e)){var S=this.remuxer=new i.remux(L,E,this.config,this.typeSupported);_=new i.demux(L,E,S,this.config,this.typeSupported),this.probe=R;break}}if(!_)return void L.trigger(n.a.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,id:E,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:'no demux matching with content found'});this.demuxer=_,this.lastCC=0}var T=!1,D=this.remuxer;p!==this.lastCC&&(s.logger.log(E+':discontinuity detected'),_.resetInitSegment(t,m,y,a,r,v),D.resetInitSegment(),_.resetTimeStamp(),D.resetTimeStamp(b),this.lastCC=p),m===this.lastLevel?y===this.lastSN+1&&(T=!0):(s.logger.log(E+':switch detected'),_.resetInitSegment(t,m,y,a,r,v),D.resetInitSegment(),this.lastLevel=m),this.lastSN=y,this.cc=p,_.append(e,l,p,m,y,T,h)}}]),e}();t['default']=m;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(222),i=a(223),n=a(224),o=a(207),s=a(211),d=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var u=function(){function e(t,a){r(this,e),this.observer=t,this.config=a;try{var l=crypto?crypto:self.crypto;this.subtle=l.subtle||l.webkitSubtle}catch(t){}this.disableWebCrypto=!this.subtle}return d(e,[{key:'decrypt',value:function(e,t,a,r){var o=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){s.logger.log('JS AES decrypt');var d=this.decryptor;d||(this.decryptor=d=new n['default']),d.expandKey(t),r(d.decrypt(e,0,a))}else{s.logger.log('WebCrypto AES decrypt');var u=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new i['default'](u,t)),this.fastAesKey.expandKey().then(function(t){var i=new l['default'](u,a);i.decrypt(e,t).then(function(e){r(e)})}).catch(function(l){o.onWebCryptoError(l,e,t,a,r)})}}},{key:'onWebCryptoError',value:function(e,t,a,r,l){this.config.enableSoftwareAES?(s.logger.log('WebCrypto Error, disable WebCrypto API'),this.disableWebCrypto=!0,this.decrypt(t,a,r,l)):(s.logger.error('decrypting error : '+e.message),this.observer.trigger(Event.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:'destroy',value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();t['default']=u;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(t,a){r(this,e),this.subtle=t,this.aesIV=a}return l(e,[{key:'decrypt',value:function(e,t){return this.subtle.decrypt({name:'AES-CBC',iv:this.aesIV},t,e)}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(t,a){r(this,e),this.subtle=t,this.key=a}return l(e,[{key:'expandKey',value:function(){return this.subtle.importKey('raw',this.key,{name:'AES-CBC'},!1,['encrypt','decrypt'])}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(){r(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[],this.subMix[0]=new Uint32Array(256),this.subMix[1]=new Uint32Array(256),this.subMix[2]=new Uint32Array(256),this.subMix[3]=new Uint32Array(256),this.invSubMix=[],this.invSubMix[0]=new Uint32Array(256),this.invSubMix[1]=new Uint32Array(256),this.invSubMix[2]=new Uint32Array(256),this.invSubMix[3]=new Uint32Array(256),this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return l(e,[{key:'uint8ArrayToUint32Array_',value:function(e){for(var t=new DataView(e),a=new Uint32Array(4),r=0;r<a.length;r++)a[r]=t.getUint32(4*r);return a}},{key:'initTable',value:function(){var e=this.sBox,a=this.invSBox,r=this.subMix[0],l=this.subMix[1],n=this.subMix[2],o=this.subMix[3],s=this.invSubMix[0],u=this.invSubMix[1],g=this.invSubMix[2],f=this.invSubMix[3],c=new Uint32Array(256),d=0,p=0,m=0;for(m=0;256>m;m++)c[m]=128>m?m<<1:283^m<<1;for(m=0;256>m;m++){var i=p^p<<1^p<<2^p<<3^p<<4;i=99^(i>>>8^255&i),e[d]=i,a[i]=d;var y=c[d],v=c[y],h=c[v],b=257*c[i]^16843008*i;r[d]=b<<24|b>>>8,l[d]=b<<16|b>>>16,n[d]=b<<8|b>>>24,o[d]=b,b=16843009*h^65537*v^257*y^16843008*d,s[i]=b<<24|b>>>8,u[i]=b<<16|b>>>16,g[i]=b<<8|b>>>24,f[i]=b,d?(d=y^c[c[c[h^y]]],p^=c[c[p]]):d=p=1}}},{key:'expandKey',value:function(e){for(var a=this.uint8ArrayToUint32Array_(e),r=!0,l=0;l<a.length&&r;)r=a[l]===this.key[l],l++;if(!r){this.key=a;var i=this.keySize=a.length;if(4!==i&&6!==i&&8!==i)throw new Error('Invalid aes key size='+i);var n,o,s,d,t=this.ksRows=4*(i+6+1),u=this.keySchedule=new Uint32Array(this.ksRows),g=this.invKeySchedule=new Uint32Array(this.ksRows),f=this.sBox,c=this.rcon,p=this.invSubMix[0],m=this.invSubMix[1],y=this.invSubMix[2],v=this.invSubMix[3];for(n=0;n<t;n++){if(n<i){s=u[n]=a[n];continue}d=s,0==n%i?(d=d<<8|d>>>24,d=f[d>>>24]<<24|f[255&d>>>16]<<16|f[255&d>>>8]<<8|f[255&d],d^=c[0|n/i]<<24):6<i&&4==n%i&&(d=f[d>>>24]<<24|f[255&d>>>16]<<16|f[255&d>>>8]<<8|f[255&d]),u[n]=s=(u[n-i]^d)>>>0}for(o=0;o<t;o++)n=t-o,d=3&o?u[n]:u[n-4],g[o]=4>o||4>=n?d:p[f[d>>>24]]^m[f[255&d>>>16]]^y[f[255&d>>>8]]^v[f[255&d]],g[o]>>>=0}}},{key:'networkToHostOrderSwap',value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:'decrypt',value:function(e,t,a){for(var r,l,n,o,s,d,u,g,f,c,p,m,y,v,i=this.keySize+6,h=this.invKeySchedule,b=this.invSBox,_=this.invSubMix[0],E=this.invSubMix[1],L=this.invSubMix[2],k=this.invSubMix[3],A=this.uint8ArrayToUint32Array_(a),R=A[0],S=A[1],T=A[2],D=A[3],x=new Int32Array(e),C=new Int32Array(x.length);t<x.length;){for(f=this.networkToHostOrderSwap(x[t]),c=this.networkToHostOrderSwap(x[t+1]),p=this.networkToHostOrderSwap(x[t+2]),m=this.networkToHostOrderSwap(x[t+3]),s=f^h[0],d=m^h[1],u=p^h[2],g=c^h[3],y=4,v=1;v<i;v++)r=_[s>>>24]^E[255&d>>16]^L[255&u>>8]^k[255&g]^h[y],l=_[d>>>24]^E[255&u>>16]^L[255&g>>8]^k[255&s]^h[y+1],n=_[u>>>24]^E[255&g>>16]^L[255&s>>8]^k[255&d]^h[y+2],o=_[g>>>24]^E[255&s>>16]^L[255&d>>8]^k[255&u]^h[y+3],s=r,d=l,u=n,g=o,y+=4;r=b[s>>>24]<<24^b[255&d>>16]<<16^b[255&u>>8]<<8^b[255&g]^h[y],l=b[d>>>24]<<24^b[255&u>>16]<<16^b[255&g>>8]<<8^b[255&s]^h[y+1],n=b[u>>>24]<<24^b[255&g>>16]<<16^b[255&s>>8]<<8^b[255&d]^h[y+2],o=b[g>>>24]<<24^b[255&s>>16]<<16^b[255&d>>8]<<8^b[255&u]^h[y+3],y+=3,C[t]=this.networkToHostOrderSwap(r^R),C[t+1]=this.networkToHostOrderSwap(o^S),C[t+2]=this.networkToHostOrderSwap(n^T),C[t+3]=this.networkToHostOrderSwap(l^D),R=f,S=c,T=p,D=m,t+=4}return C.buffer}},{key:'destroy',value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(226),i=a(211),n=a(227),o=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var s=function(){function e(t,a,l,i){r(this,e),this.observer=t,this.id=a,this.config=i,this.remuxer=l}return o(e,[{key:'resetInitSegment',value:function(e,t,a,r,l,i){this._aacTrack={container:'audio/adts',type:'audio',id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:r,duration:i}}},{key:'resetTimeStamp',value:function(){}},{key:'append',value:function(e,t,a,r,o,s,d){var u,g,f,c,p,m,y,v,h,b,_=new n['default'](e),E=90*_.timeStamp;for(u=this._aacTrack,m=_.length,h=e.length;m<h-1&&(255!==e[m]||240!=(240&e[m+1]));m++);for(u.audiosamplerate||(g=l['default'].getAudioConfig(this.observer,e,m,u.manifestCodec),u.config=g.config,u.audiosamplerate=g.samplerate,u.channelCount=g.channelCount,u.codec=g.codec,i.logger.log('parsed codec:'+u.codec+',rate:'+g.samplerate+',nb channel:'+g.channelCount)),p=0,c=9.216e7/u.audiosamplerate;m+5<h&&(y=1&e[m+1]?7:9,f=(3&e[m+3])<<11|e[m+4]<<3|(224&e[m+5])>>>5,f-=y,0<f&&m+y+f<=h);)for(v=E+p*c,b={unit:e.subarray(m+y,m+y+f),pts:v,dts:v},u.samples.push(b),u.len+=f,m+=f+y,p++;m<h-1&&(255!==e[m]||240!=(240&e[m+1]));m++);this.remuxer.remux(r,o,a,u,{samples:[]},{samples:[{pts:E,dts:E,unit:_.payload}]},{samples:[]},t,s,d)}},{key:'destroy',value:function(){}}],[{key:'probe',value:function(e){var t,a,r=new n['default'](e);if(r.hasTimeStamp)for(t=r.length,a=e.length;t<a-1;t++)if(255===e[t]&&240==(240&e[t+1]))return!0;return!1}}]),e}();t['default']=s;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(211),i=a(207),n=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=function(){function e(){r(this,e)}return n(e,null,[{key:'getAudioConfig',value:function(e,t,a,r){var n,o,s,d,u,g=navigator.userAgent.toLowerCase(),f=[96000,88200,64000,48000,44100,32000,24000,22050,16000,12000,11025,8e3,7350];return(n=((192&t[a+2])>>>6)+1,o=(60&t[a+2])>>>2,o>f.length-1)?void e.trigger(Event.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:'invalid ADTS sampling index:'+o}):(d=(1&t[a+2])<<2,d|=(192&t[a+3])>>>6,l.logger.log('manifest codec:'+r+',ADTS data:type:'+n+',sampleingIndex:'+o+'['+f[o]+'Hz],channelConfig:'+d),/firefox/i.test(g)?6<=o?(n=5,u=[,,,,],s=o-3):(n=2,u=[,,],s=o):-1===g.indexOf('android')?(n=5,u=[,,,,],r&&(-1!==r.indexOf('mp4a.40.29')||-1!==r.indexOf('mp4a.40.5'))||!r&&6<=o?s=o-3:((r&&-1!==r.indexOf('mp4a.40.2')&&6<=o&&1===d||!r&&1===d)&&(n=2,u=[,,]),s=o)):(n=2,u=[,,],s=o),u[0]=n<<3,u[0]|=(14&o)>>1,u[1]|=(1&o)<<7,u[1]|=d<<3,5===n&&(u[1]|=(14&s)>>1,u[2]=(1&s)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:f[o],channelCount:d,codec:'mp4a.40.'+n,manifestCodec:r})}}]),e}();t['default']=o;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(211),i=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=function(){function e(t){r(this,e),this._hasTimeStamp=!1;var a,i,n,o,s,d,u,g,f=0;do if(u=this.readUTF(t,f,3),f+=3,'ID3'===u)f+=3,a=127&t[f++],i=127&t[f++],n=127&t[f++],o=127&t[f++],s=(a<<21)+(i<<14)+(n<<7)+o,d=f+s,this._parseID3Frames(t,f,d),f=d;else if('3DI'===u)f+=7,l.logger.log('3DI footer found, end: '+f);else return f-=3,g=f,void(g&&(!this.hasTimeStamp&&l.logger.warn('ID3 tag found, but no timestamp'),this._length=g,this._payload=t.subarray(0,g)));while(!0)}return i(e,[{key:'readUTF',value:function(e,t,a){var r='',l=t;do r+=String.fromCharCode(e[l++]);while(l<t+a);return r}},{key:'_parseID3Frames',value:function(e,t,a){for(var r,i,n,o,s;t+8<=a;)switch(r=this.readUTF(e,t,4),t+=4,i=e[t++]<<24+e[t++]<<16+e[t++]<<8+e[t++],o=e[t++]<<8+e[t++],n=t,r){case'PRIV':if('com.apple.streaming.transportStreamTimestamp'===this.readUTF(e,t,44)){t+=44,t+=4;var d=1&e[t++];this._hasTimeStamp=!0,s=((e[t++]<<23)+(e[t++]<<15)+(e[t++]<<7)+e[t++])/45,d&&(s+=47721858.84),s=Math.round(s),l.logger.trace('ID3 timestamp found: '+s),this._timeStamp=s}break;default:}}},{key:'hasTimeStamp',get:function(){return this._hasTimeStamp}},{key:'timeStamp',get:function(){return this._timeStamp}},{key:'length',get:function(){return this._length}},{key:'payload',get:function(){return this._payload}}]),e}();t['default']=n;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(206),i=a.n(l),n=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=function(){function e(t,a,l){r(this,e),this.observer=t,this.id=a,this.remuxer=l}return n(e,[{key:'resetTimeStamp',value:function(){}},{key:'resetInitSegment',value:function(t,a,r,l,n){var o=this.initData=e.parseInitSegment(t),s={};o.audio&&(s.audio={container:'audio/mp4',codec:l,initSegment:t}),o.video&&(s.video={container:'video/mp4',codec:n,initSegment:t}),this.observer.trigger(i.a.FRAG_PARSING_INIT_SEGMENT,{id:this.id,level:a,sn:r,unique:!1,tracks:s})}},{key:'append',value:function(t,a,r,l,i,n,o){var s=this.initData,d=e.startDTS(s,t);this.remuxer.remux(l,i,r,s.audio,s.video,null,null,d,n,o,t)}},{key:'destroy',value:function(){}}],[{key:'probe',value:function(t){if(8<=t.length){var a=e.bin2str(t.subarray(4,8));return 0<=['moof','ftyp','styp'].indexOf(a)}return!1}},{key:'bin2str',value:function(e){return String.fromCharCode.apply(null,e)}},{key:'findBox',value:function(t,a){var r,l,i,n,o,s=[];if(!a.length)return null;for(r=0;r<t.byteLength;)l=t[r]<<24,l|=t[r+1]<<16,l|=t[r+2]<<8,l|=t[r+3],i=e.bin2str(t.subarray(r+4,r+8)),n=1<l?r+l:t.byteLength,i===a[0]&&(1===a.length?s.push(t.subarray(r+8,n)):(o=e.findBox(t.subarray(r+8,n),a.slice(1)),o.length&&(s=s.concat(o)))),r=n;return s}},{key:'parseInitSegment',value:function(t){var a=[],r=e.findBox(t,['moov','trak']);return r.forEach(function(t){var r=e.findBox(t,['tkhd'])[0];if(r){var l=r[0],i=0===l?12:20,n=r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3];n=0>n?4294967296+n:n;var o=e.findBox(t,['mdia','mdhd'])[0];if(o){l=o[0],i=0===l?12:20;var s=o[i]<<24|o[i+1]<<16|o[i+2]<<8|o[i+3],d=e.findBox(t,['mdia','hdlr'])[0];if(d){var u=e.bin2str(d.subarray(8,12)),g={soun:'audio',vide:'video'}[u];g&&(a[n]={timescale:s,type:g},a[g]={timescale:s,id:n})}}}}),a}},{key:'startDTS',value:function(t,a){var r,l,i;return r=e.findBox(a,['moof','traf']),l=[].concat.apply([],r.map(function(a){return e.findBox(a,['tfhd']).map(function(r){var l,i,n;return l=r[4]<<24|r[5]<<16|r[6]<<8|r[7],i=t[l].timescale||9e4,n=e.findBox(a,['tfdt']).map(function(e){var t,a;return t=e[0],a=e[4]<<24|e[5]<<16|e[6]<<8|e[7],1===t&&(a*=4294967296,a+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),a})[0],n=n||Infinity,n/i})})),i=Math.min.apply(null,l),isFinite(i)?i:0}}]),e}();t['default']=o;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(226),i=a(206),n=a.n(i),o=a(230),s=a(211),d=a(207),u=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var g=function(){function e(t,a,l,i,n){r(this,e),this.observer=t,this.id=a,this.config=i,this.typeSupported=n,this.remuxer=l}var t=Math.round;return u(e,[{key:'resetInitSegment',value:function(e,t,a,r,l,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:'video/mp2t',type:'video',id:-1,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:'video/mp2t',type:'audio',id:-1,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:'id3',id:-1,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:'text',id:-1,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=l,this._duration=i}},{key:'resetTimeStamp',value:function(){}},{key:'append',value:function(e,t,a,r,l,i,o){var u,g,f,c,p,m,y=e.length,v=!1;this.contiguous=i;var h=this.pmtParsed,b=this._avcTrack,_=this._audioTrack,E=this._id3Track,L=b.id,k=_.id,A=E.id,R=this._pmtId,S=b.pesData,T=_.pesData,D=E.pesData,x=this._parsePAT,C=this._parsePMT,P=this._parsePES,O=this._parseAVCPES.bind(this),I=this._parseAACPES.bind(this),F=this._parseMPEGPES.bind(this),w=this._parseID3PES.bind(this);for(y-=y%188,u=0;u<y;u+=188)if(71===e[u]){if(g=!!(64&e[u+1]),f=((31&e[u+1])<<8)+e[u+2],c=(48&e[u+3])>>4,!(1<c))p=u+4;else if(p=u+5+e[u+4],p===u+188)continue;switch(f){case L:g&&(S&&(m=P(S))&&O(m,!1),S={data:[],size:0}),S&&(S.data.push(e.subarray(p,u+188)),S.size+=u+188-p);break;case k:g&&(T&&(m=P(T))&&(_.isAAC?I(m):F(m)),T={data:[],size:0}),T&&(T.data.push(e.subarray(p,u+188)),T.size+=u+188-p);break;case A:g&&(D&&(m=P(D))&&w(m),D={data:[],size:0}),D&&(D.data.push(e.subarray(p,u+188)),D.size+=u+188-p);break;case 0:g&&(p+=e[p]+1),R=this._pmtId=x(e,p);break;case R:g&&(p+=e[p]+1);var N=C(e,p,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3);L=N.avc,0<L&&(b.id=L),k=N.audio,0<k&&(_.id=k,_.isAAC=N.isAAC),A=N.id3,0<A&&(E.id=A),v&&!h&&(s.logger.log('reparse from beginning'),v=!1,u=-188),h=this.pmtParsed=!0;break;case 17:case 8191:break;default:v=!0;}}else this.observer.trigger(n.a.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,id:this.id,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:'TS packet did not start with 0x47'});S&&(m=P(S))?(O(m,!0),b.pesData=null):b.pesData=S,T&&(m=P(T))?(_.isAAC?I(m):F(m),_.pesData=null):(T&&T.size&&s.logger.log('last AAC PES packet truncated,might overlap between fragments'),_.pesData=T),D&&(m=P(D))?(w(m),E.pesData=null):E.pesData=D,this.remuxer.remux(r,l,a,_,b,E,this._txtTrack,t,i,o)}},{key:'destroy',value:function(){this._initPTS=this._initDTS=void 0,this._duration=0}},{key:'_parsePAT',value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:'_parsePMT',value:function(e,t,a){var r,l,i,n,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=(15&e[t+1])<<8|e[t+2],l=t+3+r-4,i=(15&e[t+10])<<8|e[t+11],t+=12+i;t<l;){switch(n=(31&e[t+1])<<8|e[t+2],e[t]){case 15:-1===o.audio&&(o.audio=n);break;case 21:-1===o.id3&&(o.id3=n);break;case 27:-1===o.avc&&(o.avc=n);break;case 3:case 4:a?-1===o.audio&&(o.audio=n,o.isAAC=!1):s.logger.log('MPEG audio found, not supported in this browser for now');break;case 36:s.logger.warn('HEVC stream type found, not supported for now');break;default:s.logger.log('unkown stream type:'+e[t]);}t+=((15&e[t+3])<<8|e[t+4])+5}return o}},{key:'_parsePES',value:function(e){var a,r,l,n,o,d,u,g,f,c=0,i=e.data;if(!e||0===e.size)return null;for(;19>i[0].length&&1<i.length;){var p=new Uint8Array(i[0].length+i[1].length);p.set(i[0]),p.set(i[1],i[0].length),i[0]=p,i.splice(1,1)}if(a=i[0],l=(a[0]<<16)+(a[1]<<8)+a[2],1===l){if(n=(a[4]<<8)+a[5],n&&n>e.size-6)return null;r=a[7],192&r&&(u=536870912*(14&a[9])+4194304*(255&a[10])+16384*(254&a[11])+128*(255&a[12])+(254&a[13])/2,4294967295<u&&(u-=8589934592),64&r?(g=536870912*(14&a[14])+4194304*(255&a[15])+16384*(254&a[16])+128*(255&a[17])+(254&a[18])/2,4294967295<g&&(g-=8589934592),5.4e6<u-g&&(s.logger.warn(t((u-g)/9e4)+'s delta between PTS and DTS, align them'),u=g)):g=u),o=a[8],f=o+9,e.size-=f,d=new Uint8Array(e.size);for(var m=0,y=i.length;m<y;m++){a=i[m];var v=a.byteLength;if(f)if(f>v){f-=v;continue}else a=a.subarray(f),v-=f,f=0;d.set(a,c),c+=v}return n&&(n-=o+3),{data:d,pts:u,dts:g,len:n}}return null}},{key:'pushAccesUnit',value:function(e,t){e.units.units.length&&e.frame&&(!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(t.samples.length||this.contiguous)?t.samples.push(e):t.dropped++),e.debug.length&&s.logger.log(e.pts+'/'+e.dts+':'+e.debug+','+e.units.length)}},{key:'_parseAVCPES',value:function(e,t){var a,r,l,i=this,n=this._avcTrack,s=this._parseAVCNALu(e.data),d=!1,u=this.avcSample;e.data=null,s.forEach(function(t){switch(t.type){case 1:r=!0,d,u.frame=!0;var s=t.data;if(4<s.length){var g=new o['default'](s).readSliceType();(2===g||4===g||7===g||9===g)&&(u.key=!0)}break;case 5:r=!0,u||(u=i.avcSample=i._createAVCSample(!0,e.pts,e.dts,'')),d,u.key=!0,u.frame=!0;break;case 6:r=!0,d,a=new o['default'](i.discardEPB(t.data)),a.readUByte();for(var f=0,c=0,p=!1,m=0;!p&&1<a.bytesAvailable;){f=0;do m=a.readUByte(),f+=m;while(255==m);c=0;do m=a.readUByte(),c+=m;while(255===m);if(4===f&&0!==a.bytesAvailable){p=!0;var y=a.readUByte();if(181===y){var v=a.readUShort();if(49===v){var b=a.readUInt();if(1195456820===b){var _=a.readUByte();if(3===_){var E=a.readUByte(),L=a.readUByte(),k=[E,L];for(l=0;l<(31&E);l++)k.push(a.readUByte()),k.push(a.readUByte()),k.push(a.readUByte());i._insertSampleInOrder(i._txtTrack.samples,{type:3,pts:e.pts,bytes:k})}}}}}else if(c<a.bytesAvailable)for(l=0;l<c;l++)a.readUByte()}break;case 7:if(r=!0,d,!n.sps){a=new o['default'](t.data);var A=a.readSPS();n.width=A.width,n.height=A.height,n.pixelRatio=A.pixelRatio,n.sps=[t.data],n.duration=i._duration;var R=t.data.subarray(1,4),S='avc1.';for(l=0;3>l;l++){var T=R[l].toString(16);2>T.length&&(T='0'+T),S+=T}n.codec=S}break;case 8:r=!0,d,n.pps||(n.pps=[t.data]);break;case 9:r=!1,u&&i.pushAccesUnit(u,n),u=i.avcSample=i._createAVCSample(!1,e.pts,e.dts,'');break;case 12:r=!1;break;default:r=!1,u&&(u.debug+='unknown NAL '+t.type+' ');}if(u&&r){var h=u.units;h.units.push(t)}}),t&&u&&(this.pushAccesUnit(u,n),this.avcSample=null)}},{key:'_createAVCSample',value:function(e,t,a,r){return{key:e,pts:t,dts:a,units:{units:[],length:0},debug:r}}},{key:'_insertSampleInOrder',value:function(e,t){var a=e.length;if(!(0<a))e.push(t);else if(t.pts>=e[a-1].pts)e.push(t);else for(var r=a-1;0<=r;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}},{key:'_getLastNalUnit',value:function(){var e,t=this.avcSample;if(!t||0===t.units.units.length){var a=this._avcTrack,r=a.samples;t=r[r.length-1]}if(t){var l=t.units.units;e=l[l.length-1]}return e}},{key:'_parseAVCNALu',value:function(e){var t,a,r,l,n,o=0,i=e.byteLength,s=this._avcTrack,d=s.naluState||0,u=d,g=[],f=-1;for(-1===d&&(f=0,n=31&e[0],d=0,o=1);o<i;){if(t=e[o++],!d){d=t?0:1;continue}if(1===d){d=t?0:2;continue}if(!t)d=3;else if(1===t){if(0<=f)r={data:e.subarray(f,o-d-1),type:n},g.push(r);else{var c=this._getLastNalUnit();if(c&&(u&&o<=4-u&&c.state&&(c.data=c.data.subarray(0,c.data.byteLength-u)),a=o-d-1,0<a)){var p=new Uint8Array(c.data.byteLength+a);p.set(c.data,0),p.set(e.subarray(0,a),c.data.byteLength),c.data=p}}o<i?(l=31&e[o],f=o,n=l,d=0):d=-1}else d=0}if(0<=f&&0<=d&&(r={data:e.subarray(f,i),type:n,state:d},g.push(r)),0===g.length){var m=this._getLastNalUnit();if(m){var y=new Uint8Array(m.data.byteLength+e.byteLength);y.set(m.data,0),y.set(e,m.data.byteLength),m.data=y}}return s.naluState=d,g}},{key:'discardEPB',value:function(e){for(var t,a,r=e.byteLength,l=[],n=1;n<r-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(l.push(n+2),n+=2):n++;if(0===l.length)return e;t=r-l.length,a=new Uint8Array(t);var i=0;for(n=0;n<t;i++,n++)i===l[0]&&(i++,l.shift()),a[n]=e[i];return a}},{key:'_parseAACPES',value:function(e){var a,r,i,o,u,g,f,c,p,m=this._audioTrack,y=e.data,v=e.pts,h=this.aacOverFlow,b=this.aacLastPTS;if(h){var _=new Uint8Array(h.byteLength+y.byteLength);_.set(h,0),_.set(y,h.byteLength),y=_}for(u=0,c=y.length;u<c-1&&(255!==y[u]||240!=(240&y[u+1]));u++);if(u){var E,L;if(u<c-1?(E='AAC PES did not start with ADTS header,offset:'+u,L=!1):(E='no ADTS header found in AAC PES',L=!0),s.logger.warn('parsing error:'+E),this.observer.trigger(n.a.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,id:this.id,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:L,reason:E}),L)return}if(!m.audiosamplerate){var k=this.audioCodec;a=l['default'].getAudioConfig(this.observer,y,u,k),m.config=a.config,m.audiosamplerate=a.samplerate,m.channelCount=a.channelCount,m.codec=a.codec,m.manifestCodec=a.manifestCodec,m.duration=this._duration,s.logger.log('parsed codec:'+m.codec+',rate:'+a.samplerate+',nb channel:'+a.channelCount)}if(o=0,i=9.216e7/m.audiosamplerate,h&&b){var A=b+i;1<Math.abs(A-v)&&(s.logger.log('AAC: align PTS for overlapping frames by '+t((A-v)/90)),v=A)}for(;u+5<c&&(g=1&y[u+1]?7:9,r=(3&y[u+3])<<11|y[u+4]<<3|(224&y[u+5])>>>5,r-=g,0<r&&u+g+r<=c);)for(f=v+o*i,p={unit:y.subarray(u+g,u+g+r),pts:f,dts:f},m.samples.push(p),m.len+=r,u+=r+g,o++;u<c-1&&(255!==y[u]||240!=(240&y[u+1]));u++);h=u<c?y.subarray(u,c):null,this.aacOverFlow=h,this.aacLastPTS=f}},{key:'_parseMPEGPES',value:function(e){for(var t,a=e.data,r=e.pts,l=a.length,i=0,n=0;n<l&&0<(t=this._parseMpeg(a,n,l,i++,r));)n+=t}},{key:'_onMpegFrame',value:function(e,t,a,r,l,i){var n=i+l*(1e3*(1152/a)),o=this._audioTrack;o.config=[],o.channelCount=r,o.audiosamplerate=a,o.duration=this._duration,o.samples.push({unit:e,pts:n,dts:n}),o.len+=e.length}},{key:'_onMpegNoise',value:function(e){s.logger.warn('mpeg audio has noise: '+e.length+' bytes')}},{key:'_parseMpeg',value:function(e,t,a,r,l){if(t+2>a)return-1;if(255===e[t]||224==(224&e[t+1])){if(t+24>a)return-1;var i=3&e[t+1]>>3,n=3&e[t+1]>>1,o=15&e[t+2]>>4,s=3&e[t+2]>>2,d=!!(2&e[t+2]);if(1!=i&&0!=o&&15!=o&&3!=s){var u=3==i?3-n:3==n?3:4,g=1e3*[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160][14*u+o-1],f=3==i?0:2==i?1:2,c=[44100,48000,32000,22050,24000,16000,11025,12000,8e3][3*f+s],p=d?1:0,m=3==e[t+3]>>6?1:2,y=3==n?(3==i?12:6)*g/c+p<<2:0|(3==i?144:72)*g/c+p;return t+y>a?-1:(this._onMpegFrame&&this._onMpegFrame(e.subarray(t,t+y),g,c,m,r,l),y)}}for(var v=t+2;v<a;){if(255===e[v-1]&&224==(224&e[v]))return this._onMpegNoise&&this._onMpegNoise(e.subarray(t,v-1)),v-t-1;v++}return-1}},{key:'_parseID3PES',value:function(e){this._id3Track.samples.push(e)}}],[{key:'probe',value:function(e){return 564<=e.length&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();t['default']=g;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(211),i=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=function(){function e(t){r(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}var t=Math.min;return i(e,[{key:'loadWord',value:function(){var e=this.data,a=this.bytesAvailable,r=e.byteLength-a,l=new Uint8Array(4),i=t(4,a);if(0===i)throw new Error('no bytes available');l.set(e.subarray(r,r+i)),this.word=new DataView(l.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}},{key:'skipBits',value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:'readBits',value:function(e){var a=t(this.bitsAvailable,e),r=this.word>>>32-a;return 32<e&&l.logger.error('Cannot read more than 32 bits at a time'),this.bitsAvailable-=a,0<this.bitsAvailable?this.word<<=a:0<this.bytesAvailable&&this.loadWord(),a=e-a,0<a&&this.bitsAvailable?r<<a|this.readBits(a):r}},{key:'skipLZ',value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:'skipUEG',value:function(){this.skipBits(1+this.skipLZ())}},{key:'skipEG',value:function(){this.skipBits(1+this.skipLZ())}},{key:'readUEG',value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:'readEG',value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:'readBoolean',value:function(){return 1===this.readBits(1)}},{key:'readUByte',value:function(){return this.readBits(8)}},{key:'readUShort',value:function(){return this.readBits(16)}},{key:'readUInt',value:function(){return this.readBits(32)}},{key:'skipScalingList',value:function(e){var t,a,r=8,l=8;for(t=0;t<e;t++)0!=l&&(a=this.readEG(),l=(r+a+256)%256),r=0==l?r:l}},{key:'readSPS',value:function(){var e,t,a,r,l,n,o,s,d,i=0,u=0,g=0,f=0,c=this.readUByte.bind(this),p=this.readBits.bind(this),m=this.readUEG.bind(this),y=this.readBoolean.bind(this),v=this.skipBits.bind(this),h=this.skipEG.bind(this),b=this.skipUEG.bind(this),_=this.skipScalingList.bind(this);if(c(),e=c(),t=p(5),v(3),a=c(),b(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var E=m();if(3===E&&v(1),b(),b(),v(1),y())for(s=3===E?12:8,d=0;d<s;d++)y()&&(6>d?_(16):_(64))}b();var L=m();if(0===L)m();else if(1===L)for(v(1),h(),h(),r=m(),d=0;d<r;d++)h();b(),v(1),l=m(),n=m(),o=p(1),0===o&&v(1),v(1),y()&&(i=m(),u=m(),g=m(),f=m());var k=[1,1];if(y()&&y()){var A=c();switch(A){case 1:k=[1,1];break;case 2:k=[12,11];break;case 3:k=[10,11];break;case 4:k=[16,11];break;case 5:k=[40,33];break;case 6:k=[24,11];break;case 7:k=[20,11];break;case 8:k=[32,11];break;case 9:k=[80,33];break;case 10:k=[18,11];break;case 11:k=[15,11];break;case 12:k=[64,33];break;case 13:k=[160,99];break;case 14:k=[4,3];break;case 15:k=[3,2];break;case 16:k=[2,1];break;case 255:{k=[c()<<8|c(),c()<<8|c()];break}}}return{width:Math.ceil(16*(l+1)-2*i-2*u),height:16*((2-o)*(n+1))-(o?2:4)*(g+f),pixelRatio:k}}},{key:'readSliceType',value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();t['default']=n;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(232),i=a(206),n=a.n(i),o=a(211),s=a(233),d=a(207),u=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var g=function(){function e(t,a,l,i){r(this,e),this.observer=t,this.id=a,this.config=l,this.typeSupported=i,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}var t=Math.abs,a=Math.round,g=Math.max,i=Math.min;return u(e,[{key:'destroy',value:function(){}},{key:'resetTimeStamp',value:function(e){this._initPTS=this._initDTS=e}},{key:'resetInitSegment',value:function(){this.ISGenerated=!1}},{key:'remux',value:function(e,t,a,r,l,i,o,s,d,u){if(this.level=e,this.sn=t,this.ISGenerated||this.generateIS(r,l,s,a),this.ISGenerated)if(r.samples.length){var g=this.remuxAudio(r,s,d,u);if(l.samples.length){var f;g&&(f=g.endPTS-g.startPTS),this.remuxVideo(l,s,d,f)}}else{var c;l.samples.length&&(c=this.remuxVideo(l,s,d)),c&&r.codec&&this.remuxEmptyAudio(r,s,d,c)}i.samples.length&&this.remuxID3(i,s),o.samples.length&&this.remuxText(o,s),this.observer.trigger(n.a.FRAG_PARSED,{id:this.id,level:this.level,sn:this.sn})}},{key:'generateIS',value:function(e,t,a,r){var l,u,g=this.observer,f=e.samples,c=t.samples,p=this.PES_TIMESCALE,m=this.typeSupported,y='audio/mp4',v={},h={id:this.id,level:this.level,sn:this.sn,tracks:v,unique:!1},b=void 0===this._initPTS;if(b&&(l=u=Infinity),e.config&&f.length){if(e.timescale=e.audiosamplerate,4294967296<e.timescale*e.duration){var _=function e(t,a){return a?e(a,t%a):t};e.timescale=e.audiosamplerate/_(e.audiosamplerate,e.isAAC?1024:1152)}o.logger.log('audio mp4 timescale :'+e.timescale),e.isAAC||(m.mpeg?(y='audio/mpeg',e.codec=''):m.mp3&&(e.codec='mp3')),v.audio={container:y,codec:e.codec,initSegment:!e.isAAC&&m.mpeg?new Uint8Array:s['default'].initSegment([e]),metadata:{channelCount:e.channelCount}},b&&(l=u=f[0].pts-p*a)}t.sps&&t.pps&&c.length&&(t.timescale=this.MP4_TIMESCALE,v.video={container:'video/mp4',codec:t.codec,initSegment:s['default'].initSegment([t]),metadata:{width:t.width,height:t.height}},b&&(l=i(l,c[0].pts-p*a),u=i(u,c[0].dts-p*a),this.observer.trigger(n.a.INIT_PTS_FOUND,{id:this.id,initPTS:l,cc:r}))),Object.keys(v).length?(g.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,h),this.ISGenerated=!0,b&&(this._initPTS=l,this._initDTS=u)):g.trigger(n.a.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,id:this.id,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:'no audio/video samples found'})}},{key:'remuxVideo',value:function(e,t,r,l){var u,f,c,p,m,y,v,h,b=8,_=this.PES_TIMESCALE,E=this.PES2MP4SCALEFACTOR,L=e.samples,k=[],A=L.length,R=this._PTSNormalize,S=this._initDTS;L.sort(function(e,t){var a=e.dts-t.dts;return a?a:e.pts-t.pts});var T=L.reduce(function(e,t){return g(i(e,t.pts-t.dts),-18000)},0);if(0>T){o.logger.warn('PTS < DTS detected in video samples, shifting DTS by '+a(T/90)+' ms to overcome this issue');for(var D=0;D<L.length;D++)L[D].dts+=T}var x=r?this.nextAvcDts:t*_;var C=L[0];m=g(R(C.dts-S,x),0),p=g(R(C.pts-S,x),0);var P=a((m-x)/90);r&&P&&(1<P?o.logger.log('AVC:'+P+' ms hole between fragments detected,filling it'):-1>P&&o.logger.log('AVC:'+-P+' ms overlapping between fragments detected'),m=x,L[0].dts=m+S,p=g(p-P,x),L[0].pts=p+S,o.logger.log('Video/PTS/DTS adjusted: '+a(p/90)+'/'+a(m/90)+',delta:'+P+' ms')),y=m,C=L[L.length-1],h=g(R(C.dts-S,x),0),v=g(R(C.pts-S,x),0),v=g(v,h);var O=navigator.vendor,I=navigator.userAgent,F=O&&-1<O.indexOf('Apple')&&I&&!I.match('CriOS');F&&(u=a((h-m)/(E*(L.length-1))));for(var w=0,N=0,B=0;B<A;B++){for(var M=L[B],G=M.units.units,U=G.length,W=0,V=0;V<U;V++)W+=G[V].data.length;N+=W,w+=U,M.length=W,F?M.dts=m+B*E*u:(M.dts=g(R(M.dts-S,x),m),M.dts=a(M.dts/E)*E),M.pts=g(R(M.pts-S,x),M.dts),M.pts=a(M.pts/E)*E}var H=N+4*w+8;try{f=new Uint8Array(H)}catch(e){return void this.observer.trigger(n.a.ERROR,{type:d.ErrorTypes.MUX_ERROR,level:this.level,id:this.id,details:d.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:H,reason:'fail allocating video mdat '+H})}var K=new DataView(f.buffer);K.setUint32(0,H),f.set(s['default'].types.mdat,4);for(var j=0;j<A;j++){for(var q=L[j],z=q.units.units,Y=0,Q=void 0,X=0,Z=z.length;X<Z;X++){var $=z[X],J=$.data,ee=$.data.byteLength;K.setUint32(b,ee),b+=4,f.set(J,b),b+=ee,Y+=4+ee}if(!F){if(j<A-1)u=L[j+1].dts-q.dts;else{var te=this.config,ae=q.dts-L[0<j?j-1:j].dts;if(te.stretchShortVideoTrack){var re=te.maxBufferHole,le=te.maxSeekHole,ie=Math.floor(i(re,le)*_),ne=(l?p+l*_:this.nextAudioPts)-q.pts;ne>ie?(u=ne-ae,0>u&&(u=ae),o.logger.log('It is approximately '+ne/90+' ms to the next segment; using duration '+u/90+' ms for the last video frame.')):u=ae}else u=ae}u/=E,Q=a((q.pts-q.dts)/E)}else Q=g(0,u*a((q.pts-q.dts)/(E*u)));k.push({size:Y,duration:u,cts:Q,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:q.key?2:1,isNonSync:q.key?0:1}})}this.nextAvcDts=h+u*E;var oe=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,k.length&&-1<navigator.userAgent.toLowerCase().indexOf('chrome')){var se=k[0].flags;se.dependsOn=2,se.isNonSync=0}e.samples=k,c=s['default'].moof(e.sequenceNumber++,m/E,e),e.samples=[];var de={id:this.id,level:this.level,sn:this.sn,data1:c,data2:f,startPTS:p/_,endPTS:(v+E*u)/_,startDTS:m/_,endDTS:this.nextAvcDts/_,type:'video',nb:k.length,dropped:oe};return this.observer.trigger(n.a.FRAG_PARSING_DATA,de),de}},{key:'remuxAudio',value:function(e,r,u,f){var c,p,m,y,v,h,b,_,E,L,k,A,R,S,T,D,x=this.PES_TIMESCALE,C=e.timescale,P=x/C,O=e.timescale*(e.isAAC?1024:1152)/e.audiosamplerate,I=O*P,F=this._PTSNormalize,w=this._initDTS,N=!e.isAAC&&this.typeSupported.mpeg,B=N?0:8,M=[],G=[];if(e.samples.sort(function(e,t){return e.pts-t.pts}),G=e.samples,D=this.nextAudioPts,u|=G.length&&D&&(0.1>t(r-D/x)||t(G[0].pts-D-this._initDTS)<20*I),u||(D=r*x),f&&e.isAAC)for(var U=0,i=D;U<G.length;){var W=G[U],V=F(W.pts-w,D),H=V-i;if(H<=-I)o.logger.warn('Dropping 1 audio frame @ '+a(i/90)/1e3+'s due to '+a(t(H/90))+' ms overlap.'),G.splice(U,1),e.len-=W.unit.length;else if(H>=I&&i){var K=a(H/I);o.logger.warn('Injecting '+K+' audio frame @ '+a(i/90)/1e3+'s due to '+a(H/90)+' ms gap.');for(var q=0;q<K;q++)T=i+w,T=g(T,w),S=l['default'].getSilentFrame(e.manifestCodec||e.codec,e.channelCount),S||(o.logger.log('Unable to get silent frame for given audio codec; duplicating last frame instead.'),S=W.unit.subarray()),G.splice(U,0,{unit:S,pts:T,dts:T}),e.len+=S.length,i+=I,U+=1;W.pts=W.dts=i+w,i+=I,U+=1}else t(H)>0.1*I,i+=I,W.pts=0==U?W.dts=w+D:W.dts=G[U-1].pts+I,U+=1}for(var j=0,z=G.length;j<z;j++){if(p=G[j],y=p.unit,L=p.pts-w,k=p.dts-w,void 0!=E)A=F(L,E),R=F(k,E),m.duration=a((R-E)/P);else{A=F(L,D),R=F(k,D);var Y=a(1e3*(A-D)/x),Q=0;if(u&&e.isAAC&&Y){if(0<Y)Q=a((A-D)/I),o.logger.log(Y+' ms hole between AAC samples detected,filling it'),0<Q&&(S=l['default'].getSilentFrame(e.manifestCodec||e.codec,e.channelCount),!S&&(S=y.subarray()),e.len+=Q*S.length);else if(-12>Y){o.logger.log(-Y+' ms overlapping between AAC samples detected, drop frame'),e.len-=y.byteLength;continue}A=R=D}if(b=g(0,A),_=g(0,R),0<e.len){var X=N?e.len:e.len+8;try{v=new Uint8Array(X)}catch(e){return void this.observer.trigger(n.a.ERROR,{type:d.ErrorTypes.MUX_ERROR,level:this.level,id:this.id,details:d.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:X,reason:'fail allocating audio mdat '+X})}N||(c=new DataView(v.buffer),c.setUint32(0,X),v.set(s['default'].types.mdat,4))}else return;for(var Z=0;Z<Q;Z++)T=A-(Q-Z)*I,S=l['default'].getSilentFrame(e.manifestCodec||e.codec,e.channelCount),S||(o.logger.log('Unable to get silent frame for given audio codec; duplicating this frame instead.'),S=y.subarray()),v.set(S,B),B+=S.byteLength,m={size:S.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},M.push(m)}v.set(y,B);var $=y.byteLength;B+=$,m={size:$,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},M.push(m),E=R}var J=0,ee=M.length;if(2<=ee&&(J=M[ee-2].duration,m.duration=J),ee){this.nextAudioPts=A+P*J,e.len=0,e.samples=M,h=N?new Uint8Array:s['default'].moof(e.sequenceNumber++,_/P,e),e.samples=[];var te={id:this.id,level:this.level,sn:this.sn,data1:h,data2:v,startPTS:b/x,endPTS:this.nextAudioPts/x,startDTS:_/x,endDTS:(R+P*J)/x,type:'audio',nb:ee};return this.observer.trigger(n.a.FRAG_PARSING_DATA,te),te}return null}},{key:'remuxEmptyAudio',value:function(e,t,a,r){var n=this.PES_TIMESCALE,s=e.timescale?e.timescale:e.audiosamplerate,d=this.nextAudioPts,u=(void 0===d?r.startDTS*n:d)+this._initDTS,g=r.endDTS*n+this._initDTS,f=n/s*1024,c=Math.ceil((g-u)/f),p=l['default'].getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.logger.warn('remux empty Audio'),!p)return void o.logger.trace('Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!');for(var m,y=[],v=0;v<c;v++)m=u+v*f,y.push({unit:p,pts:m,dts:m}),e.len+=p.length;e.samples=y,this.remuxAudio(e,t,a)}},{key:'remuxID3',value:function(e,t){var a,r=e.samples.length;if(r){for(var l=0;l<r;l++)a=e.samples[l],a.pts=(a.pts-this._initPTS)/this.PES_TIMESCALE,a.dts=(a.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(n.a.FRAG_PARSING_METADATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:'remuxText',value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var a,r=e.samples.length;if(r){for(var l=0;l<r;l++)a=e.samples[l],a.pts=(a.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(n.a.FRAG_PARSING_USERDATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:'_PTSNormalize',value:function(e,a){var r;if(void 0===a)return e;for(r=a<e?-8589934592:8589934592;4294967296<t(e-a);)e+=r;return e}}]),e}();t['default']=g;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(){r(this,e)}return l(e,null,[{key:'getSilentFrame',value:function(e,t){switch(e){case'mp4a.40.2':if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);}return null}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(){r(this,e)}return l(e,null,[{key:'init',value:function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};for(var t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var a=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:a,audio:r};var l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=i,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var n=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,n,s,n,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,l))}},{key:'box',value:function(e){for(var t,a=Array.prototype.slice.call(arguments,1),r=8,l=a.length,i=l;l--;)r+=a[l].byteLength;for(t=new Uint8Array(r),t[0]=255&r>>24,t[1]=255&r>>16,t[2]=255&r>>8,t[3]=255&r,t.set(e,4),(l=0,r=8);l<i;l++)t.set(a[l],r),r+=a[l].byteLength;return t}},{key:'hdlr',value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:'mdat',value:function(t){return e.box(e.types.mdat,t)}},{key:'mdhd',value:function(t,a){return a*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,255&t>>24,255&t>>16,255&t>>8,255&t,a>>24,255&a>>16,255&a>>8,255&a,85,196,0,0]))}},{key:'mdia',value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:'mfhd',value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,255&t>>16,255&t>>8,255&t]))}},{key:'minf',value:function(t){return'audio'===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:'moof',value:function(t,a,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,a))}},{key:'moov',value:function(t){for(var a=t.length,r=[];a--;)r[a]=e.trak(t[a]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))}},{key:'mvex',value:function(t){for(var a=t.length,r=[];a--;)r[a]=e.trex(t[a]);return e.box.apply(null,[e.types.mvex].concat(r))}},{key:'mvhd',value:function(t,a){a*=t;var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,255&t>>24,255&t>>16,255&t>>8,255&t,255&a>>24,255&a>>16,255&a>>8,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,r)}},{key:'sdtp',value:function(t){var a,r,l=t.samples||[],i=new Uint8Array(4+l.length);for(r=0;r<l.length;r++)a=l[r].flags,i[r+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return e.box(e.types.sdtp,i)}},{key:'stbl',value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:'avc1',value:function(t){var a,r,l,i=[],n=[];for(a=0;a<t.sps.length;a++)r=t.sps[a],l=r.byteLength,i.push(255&l>>>8),i.push(255&l),i=i.concat(Array.prototype.slice.call(r));for(a=0;a<t.pps.length;a++)r=t.pps[a],l=r.byteLength,n.push(255&l>>>8),n.push(255&l),n=n.concat(Array.prototype.slice.call(r));var o=e.box(e.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(n))),s=t.width,d=t.height,u=t.pixelRatio[0],g=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255&s>>8,255&s,255&d>>8,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,255&u>>16,255&u>>8,255&u,g>>24,255&g>>16,255&g>>8,255&g])))}},{key:'esds',value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:'mp4a',value:function(t){var a=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,255&a>>8,255&a,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:'mp3',value:function(t){var a=t.audiosamplerate;return e.box(e.types['.mp3'],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,255&a>>8,255&a,0,0]))}},{key:'stsd',value:function(t){return'audio'===t.type?t.isAAC||'mp3'!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:'tkhd',value:function(t){var a=t.id,r=t.duration*t.timescale,l=t.width,i=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,255&a>>24,255&a>>16,255&a>>8,255&a,0,0,0,0,r>>24,255&r>>16,255&r>>8,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,255&l>>8,255&l,0,0,255&i>>8,255&i,0,0]))}},{key:'traf',value:function(t,a){var r=e.sdtp(t),l=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,l>>24,255&l>>16,255&l>>8,255&l])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,a>>24,255&a>>16,255&a>>8,255&a])),e.trun(t,r.length+16+16+8+16+8+8),r)}},{key:'trak',value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:'trex',value:function(t){var a=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,a>>24,255&a>>16,255&a>>8,255&a,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:'trun',value:function(t,a){var r,l,i,n,o,s,d=t.samples||[],u=d.length,g=12+16*u,f=new Uint8Array(g);for(a+=8+g,f.set([0,0,15,1,255&u>>>24,255&u>>>16,255&u>>>8,255&u,255&a>>>24,255&a>>>16,255&a>>>8,255&a],0),r=0;r<u;r++)l=d[r],i=l.duration,n=l.size,o=l.flags,s=l.cts,f.set([255&i>>>24,255&i>>>16,255&i>>>8,255&i,255&n>>>24,255&n>>>16,255&n>>>8,255&n,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,255&s>>>24,255&s>>>16,255&s>>>8,255&s],12+16*r);return e.box(e.types.trun,f)}},{key:'initSegment',value:function(t){e.types||e.init();var a,r=e.moov(t);return a=new Uint8Array(e.FTYP.byteLength+r.byteLength),a.set(e.FTYP),a.set(r,e.FTYP.byteLength),a}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(206),i=a.n(l),n=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var o=function(){function e(t,a){r(this,e),this.observer=t,this.id=a}return n(e,[{key:'destroy',value:function(){}},{key:'resetTimeStamp',value:function(){}},{key:'resetInitSegment',value:function(){}},{key:'remux',value:function(e,t,a,r,l,n,o,s,d,u,g){var f=this.observer,c='';r&&(c+='audio'),l&&(c+='video'),f.trigger(i.a.FRAG_PARSING_DATA,{id:this.id,level:e,sn:t,data1:g,startPTS:s,startDTS:s,type:c,nb:1,dropped:0}),f.trigger(i.a.FRAG_PARSED,{id:this.id,level:e,sn:t})}}]),e}();t['default']=o;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var r=a(220),l=a(206),i=a.n(l),n=a(211),o=a(236),s=a.n(o);t['default']=function(e){var t=new s.a;t.trigger=function(e){for(var a=arguments.length,r=Array(1<a?a-1:0),l=1;l<a;l++)r[l-1]=arguments[l];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var a=arguments.length,r=Array(1<a?a-1:0),l=1;l<a;l++)r[l-1]=arguments[l];t.removeListener.apply(t,[e].concat(r))};var a=function(t,a){e.postMessage({event:t,data:a})};e.addEventListener('message',function(l){var i=l.data;switch(i.cmd){case'init':var o=JSON.parse(i.config);e.demuxer=new r['default'](t,i.id,i.typeSupported,o);try{Object(n.enableLogs)(!0===o.debug)}catch(e){console.warn('demuxerWorker: unable to enable logs')}a('init',null);break;case'demux':e.demuxer.push(i.data,i.initSegment,i.audioCodec,i.videoCodec,i.timeOffset,i.cc,i.level,i.sn,i.duration,i.decryptdata,i.accurateTimeOffset,i.defaultInitPTS);break;default:}}),t.on(i.a.FRAG_DECRYPTED,a),t.on(i.a.FRAG_PARSING_INIT_SEGMENT,a),t.on(i.a.FRAG_PARSED,a),t.on(i.a.ERROR,a),t.on(i.a.FRAG_PARSING_METADATA,a),t.on(i.a.FRAG_PARSING_USERDATA,a),t.on(i.a.INIT_PTS_FOUND,a),t.on(i.a.FRAG_PARSING_DATA,function(t,a){var r=[],l={event:t,data:a};a.data1&&(l.data1=a.data1.buffer,r.push(a.data1.buffer),delete a.data1),a.data2&&(l.data2=a.data2.buffer,r.push(a.data2.buffer),delete a.data2),e.postMessage(l,r)})};window.__NEWLINE__=1},function(e){function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}e.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(e){if(!r(e)||0>e||isNaN(e))throw TypeError('n must be a positive number');return this._maxListeners=e,this},t.prototype.emit=function(e){var t,r,o,s,d,i;if(this._events||(this._events={}),'error'===e&&(!this._events.error||l(this._events.error)&&!this._events.error.length))if(t=arguments[1],t instanceof Error)throw t;else{var u=new Error('Uncaught, unspecified "error" event. ('+t+')');throw u.context=t,u}if(r=this._events[e],n(r))return!1;if(a(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s);}else if(l(r))for(s=Array.prototype.slice.call(arguments,1),i=r.slice(),o=i.length,d=0;d<o;d++)i[d].apply(this,s);return!0},t.prototype.addListener=function(e,r){var i;if(!a(r))throw TypeError('listener must be a function');return this._events||(this._events={}),this._events.newListener&&this.emit('newListener',e,a(r.listener)?r.listener:r),this._events[e]?l(this._events[e])?this._events[e].push(r):this._events[e]=[this._events[e],r]:this._events[e]=r,l(this._events[e])&&!this._events[e].warned&&(i=n(this._maxListeners)?t.defaultMaxListeners:this._maxListeners,i&&0<i&&this._events[e].length>i&&(this._events[e].warned=!0,console.error('(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.',this._events[e].length),'function'==typeof console.trace&&console.trace())),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(e,t){function r(){this.removeListener(e,r),l||(l=!0,t.apply(this,arguments))}if(!a(t))throw TypeError('listener must be a function');var l=!1;return r.listener=t,this.on(e,r),this},t.prototype.removeListener=function(e,t){var r,n,o,s;if(!a(t))throw TypeError('listener must be a function');if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,n=-1,r===t||a(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit('removeListener',e,t);else if(l(r)){for(s=o;0<s--;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit('removeListener',e,t)}return this},t.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)'removeListener'!==t&&this.removeAllListeners(t);return this.removeAllListeners('removeListener'),this._events={},this}if(r=this._events[e],a(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},t.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[],t},t.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(a(t))return 1;if(t)return t.length}return 0},t.listenerCount=function(e,t){return e.listenerCount(t)};function a(e){return'function'==typeof e}function r(e){return'number'==typeof e}function l(e){return'object'==typeof e&&null!==e}function n(e){return void 0===e}window.__NEWLINE__=1},function(e){var t=arguments[3],a=arguments[4],r=arguments[5],n=JSON.stringify;e.exports=function(e,o){function s(e){for(var t in v[e]=!0,a[e][1]){var r=a[e][1][t];v[r]||s(r)}}for(var d,u=Math.floor,g=Object.keys(r),f=0,i=g.length;f<i;f++){var l=g[f],c=r[l].exports;if(c===e||c&&c.default===e){d=l;break}}if(!d){d=u(4294967296*Math.random()).toString(16);for(var l,p={},f=0,i=g.length;f<i;f++)l=g[f],p[l]=l;a[d]=['function(require,module,exports){'+e+'(self); }',p]}var m=u(4294967296*Math.random()).toString(16),y={};y[d]=d,a[m]=['function(require,module,exports){var f = require('+n(d)+');(f.default ? f.default : f)(self);}',y];var v={};s(m);var h='('+t+')({'+Object.keys(v).map(function(e){return n(e)+':['+a[e][0]+','+n(a[e][1])+']'}).join(',')+'},{},['+n(m)+'])',b=window.URL||window.webkitURL||window.mozURL||window.msURL,_=new Blob([h],{type:'text/javascript'});if(o&&o.bare)return _;var E=b.createObjectURL(_),L=new Worker(E);return L.objectURL=E,L};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(211),i=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=function(){function e(){r(this,e)}var t=Math.min,a=Math.max;return i(e,null,[{key:'mergeDetails',value:function(r,n){var o,s=a(r.startSN,n.startSN)-n.startSN,d=t(r.endSN,n.endSN)-n.startSN,u=n.startSN-r.startSN,g=r.fragments,f=n.fragments,c=0;if(d<s)return void(n.PTSKnown=!1);for(var p=s;p<=d;p++){var i=g[u+p],m=f[p];m&&i&&(c=i.cc-m.cc,!isNaN(i.startPTS)&&(m.start=m.startPTS=i.startPTS,m.endPTS=i.endPTS,m.duration=i.duration,o=m))}if(c)for(l.logger.log('discontinuity sliding from playlist, take drift into account'),p=0;p<f.length;p++)f[p].cc+=c;if(o)e.updateFragPTSDTS(n,o.sn,o.startPTS,o.endPTS,o.startDTS,o.endDTS);else if(0<=u&&u<g.length){var y=g[u].start;for(p=0;p<f.length;p++)f[p].start+=y}n.PTSKnown=r.PTSKnown}},{key:'updateFragPTSDTS',value:function(r,l,n,o,s,d){var u,g,f,c;if(!r||l<r.startSN||l>r.endSN)return 0;if(u=l-r.startSN,g=r.fragments,f=g[u],!isNaN(f.startPTS)){var i=Math.abs(f.startPTS-n);f.deltaPTS=isNaN(f.deltaPTS)?i:a(i,f.deltaPTS),n=t(n,f.startPTS),o=a(o,f.endPTS),s=t(s,f.startDTS),d=a(d,f.endDTS)}var p=n-f.start;for(f.start=f.startPTS=n,f.endPTS=o,f.startDTS=s,f.endDTS=d,f.duration=o-n,c=u;0<c;c--)e.updatePTS(g,c,c-1);for(c=u;c<g.length-1;c++)e.updatePTS(g,c,c+1);return r.PTSKnown=!0,p}},{key:'updatePTS',value:function(e,t,a){var r=e[t],i=e[a],n=i.startPTS;isNaN(n)?a>t?i.start=r.start+r.duration:i.start=r.start-i.duration:a>t?(r.duration=n-r.start,0>r.duration&&l.logger.warn('negative duration computed for frag '+r.sn+',level '+r.level+', there should be some duration drift between playlist and fragment!')):(i.duration=r.start-n,0>i.duration&&l.logger.warn('negative duration computed for frag '+i.sn+',level '+i.level+', there should be some duration drift between playlist and fragment!'))}}]),e}();t['default']=n;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(){r(this,e)}return l(e,null,[{key:'toString',value:function(e){for(var t='',a=e.length,r=0;r<a;r++)t+='['+e.start(r).toFixed(3)+','+e.end(r).toFixed(3)+']';return t}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(206),o=a.n(n),s=a(210),d=a(211),u=a(207),g=a(218),f=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o.a.MANIFEST_LOADED,o.a.LEVEL_LOADED,o.a.FRAG_LOADED,o.a.ERROR));return a.ontick=a.tick.bind(a),a._manualLevel=a._autoLevelCapping=-1,a}var a=Math.max;return i(t,e),f(t,[{key:'destroy',value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:'startLoad',value:function(){this.canload=!0;var e=this._levels;e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),this.timer&&this.tick()}},{key:'stopLoad',value:function(){this.canload=!1}},{key:'onManifestLoaded',value:function(e){var t,a=[],r=[],l={},n=!1,s=!1,g=this.hls,f=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),c=function(e,t){return MediaSource.isTypeSupported(e+'/mp4;codecs='+t)};if(e.levels.forEach(function(e){e.videoCodec&&(n=!0),f&&e.audioCodec&&-1!==e.audioCodec.indexOf('mp4a.40.34')&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(s=!0);var t=l[e.bitrate];void 0===t?(l[e.bitrate]=a.length,e.url=[e.url],e.urlId=0,a.push(e)):a[t].url.push(e.url)}),n&&s?a.forEach(function(e){e.videoCodec&&r.push(e)}):r=a,r=r.filter(function(e){var t=e.audioCodec,a=e.videoCodec;return(!t||c('audio',t))&&(!a||c('video',a))}),r.length){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var p=0;p<r.length;p++)if(r[p].bitrate===t){this._firstLevel=p,d.logger.log('manifest loaded,'+r.length+' level(s) found, first bitrate:'+t);break}g.trigger(o.a.MANIFEST_PARSED,{levels:r,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:n,altAudio:0<e.audioTracks.length})}else g.trigger(o.a.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:g.url,reason:'no level with compatible codecs found in manifest'})}},{key:'setLevelInternal',value:function(e){var t=this._levels;if(0<=e&&e<t.length){if(this.timer&&(clearTimeout(this.timer),this.timer=null),this._level!==e){d.logger.log('switching to level '+e),this._level=e;var a=t[e];a.level=e,this.hls.trigger(o.a.LEVEL_SWITCH,a)}var r=t[e],l=r.details;if(!l||!0===l.live){var i=r.urlId;this.hls.trigger(o.a.LEVEL_LOADING,{url:r.url[i],level:e,id:i})}}else this.hls.trigger(o.a.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:'invalid level idx'})}},{key:'onError',value:function(e){if(!e.fatal){var t,r,l=e.details,i=this.hls,n=!1,s=i.abrController,f=s.minAutoLevel;switch(l){case u.ErrorDetails.FRAG_LOAD_ERROR:case u.ErrorDetails.FRAG_LOAD_TIMEOUT:case u.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case u.ErrorDetails.KEY_LOAD_ERROR:case u.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level;break;case u.ErrorDetails.LEVEL_LOAD_ERROR:case u.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,n=!0;break;case u.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level;break;default:}if(void 0!==t){r=this._levels[t],r.loadError?r.loadError++:r.loadError=1;var c=r.url.length;if(1<c&&r.loadError<c)r.urlId=(r.urlId+1)%c,r.details=void 0,d.logger.warn('level controller,'+l+' for level '+t+': switching to redundant stream id '+r.urlId);else{var p=-1===this._manualLevel&&t;if(p)d.logger.warn('level controller,'+l+': switch-down for next fragment'),s.nextAutoLevel=a(f,t-1);else if(r&&r.details&&r.details.live)d.logger.warn('level controller,'+l+' on live stream, discard'),n&&(this._level=void 0);else if(l===u.ErrorDetails.LEVEL_LOAD_ERROR||l===u.ErrorDetails.LEVEL_LOAD_TIMEOUT){var m=i.media,y=m&&g['default'].isBuffered(m,m.currentTime)&&g['default'].isBuffered(m,m.currentTime+0.5);if(y){var v=i.config.levelLoadingRetryDelay;d.logger.warn('level controller,'+l+', but media buffered, retry in '+v+'ms'),this.timer=setTimeout(this.ontick,v)}else d.logger.error('cannot recover '+l+' error'),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),e.fatal=!0,i.trigger(o.a.ERROR,e)}}}}}},{key:'onFragLoaded',value:function(e){var t=e.frag;if(t&&'main'===t.type){var a=this._levels[t.level];a&&(a.loadError=0)}}},{key:'onLevelLoaded',value:function(e){var t=e.level;if(t===this._level){var r=this._levels[t];r.loadError=0;var l=e.details;if(l.live){var i=1e3*(l.averagetargetduration?l.averagetargetduration:l.targetduration),n=r.details;n&&l.endSN===n.endSN&&(i/=2,d.logger.log('same live playlist, reload twice faster')),i-=performance.now()-e.stats.trequest,i=a(1e3,Math.round(i)),d.logger.log('live playlist, reload in '+i+' ms'),this.timer=setTimeout(this.ontick,i)}else this.timer=null}}},{key:'tick',value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e],a=t.urlId;this.hls.trigger(o.a.LEVEL_LOADING,{url:t.url[a],level:e,id:a})}}},{key:'levels',get:function(){return this._levels}},{key:'level',get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level!==e||void 0===t[e].details)&&this.setLevelInternal(e)}},{key:'manualLevel',get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:'firstLevel',get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:'startLevel',get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0===e?this._firstLevel:e}return this._startLevel},set:function(e){-1!==e&&(e=a(e,this.hls.abrController.minAutoLevel)),this._startLevel=e}},{key:'nextLoadLevel',get:function(){return-1===this._manualLevel?this.hls.abrController.nextAutoLevel:this._manualLevel},set:function(e){this.level=e,-1===this._manualLevel&&(this.hls.abrController.nextAutoLevel=e)}}]),t}(s['default']);t['default']=c;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'hlsDefaultConfig',function(){return s});var r=a(242),l=a(245),i=a(246),n=a(247),o=a(214);var s={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:0.5,maxSeekHole:2,lowBufferWatchdogPeriod:0.5,highBufferWatchdogPeriod:3,nudgeOffset:0.1,nudgeMaxRetry:3,maxFragLookUpTolerance:0.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64000,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64000,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64000,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:0.2,appendErrorMaxRetry:3,loader:o['default'],fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:r['default'],bufferController:l['default'],capLevelController:i['default'],fpsController:n['default'],stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:0.95,abrBandWidthUpFactor:0.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(206),o=a.n(n),s=a(210),d=a(218),u=a(207),g=a(211),f=a(243),c=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o.a.FRAG_LOADING,o.a.FRAG_LOADED,o.a.FRAG_BUFFERED,o.a.ERROR));return a.lastLoadedFragLevel=0,a._autoLevelCapping=-1,a._nextAutoLevel=-1,a.hls=e,a.onCheck=a.abandonRulesCheck.bind(a),a}var a=Math.min,n=Math.round,p=Math.max,m=Math.abs;return i(t,e),c(t,[{key:'destroy',value:function(){this.clearTimer(),s['default'].prototype.destroy.call(this)}},{key:'onFragLoading',value:function(e){var t=e.frag;if('main'===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this.bwEstimator){var a,r,l=this.hls,i=e.frag.level,n=l.levels[i].details.live,o=l.config;n?(a=o.abrEwmaFastLive,r=o.abrEwmaSlowLive):(a=o.abrEwmaFastVoD,r=o.abrEwmaSlowVoD),this.bwEstimator=new f['default'](l,r,a,o.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:'abandonRulesCheck',value:function(){var e=this.hls,t=e.media,a=this.fragCurrent,r=a.loader,l=this.minAutoLevel;if(!r||r.stats&&r.stats.aborted)return g.logger.warn('frag loader destroy or aborted, disarm abandonRules'),void this.clearTimer();var i=r.stats;if(t&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&a.autoLevel&&a.level){var s=performance.now()-i.trequest,u=m(t.playbackRate);if(s>500*a.duration/u){var f=e.levels,c=p(1,i.bw?i.bw/8:1e3*i.loaded/s),y=f[a.level],v=y.realBitrate?p(y.realBitrate,y.bitrate):y.bitrate,h=i.total?i.total:p(i.loaded,n(a.duration*v/8)),b=t.currentTime,_=(h-i.loaded)/c,E=(d['default'].bufferInfo(t,b,e.config.maxBufferHole).end-b)/u;if(E<2*a.duration/u&&_>E){var L,k;for(k=a.level-1;k>l;k--){var A=f[k].realBitrate?p(f[k].realBitrate,f[k].bitrate):f[k].bitrate;if(L=a.duration*A/(8*0.8*c),L<E)break}L<_&&(g.logger.warn('loading too slow, abort fragment loading and switch to level '+k+':fragLoadedDelay['+k+']<fragLoadedDelay['+(a.level-1)+'];bufferStarvationDelay:'+L.toFixed(1)+'<'+_.toFixed(1)+':'+E.toFixed(1)),e.nextLoadLevel=k,this.bwEstimator.sample(s,i.loaded),r.abort(),this.clearTimer(),e.trigger(o.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:a,stats:i}))}}}}},{key:'onFragLoaded',value:function(e){var t=e.frag;if('main'===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=this.hls.levels[t.level],r=(a.loaded?a.loaded.bytes:0)+e.stats.loaded,l=(a.loaded?a.loaded.duration:0)+e.frag.duration;a.loaded={bytes:r,duration:l},a.realBitrate=n(8*r/l)}if(e.frag.bitrateTest){var i=e.stats;i.tparsed=i.tbuffered=i.tload,this.onFragBuffered(e)}}}},{key:'onFragBuffered',value:function(e){var t=e.stats,a=e.frag;if(!0!==t.aborted&&1===a.loadCounter&&'main'===a.type&&!isNaN(a.sn)&&(!a.bitrateTest||t.tload===t.tbuffered)){var r=t.tparsed-t.trequest;g.logger.log('latency/loading/parsing/append/kbps:'+n(t.tfirst-t.trequest)+'/'+n(t.tload-t.tfirst)+'/'+n(t.tparsed-t.tload)+'/'+n(t.tbuffered-t.tparsed)+'/'+n(8*t.loaded/(t.tbuffered-t.trequest))),this.bwEstimator.sample(r,t.loaded),this.bitrateTestDelay=a.bitrateTest?r/1e3:0}}},{key:'onError',value:function(e){switch(e.details){case u.ErrorDetails.FRAG_LOAD_ERROR:case u.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break;default:}}},{key:'clearTimer',value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:'findBestLevel',value:function(e,t,a,r,l,o,s,d,u){for(var f=l;f>=r;f--){var i=u[f],c=i.details,m=c?c.totalduration/c.fragments.length:t,y=!!c&&c.live,v=void 0;v=f<=e?s*a:d*a;var h=u[f].realBitrate?p(u[f].realBitrate,u[f].bitrate):u[f].bitrate,b=h*m/v;if(g.logger.trace('level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: '+f+'/'+n(v)+'/'+h+'/'+m+'/'+o+'/'+b),v>h&&(!b||y||b<o))return f}return-1}},{key:'autoLevelCapping',get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:'nextAutoLevel',get:function(){var e=this._nextAutoLevel,t=this.bwEstimator,r=this.hls,l=r.levels,i=r.config.minAutoBitrate;if(-1!==e&&(!t||!t.canEstimate()))return a(e,this.maxAutoLevel);var n=this.nextABRAutoLevel;if(-1!==e&&(n=a(e,n)),void 0!==i)for(var o=l[n].realBitrate?p(l[n].realBitrate,l[n].bitrate):l[n].bitrate;o<i;)n++;return n},set:function(e){this._nextAutoLevel=e}},{key:'minAutoLevel',get:function(){for(var e,t=this.hls,a=t.levels,r=t.config.minAutoBitrate,l=a?a.length:0,n=0;n<l;n++)if(e=a[n].realBitrate?p(a[n].realBitrate,a[n].bitrate):a[n].bitrate,e>r)return n;return 0}},{key:'maxAutoLevel',get:function(){var e,t=this.hls.levels,a=this._autoLevelCapping;return e=-1===a&&t&&t.length?t.length-1:a,e}},{key:'nextABRAutoLevel',get:function(){var e=this.hls,t=this.maxAutoLevel,r=e.levels,l=e.config,i=this.minAutoLevel,o=e.media,s=this.lastLoadedFragLevel,u=this.fragCurrent?this.fragCurrent.duration:0,f=o?o.currentTime:0,c=o&&0!==o.playbackRate?m(o.playbackRate):1,y=this.bwEstimator?this.bwEstimator.getEstimate():l.abrEwmaDefaultEstimate,v=(d['default'].bufferInfo(o,f,l.maxBufferHole).end-f)/c,h=this.findBestLevel(s,u,y,i,t,v,l.abrBandWidthFactor,l.abrBandWidthUpFactor,r);if(0<=h)return h;g.logger.trace('rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering');var b=u?a(u,l.maxStarvationDelay):l.maxStarvationDelay,_=l.abrBandWidthFactor,E=l.abrBandWidthUpFactor;if(0==v){var L=this.bitrateTestDelay;if(L){var k=u?a(u,l.maxLoadingDelay):l.maxLoadingDelay;b=k-L,g.logger.trace('bitrate test took '+n(1e3*L)+'ms, set first fragment max fetchDuration to '+n(1e3*b)+' ms'),_=E=1}}return h=this.findBestLevel(s,u,y,i,t,v+b,_,E,r),p(h,0)}}]),t}(s['default']);t['default']=p;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=a(244),i=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var n=function(){function e(t,a,i,n){r(this,e),this.hls=t,this.defaultEstimate_=n,this.minWeight_=1e-3,this.minDelayMs_=50,this.slow_=new l['default'](a),this.fast_=new l['default'](i)}return i(e,[{key:'sample',value:function(e,t){e=Math.max(e,this.minDelayMs_);var a=8e3*t/e,r=e/1e3;this.fast_.sample(r,a),this.slow_.sample(r,a)}},{key:'canEstimate',value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:'getEstimate',value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:'destroy',value:function(){}}]),e}();t['default']=n;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(t){r(this,e),this.alpha_=t?Math.exp(-0.6931471805599453/t):0,this.estimate_=0,this.totalWeight_=0}var t=Math.pow;return l(e,[{key:'sample',value:function(e,a){var r=t(this.alpha_,e);this.estimate_=a*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:'getTotalWeight',value:function(){return this.totalWeight_}},{key:'getEstimate',value:function(){if(this.alpha_){var e=1-t(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(206),o=a.n(n),s=a(210),d=a(211),u=a(207),g=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o.a.MEDIA_ATTACHING,o.a.MEDIA_DETACHING,o.a.MANIFEST_PARSED,o.a.BUFFER_RESET,o.a.BUFFER_APPENDING,o.a.BUFFER_CODECS,o.a.BUFFER_EOS,o.a.BUFFER_FLUSHING,o.a.LEVEL_PTS_UPDATED,o.a.LEVEL_UPDATED));return a._msDuration=null,a._levelDuration=null,a.onsbue=a.onSBUpdateEnd.bind(a),a.onsbe=a.onSBUpdateError.bind(a),a.pendingTracks={},a.tracks={},a}return i(t,e),g(t,[{key:'destroy',value:function(){s['default'].prototype.destroy.call(this)}},{key:'onLevelPtsUpdated',value:function(e){var t=e.type,a=this.tracks.audio;if('audio'===t&&a&&'audio/mpeg'===a.container){var r=this.sourceBuffer.audio,l=Math.abs(r.timestampOffset-e.start);if(0.1<l){var i=r.updating;try{r.abort()}catch(e){i=!0,d.logger.warn('can not abort audio buffer: '+e)}i?this.audioTimestampOffset=e.start:(d.logger.warn('change mpeg audio timestamp offset from '+r.timestampOffset+' to '+e.start),r.timestampOffset=e.start)}}}},{key:'onManifestParsed',value:function(e){var t=e.audio,a=e.video,r=0;e.altAudio&&(t||a)&&(r=(t?1:0)+(a?1:0),d.logger.log(r+' sourceBuffer(s) expected')),this.sourceBufferNb=r}},{key:'onMediaAttaching',value:function(e){var t=this.media=e.media;if(t){var a=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),a.addEventListener('sourceopen',this.onmso),a.addEventListener('sourceended',this.onmse),a.addEventListener('sourceclose',this.onmsc),t.src=URL.createObjectURL(a)}}},{key:'onMediaDetaching',value:function(){d.logger.log('media source detaching');var e=this.mediaSource;if(e){if('open'===e.readyState)try{e.endOfStream()}catch(e){d.logger.warn('onMediaDetaching:'+e.message+' while calling endOfStream')}e.removeEventListener('sourceopen',this.onmso),e.removeEventListener('sourceended',this.onmse),e.removeEventListener('sourceclose',this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute('src'),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(o.a.MEDIA_DETACHED)}},{key:'onMediaSourceOpen',value:function(){d.logger.log('media source opened'),this.hls.trigger(o.a.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener('sourceopen',this.onmso),this.checkPendingTracks()}},{key:'checkPendingTracks',value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:'onMediaSourceClose',value:function(){d.logger.log('media source closed')}},{key:'onMediaSourceEnded',value:function(){d.logger.log('media source ended')}},{key:'onSBUpdateEnd',value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;d.logger.warn('change mpeg audio timestamp offset from '+e.timestampOffset+' to '+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,a=this.segments.reduce(function(e,a){return a.parent===t?e+1:e},0);this.hls.trigger(o.a.BUFFER_APPENDED,{parent:t,pending:a}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:'onSBUpdateError',value:function(e){d.logger.error('sourceBuffer error:'+e),this.hls.trigger(o.a.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:'onBufferReset',value:function(){var e=this.sourceBuffer;for(var t in e){var a=e[t];try{this.mediaSource.removeSourceBuffer(a),a.removeEventListener('updateend',this.onsbue),a.removeEventListener('error',this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:'onBufferCodecs',value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var a=this.mediaSource;a&&'open'===a.readyState&&this.checkPendingTracks()}}},{key:'createSourceBuffers',value:function(e){var t=this.sourceBuffer,a=this.mediaSource;for(var r in e)if(!t[r]){var l=e[r],i=l.levelCodec||l.codec,n=l.container+';codecs='+i;d.logger.log('creating sourceBuffer('+n+')');try{var s=t[r]=a.addSourceBuffer(n);s.addEventListener('updateend',this.onsbue),s.addEventListener('error',this.onsbe),this.tracks[r]={codec:i,container:l.container},l.buffer=s}catch(e){d.logger.error('error while trying to add sourceBuffer:'+e.message),this.hls.trigger(o.a.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:n})}}this.hls.trigger(o.a.BUFFER_CREATED,{tracks:e})}},{key:'onBufferAppending',value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:'onBufferAppendFail',value:function(e){d.logger.error('sourceBuffer error:',e.event),this.hls.trigger(o.a.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:'onBufferEos',value:function(e){var t=this.sourceBuffer,a=e.type;for(var r in t)(!a||r===a)&&(t[r].ended||(t[r].ended=!0,d.logger.log(r+' sourceBuffer now EOS')));this.checkEos()}},{key:'checkEos',value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(!t||'open'!==t.readyState)return void(this._needsEos=!1);for(var a in e){var r=e[a];if(!r.ended)return;if(r.updating)return void(this._needsEos=!0)}d.logger.log('all media data available, signal endOfStream() to MediaSource and stop loading fragment');try{t.endOfStream()}catch(t){d.logger.warn('exception while calling mediaSource.endOfStream()')}this._needsEos=!1}},{key:'onBufferFlushing',value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:'onLevelUpdated',value:function(e){var t=e.details;0===t.fragments.length||(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:'updateMediaElementDuration',value:function(){var e=this.media,t=this.mediaSource,a=this.sourceBuffer,r=this._levelDuration;if(null!==r&&e&&t&&a&&0!==e.readyState&&'open'===t.readyState){for(var l in a)if(a[l].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var i=e.duration;(r>this._msDuration&&r>i||i===Infinity||isNaN(i))&&(d.logger.log('Updating mediasource duration to '+r.toFixed(3)),this._msDuration=t.duration=r)}}},{key:'doFlush',value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(this.flushBuffer(e.start,e.end,e.type))this.flushRange.shift(),this.flushBufferCounter=0;else return void(this._needsFlush=!0)}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,a=this.sourceBuffer;try{for(var r in a)t+=a[r].buffered.length}catch(e){d.logger.error('error while accessing sourceBuffer.buffered')}this.appended=t,this.hls.trigger(o.a.BUFFER_FLUSHED)}}},{key:'doAppending',value:function(){var e=this.hls,t=this.sourceBuffer,a=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void d.logger.error('trying to append although a media error occured, flush segment and abort');if(this.appending)return;if(a&&a.length){var r=a.shift();try{var l=r.type,i=t[l];i?i.updating?a.unshift(r):(i.ended=!1,this.parent=r.parent,i.appendBuffer(r.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){d.logger.error('error while trying to append buffer:'+t.message),a.unshift(r);var n={type:u.ErrorTypes.MEDIA_ERROR,parent:r.parent};if(22!==t.code){if(this.appendError?this.appendError++:this.appendError=1,n.details=u.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry)return d.logger.log('fail '+e.config.appendErrorMaxRetry+' times to append segment in sourceBuffer'),a=[],n.fatal=!0,void e.trigger(o.a.ERROR,n);n.fatal=!1,e.trigger(o.a.ERROR,n)}else return this.segments=[],n.details=u.ErrorDetails.BUFFER_FULL_ERROR,n.fatal=!1,void e.trigger(o.a.ERROR,n)}}}}},{key:'flushBuffer',value:function(e,t,a){var r,l,i,n,o,s,u=Math.min,g=this.sourceBuffer;if(Object.keys(g).length){if(d.logger.log('flushBuffer,pos/start/end: '+this.media.currentTime.toFixed(3)+'/'+e+'/'+t),this.flushBufferCounter<this.appended){for(var f in g)if(!(a&&f!==a))if(r=g[f],r.ended=!1,!r.updating)try{for(l=0;l<r.buffered.length;l++)if(i=r.buffered.start(l),n=r.buffered.end(l),-1!==navigator.userAgent.toLowerCase().indexOf('firefox')&&t===Number.POSITIVE_INFINITY?(o=e,s=t):(o=Math.max(i,e),s=u(n,t)),0.5<u(s,n)-o)return this.flushBufferCounter++,d.logger.log('flush '+f+' ['+o+','+s+'], of ['+i+','+n+'], pos:'+this.media.currentTime),r.remove(o,s),!1}catch(t){d.logger.warn('exception while accessing sourcebuffer, it might have been removed from MediaSource')}else return d.logger.warn('cannot flush, sb updating in progress'),!1}else d.logger.warn('abort flushing too many retries');d.logger.log('buffer flushed')}return!0}}]),t}(s['default']);t['default']=f;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(206),o=a.n(n),s=a(210),d=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(e){function t(e){return r(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o.a.FPS_DROP_LEVEL_CAPPING,o.a.MEDIA_ATTACHING,o.a.MANIFEST_PARSED))}var a=Number.POSITIVE_INFINITY;return i(t,e),d(t,[{key:'destroy',value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=a,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:'onFpsDropLevelCapping',value:function(e){this.restrictedLevels||(this.restrictedLevels=[]),this.isLevelRestricted(e.droppedLevel)||this.restrictedLevels.push(e.droppedLevel)}},{key:'onMediaAttaching',value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:'onManifestParsed',value:function(e){var t=this.hls;t.config.capLevelToPlayerSize&&(this.autoLevelCapping=a,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:'detectPlayerSize',value:function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:'getMaxLevel',value:function(e){var t,a,r=0,l=this.mediaWidth,i=this.mediaHeight,n=0,o=0;for(t=0;t<=e&&(a=this.levels[t],!this.isLevelRestricted(t))&&(r=t,n=a.width,o=a.height,!(l<=n||i<=o));t++);return r}},{key:'isLevelRestricted',value:function(e){return this.restrictedLevels&&-1!==this.restrictedLevels.indexOf(e)}},{key:'contentScaleFactor',get:function(){var e=1;try{e=window.devicePixelRatio}catch(t){}return e}},{key:'mediaWidth',get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=this.contentScaleFactor),e}},{key:'mediaHeight',get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=this.contentScaleFactor),e}}]),t}(s['default']);t['default']=u;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(206),o=a.n(n),s=a(210),d=a(211),u=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=function(e){function t(e){return r(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o.a.MEDIA_ATTACHING))}return i(t,e),u(t,[{key:'destroy',value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:'onMediaAttaching',value:function(e){var t=this.hls.config;if(t.capLevelOnFPSDrop){var a=this.video=e.media instanceof HTMLVideoElement?e.media:null;'function'==typeof a.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod)}}},{key:'checkFPS',value:function(e,t,a){var r=performance.now();if(t){if(this.lastTime){var l=r-this.lastTime,i=a-this.lastDroppedFrames,n=t-this.lastDecodedFrames,s=this.hls;if(s.trigger(o.a.FPS_DROP,{currentDropped:i,currentDecoded:n,totalDroppedFrames:a}),0<1e3*i/l&&i>s.config.fpsDroppedMonitoringThreshold*n){var u=s.currentLevel;d.logger.warn('drop FPS ratio greater than max allowed value for currentLevel: '+u),0<u&&(-1===s.autoLevelCapping||s.autoLevelCapping>=u)&&(--u,s.trigger(o.a.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:s.currentLevel}),s.autoLevelCapping=u,s.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=a,this.lastDecodedFrames=t}}},{key:'checkFPSInterval',value:function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),t}(s['default']);t['default']=g;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setup',function(){return S});a.d(t,'preloadStream',function(){return I});a.d(t,'teardown',function(){return F});var r=a(2),l=a(204),i=a.n(l),n=a(202),o=r['default'].lib('utilities/detect'),s=o.cachedDetect,d=r['default'].lib('player/lib/timeout-utils'),u=d.doTimeout,g=r['default'].lib('player/lib/elem'),f=g.pageLoaded,c=r['default'].lib('utilities/localstorage'),p=c.setOrGet,m=r['default'].lib('utilities/wlog'),y=m.wlog,v=r['default'].lib('utilities/cacheable'),h=v.makeCacheable,b=v.uncacheNamespace,_=v.makeNamespace,E=h('preloading'),L=_('preloading'),k=a(249).default,A=y.getPrefixedFunctions('hls preloading'),R=s(),S=function(e){var t=e.hls,a=E(e,'onMediaAttached',function(){return function(){I(e,function(){e.trigger('stream-changed',Object(n.levelToAsset)(e,t.startLevel))})}});t.off(i.a.Events.MEDIA_ATTACHED,a),t.on(i.a.Events.MEDIA_ATTACHED,a)},T=function(e,t,a){var r=e.hls;D(e,r.startLevel,1,function(){var l=r.startLevel,i=Object(n.levelToAsset)(e,r.startLevel),o=Object(n.startingAssetBasedOnBandwidthEstimate)(e,e.m3u8OrderedAssets(),Object(n.weightedBwUpEstimate)(e)),s=r.abrController.getEstimate();A.info('bandwidth estimate after 1 fragment',s),2e6>s,A.info('determined best starting asset',o);var d=o&&o.url,u=i&&i.url;if(o&&u!==d){var g=Object(n.assetToLevel)(e,o);if(0>g)return A.warn('no matching level found, got',g),void('function'==typeof a&&a());A.info('set startLevel',g),null!=g&&isNaN(g)&&A.error('error: setting startLevel to NaN',g,d),r.startLevel=g,D(e,g,t,function(){'function'==typeof a&&a()})}else D(e,r.startLevel,t-1,a)})},D=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,r=arguments[3];return O(e,t,0,a,r)},x=function(e,t){return e.hls.levels[t].url[0]},C=function(e,t,a){if(e.hls){var r,l=x(e,t),i=L(e).m3u8Cache;if(r=i&&i[l])return void u(e.uuid+'.preload_m3u8_level',function(){a(r)},0);var o=new k(e.hls.config),s=function(t,r){var i={event:t,stats:r,url:l,segments:[]};if(Object(n.shouldTransformPathToIncludeByteRange)(e)){var o=/\n([a-zA-Z0-9]+)-(\d+)-(\d+)\.ts/mg,s=function(e){return i.segments.push({url:e}),''};t.data.replace(o,s)}else{var d=/#EXT-X-BYTERANGE:(\d+)@(\d+)\s+([a-zA-Z0-9]+\.ts)/g,u=function(e,t,a,r){var l=parseInt(a)+parseInt(t);return i.segments.push({from:parseInt(a),to:l,url:r}),''};t.data.replace(d,u)}try{L(e).m3u8Cache[l]=i,a(i)}catch(t){A.warn(t)}},d={onSuccess:s,onError:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];A.error.apply(A,['Failed to fetch data for m3u8 '+l].concat(t))},onTimeout:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];A.error.apply(A,['Timeout fetching data for m3u8 '+l].concat(t))}};o.load({type:'level',level:t,id:0,responseType:'text',loader:k,url:l},{timeout:6e3,maxRetry:3,retryDelay:500,maxRetryDelay:3e3},d)}},P=function(e,t,a,r){var l=x(e,t);C(e,t,function(){var i=L(e).m3u8Cache[l].segments[a];if(i){var n=i.url,o=L(e).m3u8Cache[l].url,s=/^https?:\/\//.test(n)?n:o.substring(0,o.lastIndexOf('/')+1)+n,d=new k(e.hls.config),u=function(t,a){var l=s+'-'+i.from+'-'+i.to,n={event:t,stats:a},o=Math.max(50,performance.now()-a.trequest),d=a.loaded;p('hls.bandwidth_estimate',8e3*d/o),e.hls&&(e.hls.abrController.sample(o,d),L(e).fragCache[l]=n,'function'==typeof r&&r(n))},g=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];A.warn.apply(A,['failed to preload segment',s,a].concat(t))},f=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];A.warn.apply(A,['timed out preloading segment',s,a].concat(t))},c={type:'level',level:t,id:0,url:s,responseType:'arraybuffer',loader:k,rangeStart:i.from,rangeEnd:i.to};d.load(c,{timeout:6e3,maxRetry:3,retryDelay:500,maxRetryDelay:3e3},{onSuccess:u,onError:g,onTimeout:f})}})},O=function e(t,a,r,l,i){r>=l?'function'==typeof i&&i():P(t,a,r,function(){'beforeplay'!==t.getPlaybackMode()||e(t,a,r+1,l,i)})},I=function(e,t){R.trident||R.edge||R.firefox||f(function(){'beforeplay'===e.getPlaybackMode()&&('auto'===e.getPreload()?T(e,9,t):'metadata'===e.getPreload()&&T(e,1,t))})},F=function(e){L(e).onMediaAttached&&e.hls&&e.hls.off(i.a.Events.MEDIA_ATTACHED,L(e).onMediaAttached),b('preloading',e)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var n=a(204),o=a.n(n),s=a(2),d=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),u=function e(t,a,r){null===t&&(t=Function.prototype);var l=Object.getOwnPropertyDescriptor(t,a);if(l===void 0){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,r)}if('value'in l)return l.value;var n=l.get;return void 0===n?void 0:n.call(r)};function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function l(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function i(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=s['default'].lib('utilities/core'),f=g.base64Encode,c=g.base64Decode,p=o.a.XhrLoader,m='data:application/x-mpegURL;base64,',y=function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.log=e.debug,e&&e.getFragFromCache&&(a.getFragFromCache=e.getFragFromCache),e&&e.getM3u8FromCache&&(a.getM3u8FromCache=e.getM3u8FromCache),e&&e.transformPlaylist&&(a.transformPlaylist=e.transformPlaylist),e&&e.callbackOnFragmentProgress&&(a.callbackOnFragmentProgress=e.callbackOnFragmentProgress),a}return i(t,e),d(t,[{key:'load',value:function(e,a,r){var l=this;if('manifest'===e.type&&e.url&&0===e.url.indexOf(m)){var i=e.url.replace(m,''),n=c(i);return void setTimeout(function(){var t={url:e.url,data:n},a={trequest:performance.now(),retry:0};r.onSuccess(t,a,e)},0)}if('level'===e.type){if(this.getM3u8FromCache){var o=this.getM3u8FromCache(e.url);if(o){var s=o.event,d=o.stats;return void setTimeout(function(){r.onSuccess(s,d,e)},0)}}var g=r.onSuccess,f=function(e,t,a){g&&(e.data&&l.transformPlaylist&&(e.data=l.transformPlaylist(e.data)),g(e,t,a))};return r.onSuccess=f,void u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'load',this).call(this,e,a,r)}if(null==e.type){var p=this.getFragFromCache(e.url,e.rangeStart,e.rangeEnd);if(p){var y=p.event,v=p.stats;return void setTimeout(function(){r.onSuccess(y,v,e)},0)}}u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),'load',this).call(this,e,a,r)}}]),t}(p);t['default']=y;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setup',function(){return _});a.d(t,'teardown',function(){return O});var r=a(204),l=a.n(r),i=a(2),n=i['default'],o=n.lib('player/lib/timeout-utils'),s=o.doTimeout,d=n.lib('utilities/obj'),u=n.lib('utilities/wlog'),g=u.wlog,f=n.lib('utilities/metrics'),c=n.lib('utilities/cacheable'),p=c.makeCacheable,m=c.uncacheNamespace,y=c.makeNamespace,v=p('error_handling'),h=y('error_handling'),b=g.getPrefixedFunctions('hls error_handling'),_=function(e){var t=v(e,'onError',function(){return function(t,a){E(e,t,a)}});e.hls.on(l.a.Events.ERROR,t);var a=v(e,'onEmergencyAbortLoad',function(){return function(){R(e)}});e.hls.on(l.a.Events.FRAG_LOAD_EMERGENCY_ABORTED,a)},E=function(e,t,a){a.fatal?L(e,t,a):k(e,t,a)},L=function(e,t,a){var r=e.hls,i=e.attributes;switch(a.type){case l.a.ErrorTypes.NETWORK_ERROR:g.info('hlsjsplugin - Fatal network error encountered, try to recover'),r.startLoad(),R(e);break;case l.a.ErrorTypes.MEDIA_ERROR:if(g.info('hlsjsplugin - Fatal media error encountered, try to recover'),h(e).countedRecoverMediaError||(h(e).countedRecoverMediaError=!0,S(e,'player/hls/recover_media_error')),e.isChangingVideo()||'bufferStalledError'!==a.details||r.startLoad(),'wistia-production_435826'===e.mediaData.accountKey){b.error('trying to recover from media error...');var n=e.getCurrentTime();r.recoverMediaError();var o=null==i.bufferStallRecoveryTimeout?1e3:i.bufferStallRecoveryTimeout;s(e.uuid+'.nudge_if_not_playing',function(){'playing'===e.getPlaybackMode()?e.getCurrentTime()!==n&&b.error('video is playing; recoverMediaError() succeeded'):(b.error('trying to nudge 0.5 seconds...'),e.seek(e.getCurrentTime()+0.5).then(function(){e.play()}))},o)}break;default:S(e,'player/hls/fatal',1,{at:e.getCurrentTime(),data:a}),g.info('hlsjsplugin - Fatal error - cannot recover',t,a),r.destroy();}},k=function(e,t,a){var r=e.hls,l=e.attributes;g.info('hlsjsplugin - Non fatal error encountered',a),'bufferSeekOverHole'===a.details?T(e,'player/hls/buffer_seek_over_hole',{hole:a.hole}):'bufferStalledError'===a.details?0<e.getCurrentTime()&&T(e,'player/hls/buffer_stalled'):'internalException'===a.details?T(e,'player/hls/non-fatal/'+a.details,{errorDetails:a}):T(e,'player/hls/non-fatal/'+a.details)},A=[100,500,1500,3e3,6e3],R=function(e){for(var t,a=function(){var t=e.hls;t&&t.startLoad()},r=0;r<A.length;r++)t=A[r],s(e.uuid+'.hls.start_load_on_stall_'+t,a,t)},S=function(e,t,a){a=P(e,d.merge({at:e.getCurrentTime()},a)),f.count(t,1,a),x(e,t)},T=function(e,t,a){D(e,t)||S(e,t,a)},D=function(e,t){return C(e),!0===h(e).metricsCounted[t]},x=function(e,t){C(e),h(e).metricsCounted[t]=!0},C=function(e){null==h(e).metricsCounted&&(h(e).metricsCounted={})},P=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a={hlsVideo:e.diagnosticData()};return a.locationHref=location.href,top!==self&&(a.referrer=document.referrer,a.inIframe=!0),d.merge(a,t)},O=function(e){h(e).onError&&e.hls&&e.hls.off(l.a.Events.ERROR,h(e).onError),h(e).onEmergencyAbortLoad&&e.hls&&e.hls.off(l.a.Events.ERROR,h(e).onEmergencyAbortLoad),m('error_handling',e)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setup',function(){return v});a.d(t,'teardown',function(){return b});var r=a(204),l=a.n(r),i=a(2),n=a(202),o=i['default'],s=i['default'].lib('utilities/wlog'),d=s.wlog,u=d.getPrefixedFunctions('hls_video'),g=i['default'].lib('utilities/cacheable'),f=g.makeCacheable,c=g.uncacheNamespace,p=g.makeNamespace,m=f('dynamic_max_max_buffer'),y=p('dynamic_max_max_buffer'),v=function(e){var t=e.hls,a=m(e,'onFragLoaded',function(){return function(){h(e)}});t.off(l.a.Events.FRAG_LOADED,a),t.on(l.a.Events.FRAG_LOADED,a)},h=function(e){var t=e.hls;e.attributes.maxMaxBufferLength&&(t.config.maxMaxBufferLength=e.attributes.maxMaxBufferLength);var a=Object(n.levelToAsset)(e,t.currentLevel);a&&a.metadata&&t.abrController.getEstimate()*t.config.abrBandWidthFactor<8*a.metadata.max_bitrate&&(0<=t.manualLevel||0===t.currentLevel?(u.info('set maxMaxBufferLength',e.getDuration()),t.config.maxMaxBufferLength=e.getDuration()):(u.info('set maxMaxBufferLength',60),t.config.maxMaxBufferLength=60))},b=function(e){y(e).onFragLoaded&&e.hls&&e.hls.off(l.a.Events.FRAG_LOADED,y(e).onFragLoaded),c('dynamic_max_max_buffer',e)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setup',function(){return y});a.d(t,'teardown',function(){return v});var r=a(204),l=a.n(r),i=a(202),n=a(2),o=n['default'].lib('utilities/wlog'),s=o.wlog,d=s.getPrefixedFunctions('hls_video'),u=n['default'].lib('utilities/cacheable'),g=u.makeCacheable,f=u.uncacheNamespace,c=u.makeNamespace,p=g('track_stream_changes'),m=c('track_stream_changes'),y=function(e){var t=e.hls;m(e).lastLevel=null,m(e).lastAutoLevel=null,m(e).substreamIndex=0;var a=p(e,'onFragChanged',function(){return function(t,a){if(a.frag.level!==e._lastLevel||a.frag.autoLevel!=e._lastAutoLevel){var r=Object(i.levelToAsset)(e,a.frag.level);e.trigger('stream-changed',r),m(e).lastLevel=a.frag.level,m(e).lastAutoLevel=a.frag.autoLevel,m(e).substreamIndex+=1,0<=a.frag.level?d.notice('frag switch to',r||a.level,'at',e.getCurrentTime()):d.notice('frag switch to Auto at',e.getCurrentTime())}}});t.off(l.a.Events.FRAG_CHANGED,a),t.on(l.a.Events.FRAG_CHANGED,a);var r=p(e,'onLevelSwitch',function(){return function(t,a){if(0<=a.level){var r=Object(i.levelToAsset)(e,a.level);d.notice('level switch to',r||a.level,'at',e.lastBufferedTime())}else d.notice('level switch to Auto at',e.lastBufferedTime())}});t.off(l.a.Events.LEVEL_SWITCH,r),t.on(l.a.Events.LEVEL_SWITCH,r)},v=function(e){m(e).onFragChanged&&e.hls&&e.hls.off(l.a.Events.FRAG_CHANGED,m(e).onFragChanged),m(e).onLevelSwitch&&e.hls&&e.hls.off(l.a.Events.LEVEL_SWITCH,m(e).onLevelSwitch),f('track_stream_changes',e)};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);a.d(t,'setup',function(){return p});a.d(t,'teardown',function(){return m});var r=a(204),l=a.n(r),i=a(2),n=i['default'].lib('utilities/cacheable'),o=n.makeCacheable,s=n.uncacheNamespace,d=n.makeNamespace,u=i['default'].lib('utilities/localstorage'),g=u.setOrGet,f=o('bandwidth_tracking'),c=d('bandwidth_tracking'),p=function(e){var t=e.hls,a=f(e,'persistBandwidthEstimate',function(){return function(){var e=t.abrController.getEstimate();g('hls.bandwidth_estimate',e)}});t.off(l.a.Events.FRAG_LOADED,a),t.on(l.a.Events.FRAG_LOADED,a)},m=function(e){c(e).persistBandwidthEstimate&&e.hls&&e.hls.off(l.a.Events.FRAG_LOADED,c(e).persistBandwidthEstimate),s('bandwidth_tracking',e)};window.__NEWLINE__=1},function(e,t,a){var r,l,i,n,o,s,d,u=function(e,t){return function(){return e.apply(t,arguments)}};o=a(2)['default'],n=a(204),d=o.lib('utilities/wlog').wlog,s=d.getPrefixedFunctions('hlsabr'),i=a(255)['default'],r=a(256)['default'],l=function(){function e(e){var t,a;this.hls=e,this.abandonRulesCheck=u(this.abandonRulesCheck,this),this._onFragLoaded=u(this._onFragLoaded,this),this._onFragLoading=u(this._onFragLoading,this),this._onError=u(this._onError,this),this.lastLoadedFragLevel=0,this._autoLevelCapping=-1,this._nextAutoLevel=-1,this.defaultEstimate=this.hls.config.abrEwmaDefaultEstimate||5e5,this.minTotalWeight=1e-3,this._sampleCount=0,this._fast=new i(this.hls.config.abrEwmaFastVoD),this._slow=new i(this.hls.config.abrEwmaSlowVoD),this.minAutoLevel=0,(a=this.hls.config.abrEwmaDefaultEstimate)&&(t=a/8,this.sample(6e3,6*t)),this.hls.on(n.Events.FRAG_LOADING,this._onFragLoading),this.hls.on(n.Events.FRAG_LOADED,this._onFragLoaded),this.hls.on(n.Events.FRAG_LOADED,this._onError)}var t=Math.max,a=Math.min;return e.prototype.destroy=function(){return this.clearTimer(),this.hls.off(n.Events.FRAG_LOADED,this._onFragLoaded),this.hls.off(n.Events.FRAG_LOADING,this._onFragLoading),this.hls.off(n.Events.FRAG_LOADING,this._onError)},e.prototype.getNextAutoLevel=function(){var e,r,l,i,n,o;if(n=this.maxAutoLevel(),-1!==this._nextAutoLevel)return a(this._nextAutoLevel,n);for(r=this.getEstimate()/this.playbackRate(),l=i=0,o=n;0<=o?i<=o:i>=o;l=0<=o?++i:--i)if(e=l<=this.lastLoadedFragLevel?this.hls.config.abrBandWidthFactor*r:this.hls.config.abrBandWidthUpFactor*r,e<this.bitrateForLevel(l))return t(0,l-1);return l-1},e.prototype.bitrateForLevel=function(e){return'function'==typeof this.hls.config.bitrateForLevel?this.hls.config.bitrateForLevel(e):this.hls.levels[e].bitrate},e.prototype._onError=function(e,t){var a,r;if(a=t.details===n.ErrorDetails.FRAG_LOAD_ERROR,r=t.details===n.ErrorDetails.FRAG_LOAD_TIMEOUT,a||r)return this.clearTimer()},e.prototype._onFragLoading=function(e,t){var a;if(a=t.frag,a.trequest=performance.now(),this.fragCurrent=a,this.timer||(this.timer=setInterval(this.abandonRulesCheck,100)),!this._setupSeekTracking)return this._setupSeekTracking=!0,this.hls.media.addEventListener('seeked',function(e){return function(){var t;if(null!=(t=e.hls)&&t.media)return 0<e.hls.media.currentTime&&3>e.hls.media.currentTime?void 0:(e._justSeeked=!0,clearTimeout(e._unsetSeekedTimeout),e._unsetSeekedTimeout=setTimeout(function(){return e._justSeeked=!1},3e3))}}(this))},e.prototype._onFragLoaded=function(e,t){var a,r,l,i;if(l=t.frag,i=t.stats,'main'===l.type&&(this.clearTimer(),null==i.aborted&&1===l.loadCounter&&!i.alreadySampled))return r=performance.now()-i.trequest,a=i.loaded,!this.hls.media.seeking&&this._justSeeked&&3>this.timeBeforeEndOfBuffer()?this.sample(0.35*r,0.35*a):this.sample(r,a),this.lastLoadedFragLevel=l.level,this._nextAutoLevel=-1},e.prototype.abandonRulesCheck=function(){var e,a,l,i,n,o,d,u,g,f,c,p,m,y,h;if(d=this.hls,h=d.media,i=this.fragCurrent,(!i.loader||(null==(m=i.loader.stats)?void 0:m.aborted))&&(d.config.debug.info('hlsjs: frag loader destroy or aborted, disarm abandonRulesCheck'),this.clearTimer()),h&&!h.paused&&i.autoLevel&&i.level&&(u=0.1,y=performance.now()-i.trequest,3e3<y&&y>0.5*(1e3*i.duration)&&(g=d.levels,f=t(1,1e3*i.loaded/y),e=this.bitrateForLevel(i.level),l=t(i.loaded,Math.round((i.duration-u)*e/8)),p=h.currentTime,o=(l-i.loaded)/f,a=r.bufferInfo(h,p,d.config.maxBufferHole).end-p,a<2*i.duration&&o>a))){if(c=i.level-1,0===i.loaded)return 1>h.currentTime&&(isNaN(c)&&s.error('abandonRulesCheck a: nextLoadLevel is NaN',c,o,a,p,f,y,g),d.startLevel=c),d.nextLoadLevel=c;for(;0<=c&&(e=this.bitrateForLevel(c),n=i.duration*e/(0.9*8*f)+u,d.config.debug.info('hlsjs: fragLoadedDelay/bufferStarvationDelay/fragLevelNextLoadedDelay['+c+'] :'+o.toFixed(1)+'/'+a.toFixed(1)+'/'+n.toFixed(1)),!(n<a));)c-=1;return 1<o-n&&(c=t(0,c),1>h.currentTime&&(isNaN(c)&&s.error('abandonRulesCheck b: nextLoadLevel is NaN',c,o,a,p,f,y,g),d.startLevel=c),d.nextLoadLevel=c,this.sample(y,i.loaded)),d.config.debug.warn('loading too slow, abort fragment loading and switch to level '+c),i.loader.abort(),this.clearTimer(),d.trigger(Event.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i}),d.startLoad()}},e.prototype.clearTimer=function(){if(this.timer)return clearInterval(this.timer),this.timer=null},e.prototype.maxAutoLevel=function(){var e;return e=this.hls.levels,-1===this._autoLevelCapping&&(null==e?void 0:e.length)?e.length-1:this._autoLevelCapping},e.prototype.playbackRate=function(){var e;return e=this.hls.media,0===(null==e?void 0:e.playbackRate)?1:Math.abs(e.playbackRate)},e.prototype.sample=function(e,a){var r,l;return e=t(e,50),l=e/1e3,r=8e3*a/e,this._fast.sample(l,r),this._slow.sample(l,r),this._sampleCount+=1},e.prototype.getEstimate=function(){return 1>this._sampleCount||this._fast.getTotalWeight()<this.minTotalWeight?this.defaultEstimate:this.hls.media?6>=this.timeBeforeEndOfBuffer()?a(this._fast.getEstimate(),this._slow.getEstimate()):t(this._fast.getEstimate(),this._slow.getEstimate()):a(this._fast.getEstimate(),this._slow.getEstimate())},e.prototype.timeBeforeEndOfBuffer=function(){return r.timeBeforeEndOfBuffer(this.hls.media,this.hls.config.maxBufferHole)},e.prototype.lastBufferedTime=function(){return r.lastBufferedTime(this.hls.media,this.hls.config.maxBufferHole)},Object.defineProperties(e.prototype,{nextAutoLevel:{get:function(){return this.getNextAutoLevel()},set:function(e){return this._nextAutoLevel=e}},autoLevelCapping:{get:function(){return this._autoLevelCapping},set:function(e){return this._autoLevelCapping=e}}}),e}(),e.exports={default:l};window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(t){r(this,e),this.alpha_=t?Math.exp(-0.6931471805599453/t):0,this.estimate_=0,this.totalWeight_=0}var t=Math.pow;return l(e,[{key:'sample',value:function(e,a){var r=t(this.alpha_,e);this.estimate_=a*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:'getTotalWeight',value:function(){return this.totalWeight_}},{key:'getEstimate',value:function(){if(this.alpha_){var e=1-t(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();t['default']=i;window.__NEWLINE__=1},function(e,t,a){'use strict';a.r(t);var l=function(){function e(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,'value'in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}var i=function(){function e(){r(this,e)}return l(e,null,[{key:'bufferInfo',value:function(e,t,a){if(e){var r,l=e.buffered,i=[];for(r=0;r<l.length;r++)i.push({start:l.start(r),end:l.end(r)});return this.bufferedInfo(i,t,a)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:'bufferedInfo',value:function(e,t,a){var r,l,n,o,s,i=[];for(e.sort(function(e,t){var a=e.start-t.start;return a?a:t.end-e.end}),s=0;s<e.length;s++){var d=i.length;if(d){var u=i[d-1].end;e[s].start-u<a?e[s].end>u&&(i[d-1].end=e[s].end):i.push(e[s])}else i.push(e[s])}for(s=0,r=0,l=n=t;s<i.length;s++){var g=i[s].start,f=i[s].end;if(t+a>=g&&t<f)l=g,n=f,r=n-t;else if(t+a<g){o=g;break}}return{len:r,start:l,end:n,nextStart:o}}},{key:'lastBufferedTime',value:function(e,t){return e?this.bufferInfo(e,e.currentTime||0,t).end:0}},{key:'timeBeforeEndOfBuffer',value:function(e,t){var a=e&&e.currentTime||0;return this.lastBufferedTime(e,t)-a}}]),e}();t['default']=i;window.__NEWLINE__=1}]);U      [[?[u   =    :https://fast.wistia.com/assets/external/engines/hls_video.js necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAOKMIIDhjCCAm6gAwIBAgIERTJgJjANBgkqhkiG9w0BAQsFADCBijEUMBIGA1UEBhMLUG9ydFN3aWdnZXIxFDASBgNVBAgTC1BvcnRTd2lnZ2VyMRQwEgYDVQQHEwtQb3J0U3dpZ2dlcjEUMBIGA1UEChMLUG9ydFN3aWdnZXIxFzAVBgNVBAsTDlBvcnRTd2lnZ2VyIENBMRcwFQYDVQQDEw5Qb3J0U3dpZ2dlciBDQTAeFw0xNDEwMjgxMzEyMTBaFw0zODEwMjgxMzEyMTBaMF8xFDASBgNVBAYTC1BvcnRTd2lnZ2VyMRQwEgYDVQQKEwtQb3J0U3dpZ2dlcjEXMBUGA1UECxMOUG9ydFN3aWdnZXIgQ0ExGDAWBgNVBAMTD2Zhc3Qud2lzdGlhLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAIqft6Yog2ydao9n4L9WyptB/+Xg2yYiHfhtcFHTF02D1t9v7FyiCFGWZs+OFn8DboDaAnpGuDZ3QYYwuluoDydOVFEZcQAPf3fbXOTjJ7T0SVcKW+qC4ap2o4mk9DTkM8UPrBI6r4pUARuUTluL4syoEuKkMRHOBR7vHN6pVWTSLSV2H3JA4iTdi7NwFH2KBIS7DmqVp2Yxi9codgz1hnPRHtrExzzEC1p0rsL0p8U98QjktLaeGbLi8GtOAXJiF+QS8p+YiPodNfQhIUIALaWVwEukQNy6Jbvq0AenWlcN5a1J5pXfoB45y12V5WCtuawazd+7qmm5FxaMRlRuMTcCAwEAAaMeMBwwGgYDVR0RBBMwEYIPZmFzdC53aXN0aWEuY29tMA0GCSqGSIb3DQEBCwUAA4IBAQBHvYqcvGiLLj5PNE+CX2HjMzLAZgB/k+YHGMPPsXAysgaqrmFtENenW5Av9IeDNbE950wzTFXkRX5tBOCTn1xOsew4gU4Tl65IP+FDZpPOPPL/zLGnp3Onl0asGfixrxhcd12EF1ONpr4zc7rUxzb3P1ktt6g4Ytz4pEEb5RVuPGnNWnt+rJXFgD2P4RZnA3g20R1fTZ1A7xH7H+kZBJDiegII7ZD441SWjo4U9XVbF/jaXIix1BsfEv2pozn5l0QO07ReZVbD4P4mubh5KTyQmS6geDMhUpK2wj3S5oa71PqaHANdzRkmVhtlRAAfxp0J20HyXRG2YEVIRGNLmTQ8wC8BAwAAAAABAQAAAAA= request-method GET request-Accept-Encoding gzip, deflate, br response-head HTTP/1.1 200 OK
Content-Type: application/javascript
Last-Modified: Fri, 26 Oct 2018 19:18:35 GMT
Etag: "5bd3688b-f70b"
Cache-Control: public, max-age=3600
Access-Control-Allow-Origin: *
Timing-Allow-Origin: *
Content-Length: 236093
Accept-Ranges: bytes
Date: Sun, 28 Oct 2018 19:06:05 GMT
Via: 1.1 varnish, 1.1 varnish
Age: 2359
X-Served-By: cache-sea1040-SEA, cache-cdg20726-CDG
X-Cache: HIT, HIT
X-Cache-Hits: 1, 21
X-Timer: S1540753565.325626,VS0,VE0
Vary: Accept-Encoding
Strict-Transport-Security: max-age=0
X-ECMA-V: modern
X-Browser: firefox
X-Browser-Version: 52
 original-response-headers Content-Type: application/javascript
Last-Modified: Fri, 26 Oct 2018 19:18:35 GMT
Etag: "5bd3688b-f70b"
Cache-Control: public, max-age=3600
Access-Control-Allow-Origin: *
Timing-Allow-Origin: *
Via: 1.1 varnish
Content-Length: 236093
Accept-Ranges: bytes
Date: Sun, 28 Oct 2018 19:06:05 GMT
Via: 1.1 varnish
Age: 2359
Connection: close
X-Served-By: cache-sea1040-SEA, cache-cdg20726-CDG
X-Cache: HIT, HIT
X-Cache-Hits: 1, 21
X-Timer: S1540753565.325626,VS0,VE0
Vary: Accept-Encoding
Strict-Transport-Security: max-age=0
X-ECMA-V: modern
X-Browser: firefox
X-Browser-Version: 52
 uncompressed-len 0 net-response-time-onstart 739 net-response-time-onstop 742  =